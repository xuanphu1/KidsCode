/*! For license information please see debugadapter.js.LICENSE.txt */
(()=>{var e={4651:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugSession=t.ErrorDestination=t.MemoryEvent=t.InvalidatedEvent=t.ProgressEndEvent=t.ProgressUpdateEvent=t.ProgressStartEvent=t.CapabilitiesEvent=t.LoadedSourceEvent=t.ModuleEvent=t.BreakpointEvent=t.ThreadEvent=t.OutputEvent=t.ExitedEvent=t.TerminatedEvent=t.InitializedEvent=t.ContinuedEvent=t.StoppedEvent=t.CompletionItem=t.Module=t.Breakpoint=t.Variable=t.Thread=t.StackFrame=t.Scope=t.Source=void 0;const r=s(7147),n=s(601),i=s(8153),o=s(7310);t.Source=class{constructor(e,t,s=0,r,n){this.name=e,this.path=t,this.sourceReference=s,r&&(this.origin=r),n&&(this.adapterData=n)}},t.Scope=class{constructor(e,t,s=!1){this.name=e,this.variablesReference=t,this.expensive=s}},t.StackFrame=class{constructor(e,t,s,r=0,n=0){this.id=e,this.source=s,this.line=r,this.column=n,this.name=t}},t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}},t.Variable=class{constructor(e,t,s=0,r,n){this.name=e,this.value=t,this.variablesReference=s,"number"==typeof n&&(this.namedVariables=n),"number"==typeof r&&(this.indexedVariables=r)}},t.Breakpoint=class{constructor(e,t,s,r){this.verified=e;const n=this;"number"==typeof t&&(n.line=t),"number"==typeof s&&(n.column=s),r&&(n.source=r)}setId(e){this.id=e}},t.Module=class{constructor(e,t){this.id=e,this.name=t}},t.CompletionItem=class{constructor(e,t,s=0){this.label=e,this.start=t,this.length=s}};class a extends n.Event{constructor(e,t,s){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof s&&(this.body.text=s)}}t.StoppedEvent=a;class c extends n.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}}t.ContinuedEvent=c;class h extends n.Event{constructor(){super("initialized")}}t.InitializedEvent=h;class u extends n.Event{constructor(e){super("terminated"),("boolean"==typeof e||e)&&(this.body={restart:e})}}t.TerminatedEvent=u;class l extends n.Event{constructor(e){super("exited"),this.body={exitCode:e}}}t.ExitedEvent=l;class d extends n.Event{constructor(e,t="console",s){super("output"),this.body={category:t,output:e},void 0!==s&&(this.body.data=s)}}t.OutputEvent=d;class p extends n.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}}t.ThreadEvent=p;class f extends n.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}}t.BreakpointEvent=f;class m extends n.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}}t.ModuleEvent=m;class g extends n.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}}t.LoadedSourceEvent=g;class b extends n.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}}t.CapabilitiesEvent=b;class v extends n.Event{constructor(e,t,s){super("progressStart"),this.body={progressId:e,title:t},"string"==typeof s&&(this.body.message=s)}}t.ProgressStartEvent=v;class y extends n.Event{constructor(e,t){super("progressUpdate"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}t.ProgressUpdateEvent=y;class S extends n.Event{constructor(e,t){super("progressEnd"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}t.ProgressEndEvent=S;class E extends n.Event{constructor(e,t,s){super("invalidated"),this.body={},e&&(this.body.areas=e),t&&(this.body.threadId=t),s&&(this.body.stackFrameId=s)}}t.InvalidatedEvent=E;class x extends n.Event{constructor(e,t,s){super("memory"),this.body={memoryReference:e,offset:t,count:s}}}var w;t.MemoryEvent=x,function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(w=t.ErrorDestination||(t.ErrorDestination={}));class R extends r.ProtocolServer{constructor(e,t){super();const s="boolean"==typeof e&&e;this._debuggerLinesStartAt1=s,this._debuggerColumnsStartAt1=s,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",(()=>{this.shutdown()})),this.on("error",(e=>{this.shutdown()}))}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){(0,i.runDebugAdapter)(e)}shutdown(){this._isServer||this._isRunningInline()||setTimeout((()=>{process.exit(0)}),100)}sendErrorResponse(e,t,s,r,n=w.User){let i;"number"==typeof t?(i={id:t,format:s},r&&(i.variables=r),n&w.User&&(i.showUser=!0),n&w.Telemetry&&(i.sendTelemetry=!0)):i=t,e.success=!1,e.message=R.formatPII(i.format,!0,i.variables),e.body||(e.body={}),e.body.error=i,this.sendResponse(e)}runInTerminalRequest(e,t,s){this.sendRequest("runInTerminal",e,t,s)}dispatchRequest(e){const t=new n.Response(e);try{if("initialize"===e.command){var s=e.arguments;if("boolean"==typeof s.linesStartAt1&&(this._clientLinesStartAt1=s.linesStartAt1),"boolean"==typeof s.columnsStartAt1&&(this._clientColumnsStartAt1=s.columnsStartAt1),"path"!==s.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,w.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,s)}}else"launch"===e.command?this.launchRequest(t,e.arguments,e):"attach"===e.command?this.attachRequest(t,e.arguments,e):"disconnect"===e.command?this.disconnectRequest(t,e.arguments,e):"terminate"===e.command?this.terminateRequest(t,e.arguments,e):"restart"===e.command?this.restartRequest(t,e.arguments,e):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments,e):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments,e):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments,e):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments,e):"continue"===e.command?this.continueRequest(t,e.arguments,e):"next"===e.command?this.nextRequest(t,e.arguments,e):"stepIn"===e.command?this.stepInRequest(t,e.arguments,e):"stepOut"===e.command?this.stepOutRequest(t,e.arguments,e):"stepBack"===e.command?this.stepBackRequest(t,e.arguments,e):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments,e):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments,e):"goto"===e.command?this.gotoRequest(t,e.arguments,e):"pause"===e.command?this.pauseRequest(t,e.arguments,e):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments,e):"scopes"===e.command?this.scopesRequest(t,e.arguments,e):"variables"===e.command?this.variablesRequest(t,e.arguments,e):"setVariable"===e.command?this.setVariableRequest(t,e.arguments,e):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments,e):"source"===e.command?this.sourceRequest(t,e.arguments,e):"threads"===e.command?this.threadsRequest(t,e):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments,e):"evaluate"===e.command?this.evaluateRequest(t,e.arguments,e):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments,e):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments,e):"completions"===e.command?this.completionsRequest(t,e.arguments,e):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments,e):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments,e):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments,e):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments,e):"readMemory"===e.command?this.readMemoryRequest(t,e.arguments,e):"writeMemory"===e.command?this.writeMemoryRequest(t,e.arguments,e):"disassemble"===e.command?this.disassembleRequest(t,e.arguments,e):"cancel"===e.command?this.cancelRequest(t,e.arguments,e):"breakpointLocations"===e.command?this.breakpointLocationsRequest(t,e.arguments,e):"setInstructionBreakpoints"===e.command?this.setInstructionBreakpointsRequest(t,e.arguments,e):this.customRequest(e.command,t,e.arguments,e)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},w.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,e.body.supportsCancelRequest=!1,e.body.supportsBreakpointLocationsRequest=!1,e.body.supportsClipboardContext=!1,e.body.supportsSteppingGranularity=!1,e.body.supportsInstructionBreakpoints=!1,e.body.supportsExceptionFilterOptions=!1,this.sendResponse(e)}disconnectRequest(e,t,s){this.sendResponse(e),this.shutdown()}launchRequest(e,t,s){this.sendResponse(e)}attachRequest(e,t,s){this.sendResponse(e)}terminateRequest(e,t,s){this.sendResponse(e)}restartRequest(e,t,s){this.sendResponse(e)}setBreakPointsRequest(e,t,s){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t,s){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t,s){this.sendResponse(e)}configurationDoneRequest(e,t,s){this.sendResponse(e)}continueRequest(e,t,s){this.sendResponse(e)}nextRequest(e,t,s){this.sendResponse(e)}stepInRequest(e,t,s){this.sendResponse(e)}stepOutRequest(e,t,s){this.sendResponse(e)}stepBackRequest(e,t,s){this.sendResponse(e)}reverseContinueRequest(e,t,s){this.sendResponse(e)}restartFrameRequest(e,t,s){this.sendResponse(e)}gotoRequest(e,t,s){this.sendResponse(e)}pauseRequest(e,t,s){this.sendResponse(e)}sourceRequest(e,t,s){this.sendResponse(e)}threadsRequest(e,t){this.sendResponse(e)}terminateThreadsRequest(e,t,s){this.sendResponse(e)}stackTraceRequest(e,t,s){this.sendResponse(e)}scopesRequest(e,t,s){this.sendResponse(e)}variablesRequest(e,t,s){this.sendResponse(e)}setVariableRequest(e,t,s){this.sendResponse(e)}setExpressionRequest(e,t,s){this.sendResponse(e)}evaluateRequest(e,t,s){this.sendResponse(e)}stepInTargetsRequest(e,t,s){this.sendResponse(e)}gotoTargetsRequest(e,t,s){this.sendResponse(e)}completionsRequest(e,t,s){this.sendResponse(e)}exceptionInfoRequest(e,t,s){this.sendResponse(e)}loadedSourcesRequest(e,t,s){this.sendResponse(e)}dataBreakpointInfoRequest(e,t,s){this.sendResponse(e)}setDataBreakpointsRequest(e,t,s){this.sendResponse(e)}readMemoryRequest(e,t,s){this.sendResponse(e)}writeMemoryRequest(e,t,s){this.sendResponse(e)}disassembleRequest(e,t,s){this.sendResponse(e)}cancelRequest(e,t,s){this.sendResponse(e)}breakpointLocationsRequest(e,t,s){this.sendResponse(e)}setInstructionBreakpointsRequest(e,t,s){this.sendResponse(e)}customRequest(e,t,s,r){this.sendErrorResponse(t,1014,"unrecognized request",null,w.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?R.uri2path(e):R.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?R.uri2path(e):R.path2uri(e):e}static path2uri(e){"win32"===process.platform&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new o.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new o.URL(e),s=decodeURIComponent(t.pathname);return"win32"===process.platform&&(/^\/[a-zA-Z]:/.test(s)&&(s=s[1].toLowerCase()+s.substr(2)),s=s.replace(/\//g,"\\")),s}static formatPII(e,t,s){return e.replace(R._formatPIIRegexp,(function(e,r){return t&&r.length>0&&"_"!==r[0]?e:s[r]&&s.hasOwnProperty(r)?s[r]:e}))}}t.DebugSession=R,R._formatPIIRegexp=/{([^}]+)}/g},527:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Handles=void 0,t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},7309:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InternalLogger=void 0;const n=s(358),i=s(1017),o=s(1890),a=s(4100);function c(){let e=new Date;return h(2,String(e.getUTCHours()))+":"+h(2,String(e.getUTCMinutes()))+":"+h(2,String(e.getUTCSeconds()))+"."+h(3,String(e.getUTCMilliseconds()))+" UTC"}function h(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.InternalLogger=class{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=a.LogLevel.Warn,this.disposeCallback=(e,t)=>{this.dispose(),t=t||2,t+=128,process.exit(t)}}setup(e){return r(this,void 0,void 0,(function*(){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(i.isAbsolute(e.logFilePath)){const t=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,a.LogLevel.Error);try{yield o(i.dirname(e.logFilePath)),this.log("Verbose logs are written to:\n",a.LogLevel.Warn),this.log(e.logFilePath+"\n",a.LogLevel.Warn),this._logFileStream=n.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",(e=>{t(e)}))}catch(e){t(e)}}else this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,a.LogLevel.Error)}))}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+`${e.getUTCMonth()+1}-`+e.getUTCDate()+", "+c();this.log(t+"\n",a.LogLevel.Verbose,!1)}setupShutdownListeners(){process.addListener("beforeExit",this.beforeExitCallback),process.addListener("SIGTERM",this.disposeCallback),process.addListener("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise((e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()}))}log(e,t,s=!0){if(this._minLogLevel!==a.LogLevel.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const s=t===a.LogLevel.Error?console.error:t===a.LogLevel.Warn?console.warn:null;s&&s((0,a.trimLastNewline)(e))}t===a.LogLevel.Error&&(e=`[${a.LogLevel[t]}] ${e}`),this._prependTimestamp&&s&&(e="["+c()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const s=new a.LogOutputEvent(e,t);this._logCallback(s)}}}},4100:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trimLastNewline=t.LogOutputEvent=t.logger=t.Logger=t.LogLevel=void 0;const r=s(7309),n=s(4651);var i;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(i=t.LogLevel||(t.LogLevel={}));class o{constructor(){this._pendingLogQ=[]}log(e,t=i.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,i.Verbose)}warn(e){this.log(e,i.Warn)}error(e){this.log(e,i.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=i.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,s=!0){const r="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:r,prependTimestamp:s};this._currentLogger.setup(t).then((()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach((e=>this._write(e.msg,e.level)))}}))}}init(e,t,s){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new r.InternalLogger(e,s),this._logFilePathFromInit=t}}t.Logger=o,t.logger=new o;class a extends n.OutputEvent{constructor(e,t){super(e,t===i.Error?"stderr":t===i.Warn?"console":"stdout")}}t.LogOutputEvent=a,t.trimLastNewline=function(e){return e.replace(/(\n|\r\n)$/,"")}},1212:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingDebugSession=void 0;const r=s(4100),n=r.logger,i=s(4651);class o extends i.DebugSession{constructor(e,t,s){super(t,s),this.obsolete_logFilePath=e,this.on("error",(e=>{n.error(e.body)}))}start(e,t){super.start(e,t),n.init((e=>this.sendEvent(e)),this.obsolete_logFilePath,this._isServer)}sendEvent(e){if(!(e instanceof r.LogOutputEvent)){let t=e;e instanceof i.OutputEvent&&e.body&&e.body.data&&e.body.data.doNotLogOutput&&(delete e.body.data.doNotLogOutput,t=Object.assign({},e),t.body=Object.assign(Object.assign({},e.body),{output:"<output not logged>"})),n.verbose(`To client: ${JSON.stringify(t)}`)}super.sendEvent(e)}sendRequest(e,t,s,r){n.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${s}`),super.sendRequest(e,t,s,r)}sendResponse(e){n.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){n.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}t.LoggingDebugSession=o},9955:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Handles=t.Response=t.Event=t.ErrorDestination=t.CompletionItem=t.Module=t.Source=t.Breakpoint=t.Variable=t.Scope=t.StackFrame=t.Thread=t.MemoryEvent=t.InvalidatedEvent=t.ProgressEndEvent=t.ProgressUpdateEvent=t.ProgressStartEvent=t.CapabilitiesEvent=t.LoadedSourceEvent=t.ModuleEvent=t.BreakpointEvent=t.ThreadEvent=t.OutputEvent=t.ContinuedEvent=t.StoppedEvent=t.ExitedEvent=t.TerminatedEvent=t.InitializedEvent=t.logger=t.Logger=t.LoggingDebugSession=t.DebugSession=void 0;const r=s(4651);Object.defineProperty(t,"DebugSession",{enumerable:!0,get:function(){return r.DebugSession}}),Object.defineProperty(t,"InitializedEvent",{enumerable:!0,get:function(){return r.InitializedEvent}}),Object.defineProperty(t,"TerminatedEvent",{enumerable:!0,get:function(){return r.TerminatedEvent}}),Object.defineProperty(t,"ExitedEvent",{enumerable:!0,get:function(){return r.ExitedEvent}}),Object.defineProperty(t,"StoppedEvent",{enumerable:!0,get:function(){return r.StoppedEvent}}),Object.defineProperty(t,"ContinuedEvent",{enumerable:!0,get:function(){return r.ContinuedEvent}}),Object.defineProperty(t,"OutputEvent",{enumerable:!0,get:function(){return r.OutputEvent}}),Object.defineProperty(t,"ThreadEvent",{enumerable:!0,get:function(){return r.ThreadEvent}}),Object.defineProperty(t,"BreakpointEvent",{enumerable:!0,get:function(){return r.BreakpointEvent}}),Object.defineProperty(t,"ModuleEvent",{enumerable:!0,get:function(){return r.ModuleEvent}}),Object.defineProperty(t,"LoadedSourceEvent",{enumerable:!0,get:function(){return r.LoadedSourceEvent}}),Object.defineProperty(t,"CapabilitiesEvent",{enumerable:!0,get:function(){return r.CapabilitiesEvent}}),Object.defineProperty(t,"ProgressStartEvent",{enumerable:!0,get:function(){return r.ProgressStartEvent}}),Object.defineProperty(t,"ProgressUpdateEvent",{enumerable:!0,get:function(){return r.ProgressUpdateEvent}}),Object.defineProperty(t,"ProgressEndEvent",{enumerable:!0,get:function(){return r.ProgressEndEvent}}),Object.defineProperty(t,"InvalidatedEvent",{enumerable:!0,get:function(){return r.InvalidatedEvent}}),Object.defineProperty(t,"MemoryEvent",{enumerable:!0,get:function(){return r.MemoryEvent}}),Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return r.Thread}}),Object.defineProperty(t,"StackFrame",{enumerable:!0,get:function(){return r.StackFrame}}),Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return r.Scope}}),Object.defineProperty(t,"Variable",{enumerable:!0,get:function(){return r.Variable}}),Object.defineProperty(t,"Breakpoint",{enumerable:!0,get:function(){return r.Breakpoint}}),Object.defineProperty(t,"Source",{enumerable:!0,get:function(){return r.Source}}),Object.defineProperty(t,"Module",{enumerable:!0,get:function(){return r.Module}}),Object.defineProperty(t,"CompletionItem",{enumerable:!0,get:function(){return r.CompletionItem}}),Object.defineProperty(t,"ErrorDestination",{enumerable:!0,get:function(){return r.ErrorDestination}});const n=s(1212);Object.defineProperty(t,"LoggingDebugSession",{enumerable:!0,get:function(){return n.LoggingDebugSession}});const i=s(4100);t.Logger=i;const o=s(601);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return o.Event}}),Object.defineProperty(t,"Response",{enumerable:!0,get:function(){return o.Response}});const a=s(527);Object.defineProperty(t,"Handles",{enumerable:!0,get:function(){return a.Handles}});const c=i.logger;t.logger=c},601:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=t.Response=t.Message=void 0;class s{constructor(e){this.seq=0,this.type=e}}t.Message=s,t.Response=class extends s{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}},t.Event=class extends s{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},7147:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolServer=void 0;const r=s(2361),n=s(601);class i{get event(){return this._event||(this._event=(e,t)=>{let s;return this._listener=e,this._this=t,s={dispose:()=>{this._listener=void 0,this._this=void 0}},s}),this._event}fire(e){if(this._listener)try{this._listener.call(this._this,e)}catch(e){}}hasListener(){return!!this._listener}dispose(){this._listener=void 0,this._this=void 0}}class o extends r.EventEmitter{constructor(){super(),this._sendMessage=new i,this._pendingRequests=new Map,this.onDidSendMessage=this._sendMessage.event}dispose(){}handleMessage(e){if("request"===e.type)this.dispatchRequest(e);else if("response"===e.type){const t=e,s=this._pendingRequests.get(t.request_seq);s&&(this._pendingRequests.delete(t.request_seq),s(t))}}_isRunningInline(){return this._sendMessage&&this._sendMessage.hasListener()}start(e,t){this._sequence=1,this._writableStream=t,this._rawData=Buffer.alloc(0),e.on("data",(e=>this._handleData(e))),e.on("close",(()=>{this._emitEvent(new n.Event("close"))})),e.on("error",(e=>{this._emitEvent(new n.Event("error","inStream error: "+(e&&e.message)))})),t.on("error",(e=>{this._emitEvent(new n.Event("error","outStream error: "+(e&&e.message)))})),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,s,r){const i={command:e};if(t&&Object.keys(t).length>0&&(i.arguments=t),this._send("request",i),r){this._pendingRequests.set(i.seq,r);const e=setTimeout((()=>{clearTimeout(e);const t=this._pendingRequests.get(i.seq);t&&(this._pendingRequests.delete(i.seq),t(new n.Response(i,"timeout")))}),s)}}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){const e=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(e,"utf8")}\r\n\r\n${e}`,"utf8")}this._sendMessage.fire(t)}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);this.handleMessage(t)}catch(e){this._emitEvent(new n.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(o.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const s=t[e].split(/: +/);"Content-Length"==s[0]&&(this._contentLength=+s[1])}this._rawData=this._rawData.slice(e+o.TWO_CRLF.length);continue}}break}}}t.ProtocolServer=o,o.TWO_CRLF="\r\n\r\n"},8153:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runDebugAdapter=void 0;const r=s(1808);t.runDebugAdapter=function(e){let t=0;if(process.argv.slice(2).forEach((function(e,s,r){const n=/^--server=(\d{4,5})$/.exec(e);n&&(t=parseInt(n[1],10))})),t>0)console.error(`waiting for debug protocol on port ${t}`),r.createServer((t=>{console.error(">> accepted connection from client"),t.on("end",(()=>{console.error(">> client connection closed\n")}));const s=new e(!1,!0);s.setRunAsServer(!0),s.start(t,t)})).listen(t);else{const t=new e(!1);process.on("SIGTERM",(()=>{t.shutdown()})),t.start(process.stdin,process.stdout)}}},8223:(e,t)=>{var s;!function(){var r,n={};function i(){}function o(e){return e}function a(e){return!!e}function c(e){return!e}var h="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;function u(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function l(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=h&&(r=h.async),n.noConflict=function(){return h.async=r,n};var d=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===d.call(e)};function f(e){return p(e)||"number"==typeof e.length&&e.length>=0&&e.length%1==0}function m(e,t){for(var s=-1,r=e.length;++s<r;)t(e[s],s,e)}function g(e,t){for(var s=-1,r=e.length,n=Array(r);++s<r;)n[s]=t(e[s],s,e);return n}function b(e){return g(Array(e),(function(e,t){return t}))}function v(e,t,s){return m(e,(function(e,r,n){s=t(s,e,r,n)})),s}function y(e,t){m(E(e),(function(s){t(e[s],s)}))}function S(e,t){for(var s=0;s<e.length;s++)if(e[s]===t)return s;return-1}var E=Object.keys||function(e){var t=[];for(var s in e)e.hasOwnProperty(s)&&t.push(s);return t};function x(e){var t,s,r=-1;return f(e)?(t=e.length,function(){return++r<t?r:null}):(s=E(e),t=s.length,function(){return++r<t?s[r]:null})}function w(e,t){return t=null==t?e.length-1:+t,function(){for(var s=Math.max(arguments.length-t,0),r=Array(s),n=0;n<s;n++)r[n]=arguments[n+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r)}}}function R(e){return function(t,s,r){return e(t,r)}}var _="function"==typeof setImmediate&&setImmediate,C=_?function(e){_(e)}:function(e){setTimeout(e,0)};function k(e){return function(t,s,r){r=l(r||i);var n=x(t=t||[]);if(e<=0)return r(null);var o=!1,a=0,c=!1;!function i(){if(o&&a<=0)return r(null);for(;a<e&&!c;){var h=n();if(null===h)return o=!0,void(a<=0&&r(null));a+=1,s(t[h],h,u((function(e){a-=1,e?(r(e),c=!0):i()})))}}()}}function O(e){return function(t,s,r){return e(n.eachOf,t,s,r)}}function P(e){return function(t,s,r,n){return e(k(s),t,r,n)}}function T(e){return function(t,s,r){return e(n.eachOfSeries,t,s,r)}}function M(e,t,s,r){r=l(r||i);var n=f(t=t||[])?[]:{};e(t,(function(e,t,r){s(e,(function(e,s){n[t]=s,r(e)}))}),(function(e){r(e,n)}))}function I(e,t,s,r){var n=[];e(t,(function(e,t,r){s(e,(function(s){s&&n.push({index:t,value:e}),r()}))}),(function(){r(g(n.sort((function(e,t){return e.index-t.index})),(function(e){return e.value})))}))}function D(e,t,s,r){I(e,t,(function(e,t){s(e,(function(e){t(!e)}))}),r)}function A(e,t,s){return function(r,n,i,o){function a(){o&&o(s(!1,void 0))}function c(e,r,n){if(!o)return n();i(e,(function(r){o&&t(r)&&(o(s(!0,e)),o=i=!1),n()}))}arguments.length>3?e(r,n,c,a):(o=i,i=n,e(r,c,a))}}function N(e,t){return t}function $(e,t,s){s=s||i;var r=f(t)?[]:{};e(t,(function(e,t,s){e(w((function(e,n){n.length<=1&&(n=n[0]),r[t]=n,s(e)})))}),(function(e){s(e,r)}))}function L(e,t,s,r){var n=[];e(t,(function(e,t,r){s(e,(function(e,t){n=n.concat(t||[]),r(e)}))}),(function(e){r(e,n)}))}function F(e,t,s){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function r(e,t,s,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(e.started=!0,p(t)||(t=[t]),0===t.length&&e.idle())return n.setImmediate((function(){e.drain()}));m(t,(function(t){var n={data:t,callback:r||i};s?e.tasks.unshift(n):e.tasks.push(n),e.tasks.length===e.concurrency&&e.saturated()})),n.setImmediate(e.process)}function o(e,t){return function(){a-=1;var s=!1,r=arguments;m(t,(function(e){m(c,(function(t,r){t!==e||s||(c.splice(r,1),s=!0)})),e.callback.apply(e,r)})),e.tasks.length+a===0&&e.drain(),e.process()}}var a=0,c=[],h={tasks:[],concurrency:t,payload:s,saturated:i,empty:i,drain:i,started:!1,paused:!1,push:function(e,t){r(h,e,!1,t)},kill:function(){h.drain=i,h.tasks=[]},unshift:function(e,t){r(h,e,!0,t)},process:function(){for(;!h.paused&&a<h.concurrency&&h.tasks.length;){var t=h.payload?h.tasks.splice(0,h.payload):h.tasks.splice(0,h.tasks.length),s=g(t,(function(e){return e.data}));0===h.tasks.length&&h.empty(),a+=1,c.push(t[0]);var r=u(o(h,t));e(s,r)}},length:function(){return h.tasks.length},running:function(){return a},workersList:function(){return c},idle:function(){return h.tasks.length+a===0},pause:function(){h.paused=!0},resume:function(){if(!1!==h.paused){h.paused=!1;for(var e=Math.min(h.concurrency,h.tasks.length),t=1;t<=e;t++)n.setImmediate(h.process)}}};return h}function j(e){return w((function(t,s){t.apply(null,s.concat([w((function(t,s){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&m(s,(function(t){console[e](t)})))}))]))}))}function q(e){return function(t,s,r){e(b(t),s,r)}}function B(e){return w((function(t,s){var r=w((function(s){var r=this,n=s.pop();return e(t,(function(e,t,n){e.apply(r,s.concat([n]))}),n)}));return s.length?r.apply(this,s):r}))}function G(e){return w((function(t){var s=t.pop();t.push((function(){var e=arguments;r?n.setImmediate((function(){s.apply(null,e)})):s.apply(null,e)}));var r=!0;e.apply(this,t),r=!1}))}"object"==typeof process&&"function"==typeof process.nextTick?n.nextTick=process.nextTick:n.nextTick=C,n.setImmediate=_?C:n.nextTick,n.forEach=n.each=function(e,t,s){return n.eachOf(e,R(t),s)},n.forEachSeries=n.eachSeries=function(e,t,s){return n.eachOfSeries(e,R(t),s)},n.forEachLimit=n.eachLimit=function(e,t,s,r){return k(t)(e,R(s),r)},n.forEachOf=n.eachOf=function(e,t,s){s=l(s||i);for(var r,n=x(e=e||[]),o=0;null!=(r=n());)o+=1,t(e[r],r,u(a));function a(e){o--,e?s(e):null===r&&o<=0&&s(null)}0===o&&s(null)},n.forEachOfSeries=n.eachOfSeries=function(e,t,s){s=l(s||i);var r=x(e=e||[]),o=r();!function i(){var a=!0;if(null===o)return s(null);t(e[o],o,u((function(e){if(e)s(e);else{if(null===(o=r()))return s(null);a?n.setImmediate(i):i()}}))),a=!1}()},n.forEachOfLimit=n.eachOfLimit=function(e,t,s,r){k(t)(e,s,r)},n.map=O(M),n.mapSeries=T(M),n.mapLimit=P(M),n.inject=n.foldl=n.reduce=function(e,t,s,r){n.eachOfSeries(e,(function(e,r,n){s(t,e,(function(e,s){t=s,n(e)}))}),(function(e){r(e,t)}))},n.foldr=n.reduceRight=function(e,t,s,r){var i=g(e,o).reverse();n.reduce(i,t,s,r)},n.transform=function(e,t,s,r){3===arguments.length&&(r=s,s=t,t=p(e)?[]:{}),n.eachOf(e,(function(e,r,n){s(t,e,r,n)}),(function(e){r(e,t)}))},n.select=n.filter=O(I),n.selectLimit=n.filterLimit=P(I),n.selectSeries=n.filterSeries=T(I),n.reject=O(D),n.rejectLimit=P(D),n.rejectSeries=T(D),n.any=n.some=A(n.eachOf,a,o),n.someLimit=A(n.eachOfLimit,a,o),n.all=n.every=A(n.eachOf,c,c),n.everyLimit=A(n.eachOfLimit,c,c),n.detect=A(n.eachOf,o,N),n.detectSeries=A(n.eachOfSeries,o,N),n.detectLimit=A(n.eachOfLimit,o,N),n.sortBy=function(e,t,s){function r(e,t){var s=e.criteria,r=t.criteria;return s<r?-1:s>r?1:0}n.map(e,(function(e,s){t(e,(function(t,r){t?s(t):s(null,{value:e,criteria:r})}))}),(function(e,t){if(e)return s(e);s(null,g(t.sort(r),(function(e){return e.value})))}))},n.auto=function(e,t,s){"function"==typeof arguments[1]&&(s=t,t=null),s=l(s||i);var r=E(e),o=r.length;if(!o)return s(null);t||(t=o);var a={},c=0,h=!1,u=[];function d(e){u.unshift(e)}function f(e){var t=S(u,e);t>=0&&u.splice(t,1)}function g(){o--,m(u.slice(0),(function(e){e()}))}d((function(){o||s(null,a)})),m(r,(function(r){if(!h){for(var i,o=p(e[r])?e[r]:[e[r]],u=w((function(e,t){if(c--,t.length<=1&&(t=t[0]),e){var i={};y(a,(function(e,t){i[t]=e})),i[r]=t,h=!0,s(e,i)}else a[r]=t,n.setImmediate(g)})),l=o.slice(0,o.length-1),m=l.length;m--;){if(!(i=e[l[m]]))throw new Error("Has nonexistent dependency in "+l.join(", "));if(p(i)&&S(i,r)>=0)throw new Error("Has cyclic dependencies")}b()?(c++,o[o.length-1](u,a)):d((function e(){b()&&(c++,f(e),o[o.length-1](u,a))}))}function b(){return c<t&&v(l,(function(e,t){return e&&a.hasOwnProperty(t)}),!0)&&!a.hasOwnProperty(r)}}))},n.retry=function(e,t,s){var r=5,i=0,o=[],a={times:r,interval:i};function c(e,t){if("number"==typeof t)e.times=parseInt(t,10)||r;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||r,e.interval=parseInt(t.interval,10)||i}}var h=arguments.length;if(h<1||h>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function u(e,t){function s(e,s){return function(r){e((function(e,t){r(!e||s,{err:e,result:t})}),t)}}function r(e){return function(t){setTimeout((function(){t(null)}),e)}}for(;a.times;){var i=!(a.times-=1);o.push(s(a.task,i)),!i&&a.interval>0&&o.push(r(a.interval))}n.series(o,(function(t,s){s=s[s.length-1],(e||a.callback)(s.err,s.result)}))}return h<=2&&"function"==typeof e&&(s=t,t=e),"function"!=typeof e&&c(a,e),a.callback=s,a.task=t,a.callback?u():u},n.waterfall=function(e,t){if(t=l(t||i),!p(e)){var s=new Error("First argument to waterfall must be an array of functions");return t(s)}if(!e.length)return t();!function e(s){return w((function(r,n){if(r)t.apply(null,[r].concat(n));else{var i=s.next();i?n.push(e(i)):n.push(t),G(s).apply(null,n)}}))}(n.iterator(e))()},n.parallel=function(e,t){$(n.eachOf,e,t)},n.parallelLimit=function(e,t,s){$(k(t),e,s)},n.series=function(e,t){$(n.eachOfSeries,e,t)},n.iterator=function(e){return function t(s){function r(){return e.length&&e[s].apply(null,arguments),r.next()}return r.next=function(){return s<e.length-1?t(s+1):null},r}(0)},n.apply=w((function(e,t){return w((function(s){return e.apply(null,t.concat(s))}))})),n.concat=O(L),n.concatSeries=T(L),n.whilst=function(e,t,s){if(s=s||i,e()){var r=w((function(n,i){n?s(n):e.apply(this,i)?t(r):s.apply(null,[null].concat(i))}));t(r)}else s(null)},n.doWhilst=function(e,t,s){var r=0;return n.whilst((function(){return++r<=1||t.apply(this,arguments)}),e,s)},n.until=function(e,t,s){return n.whilst((function(){return!e.apply(this,arguments)}),t,s)},n.doUntil=function(e,t,s){return n.doWhilst(e,(function(){return!t.apply(this,arguments)}),s)},n.during=function(e,t,s){s=s||i;var r=w((function(t,r){t?s(t):(r.push(n),e.apply(this,r))})),n=function(e,n){e?s(e):n?t(r):s(null)};e(n)},n.doDuring=function(e,t,s){var r=0;n.during((function(e){r++<1?e(null,!0):t.apply(this,arguments)}),e,s)},n.queue=function(e,t){return F((function(t,s){e(t[0],s)}),t,1)},n.priorityQueue=function(e,t){function s(e,t){return e.priority-t.priority}var r=n.queue(e,t);return r.push=function(e,t,o){!function(e,t,r,o){if(null!=o&&"function"!=typeof o)throw new Error("task callback must be a function");if(e.started=!0,p(t)||(t=[t]),0===t.length)return n.setImmediate((function(){e.drain()}));m(t,(function(t){var a={data:t,priority:r,callback:"function"==typeof o?o:i};e.tasks.splice(function(e,t,s){for(var r=-1,n=e.length-1;r<n;){var i=r+(n-r+1>>>1);s(t,e[i])>=0?r=i:n=i-1}return r}(e.tasks,a,s)+1,0,a),e.tasks.length===e.concurrency&&e.saturated(),n.setImmediate(e.process)}))}(r,e,t,o)},delete r.unshift,r},n.cargo=function(e,t){return F(e,1,t)},n.log=j("log"),n.dir=j("dir"),n.memoize=function(e,t){var s={},r={},i=Object.prototype.hasOwnProperty;t=t||o;var a=w((function(o){var a=o.pop(),c=t.apply(null,o);i.call(s,c)?n.setImmediate((function(){a.apply(null,s[c])})):i.call(r,c)?r[c].push(a):(r[c]=[a],e.apply(null,o.concat([w((function(e){s[c]=e;var t=r[c];delete r[c];for(var n=0,i=t.length;n<i;n++)t[n].apply(null,e)}))])))}));return a.memo=s,a.unmemoized=e,a},n.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},n.times=q(n.map),n.timesSeries=q(n.mapSeries),n.timesLimit=function(e,t,s,r){return n.mapLimit(b(e),t,s,r)},n.seq=function(){var e=arguments;return w((function(t){var s=this,r=t[t.length-1];"function"==typeof r?t.pop():r=i,n.reduce(e,t,(function(e,t,r){t.apply(s,e.concat([w((function(e,t){r(e,t)}))]))}),(function(e,t){r.apply(s,[e].concat(t))}))}))},n.compose=function(){return n.seq.apply(null,Array.prototype.reverse.call(arguments))},n.applyEach=B(n.eachOf),n.applyEachSeries=B(n.eachOfSeries),n.forever=function(e,t){var s=u(t||i),r=G(e);!function e(t){if(t)return s(t);r(e)}()},n.ensureAsync=G,n.constant=w((function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}})),n.wrapSync=n.asyncify=function(e){return w((function(t){var s,r,n,i=t.pop();try{s=e.apply(this,t)}catch(e){return i(e)}("function"==(n=typeof(r=s))||"object"===n&&r)&&"function"==typeof s.then?s.then((function(e){i(null,e)})).catch((function(e){i(e.message?e:new Error(e))})):i(null,s)}))},e.exports?e.exports=n:void 0===(s=function(){return n}.apply(t,[]))||(e.exports=s)}()},5623:e=>{"use strict";function t(e,t,n){e instanceof RegExp&&(e=s(e,n)),t instanceof RegExp&&(t=s(t,n));var i=r(e,t,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+e.length,i[1]),post:n.slice(i[1]+t.length)}}function s(e,t){var s=t.match(e);return s?s[0]:null}function r(e,t,s){var r,n,i,o,a,c=s.indexOf(e),h=s.indexOf(t,c+1),u=c;if(c>=0&&h>0){if(e===t)return[c,h];for(r=[],i=s.length;u>=0&&!a;)u==c?(r.push(u),c=s.indexOf(e,u+1)):1==r.length?a=[r.pop(),h]:((n=r.pop())<i&&(i=n,o=h),h=s.indexOf(t,u+1)),u=c<h&&c>=0?c:h;r.length&&(a=[i,o])}return a}e.exports=t,t.range=r},3644:(e,t,s)=>{var r=s(1048),n=s(5623);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),b(function(e){return e.split("\\\\").join(i).split("\\{").join(o).split("\\}").join(a).split("\\,").join(c).split("\\.").join(h)}(e),!0).map(l)):[]};var i="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",h="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function l(e){return e.split(i).join("\\").split(o).join("{").split(a).join("}").split(c).join(",").split(h).join(".")}function d(e){if(!e)return[""];var t=[],s=n("{","}",e);if(!s)return e.split(",");var r=s.pre,i=s.body,o=s.post,a=r.split(",");a[a.length-1]+="{"+i+"}";var c=d(o);return o.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),t.push.apply(t,a),t}function p(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function m(e,t){return e<=t}function g(e,t){return e>=t}function b(e,t){var s=[],i=n("{","}",e);if(!i||/\$$/.test(i.pre))return[e];var o,c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),h=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),l=c||h,v=i.body.indexOf(",")>=0;if(!l&&!v)return i.post.match(/,.*\}/)?b(e=i.pre+"{"+i.body+a+i.post):[e];if(l)o=i.body.split(/\.\./);else if(1===(o=d(i.body)).length&&1===(o=b(o[0],!1).map(p)).length)return(E=i.post.length?b(i.post,!1):[""]).map((function(e){return i.pre+o[0]+e}));var y,S=i.pre,E=i.post.length?b(i.post,!1):[""];if(l){var x=u(o[0]),w=u(o[1]),R=Math.max(o[0].length,o[1].length),_=3==o.length?Math.abs(u(o[2])):1,C=m;w<x&&(_*=-1,C=g);var k=o.some(f);y=[];for(var O=x;C(O,w);O+=_){var P;if(h)"\\"===(P=String.fromCharCode(O))&&(P="");else if(P=String(O),k){var T=R-P.length;if(T>0){var M=new Array(T+1).join("0");P=O<0?"-"+M+P.slice(1):M+P}}y.push(P)}}else y=r(o,(function(e){return b(e,!1)}));for(var I=0;I<y.length;I++)for(var D=0;D<E.length;D++){var A=S+y[I]+E[D];(!t||l||A)&&s.push(A)}return s}},5497:(e,t,s)=>{e.exports=s(1261)},1261:(e,t,s)=>{"use strict";var r=s(2081).exec,n=s(2081).execSync,i=s(358),o=s(1017),a=i.access,c=i.accessSync,h=i.constants||i,u="win32"==process.platform,l=function(e){return/[^A-Za-z0-9_\/:=-]/.test(e)&&(e=(e="'"+e.replace(/'/g,"'\\''")+"'").replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),e};u&&(l=function(e){return/[\\]/.test(e)?'"'+o.dirname(e)+'":"'+o.basename(e)+'"':'"'+e+'"'}),e.exports=function e(t,s){var n=l(t);if(!s&&"undefined"!=typeof Promise)return new Promise((function(s,r){e(t,(function(e,n){n?s(t):r(e)}))}));u?function(e,t,s){/^(?!(?:.*\s|.*\.|\W+)$)(?:[a-zA-Z]:)?(?:(?:[^<>:"\|\?\*\n])+(?:\/\/|\/|\\\\|\\)?)+$/m.test(e)?r("where "+t,(function(e){s(null,null===e)})):s(null,!1)}(t,n,s):function(e,t,s){!function(e,t){a(e,h.F_OK,(function(e){t(!e)}))}(e,(function(n){n?function(e,t){a(e,h.F_OK|h.X_OK,(function(e){t(null,!e)}))}(e,s):r("command -v "+t+" 2>/dev/null && { echo >&1 "+t+"; exit 0; }",(function(e,t,r){s(null,!!t)}))}))}(t,n,s)},e.exports.sync=function(e){var t=l(e);return u?function(e,t,s){if(!/^(?!(?:.*\s|.*\.|\W+)$)(?:[a-zA-Z]:)?(?:(?:[^<>:"\|\?\*\n])+(?:\/\/|\/|\\\\|\\)?)+$/m.test(e))return!1;try{return!!n("where "+t,{stdio:[]})}catch(e){return!1}}(e,t):function(e,t){if(function(e){try{return c(e,h.F_OK),!1}catch(e){return!0}}(e))try{return!!n("command -v "+t+" 2>/dev/null && { echo >&1 "+t+"; exit 0; }")}catch(e){return!1}return function(e){try{return c(e,h.F_OK|h.X_OK),!0}catch(e){return!1}}(e)}(e,t)}},1048:e=>{e.exports=function(e,s){for(var r=[],n=0;n<e.length;n++){var i=s(e[n],n);t(i)?r.push.apply(r,i):r.push(i)}return r};var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},7334:(e,t,s)=>{e.exports=u,u.realpath=u,u.sync=l,u.realpathSync=l,u.monkeypatch=function(){r.realpath=u,r.realpathSync=l},u.unmonkeypatch=function(){r.realpath=n,r.realpathSync=i};var r=s(358),n=r.realpath,i=r.realpathSync,o=process.version,a=/^v[0-5]\./.test(o),c=s(7059);function h(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function u(e,t,s){if(a)return n(e,t,s);"function"==typeof t&&(s=t,t=null),n(e,t,(function(r,n){h(r)?c.realpath(e,t,s):s(r,n)}))}function l(e,t){if(a)return i(e,t);try{return i(e,t)}catch(s){if(h(s))return c.realpathSync(e,t);throw s}}},7059:(e,t,s)=>{var r=s(1017),n="win32"===process.platform,i=s(358),o=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);if(r.normalize,n)var a=/(.*?)(?:[\/\\]+|$)/g;else a=/(.*?)(?:[\/]+|$)/g;if(n)var c=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else c=/^[\/]*/;t.realpathSync=function(e,t){if(e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var s,o,h,u,l=e,d={},p={};function f(){var t=c.exec(e);s=t[0].length,o=t[0],h=t[0],u="",n&&!p[h]&&(i.lstatSync(h),p[h]=!0)}for(f();s<e.length;){a.lastIndex=s;var m=a.exec(e);if(u=o,o+=m[0],h=u+m[1],s=a.lastIndex,!(p[h]||t&&t[h]===h)){var g;if(t&&Object.prototype.hasOwnProperty.call(t,h))g=t[h];else{var b=i.lstatSync(h);if(!b.isSymbolicLink()){p[h]=!0,t&&(t[h]=h);continue}var v=null;if(!n){var y=b.dev.toString(32)+":"+b.ino.toString(32);d.hasOwnProperty(y)&&(v=d[y])}null===v&&(i.statSync(h),v=i.readlinkSync(h)),g=r.resolve(u,v),t&&(t[h]=g),n||(d[y]=v)}e=r.resolve(g,e.slice(s)),f()}}return t&&(t[l]=e),e},t.realpath=function(e,t,s){if("function"!=typeof s&&(s=function(e){return"function"==typeof e?e:function(){var e;if(o){var t=new Error;e=function(e){e&&(t.message=e.message,s(e=t))}}else e=s;return e;function s(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}(t),t=null),e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(s.bind(null,null,t[e]));var h,u,l,d,p=e,f={},m={};function g(){var t=c.exec(e);h=t[0].length,u=t[0],l=t[0],d="",n&&!m[l]?i.lstat(l,(function(e){if(e)return s(e);m[l]=!0,b()})):process.nextTick(b)}function b(){if(h>=e.length)return t&&(t[p]=e),s(null,e);a.lastIndex=h;var r=a.exec(e);return d=u,u+=r[0],l=d+r[1],h=a.lastIndex,m[l]||t&&t[l]===l?process.nextTick(b):t&&Object.prototype.hasOwnProperty.call(t,l)?S(t[l]):i.lstat(l,v)}function v(e,r){if(e)return s(e);if(!r.isSymbolicLink())return m[l]=!0,t&&(t[l]=l),process.nextTick(b);if(!n){var o=r.dev.toString(32)+":"+r.ino.toString(32);if(f.hasOwnProperty(o))return y(null,f[o],l)}i.stat(l,(function(e){if(e)return s(e);i.readlink(l,(function(e,t){n||(f[o]=t),y(e,t)}))}))}function y(e,n,i){if(e)return s(e);var o=r.resolve(d,n);t&&(t[i]=o),S(o)}function S(t){e=r.resolve(t,e.slice(h)),g()}g()}},6772:(e,t,s)=>{function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.setopts=function(e,t,s){if(s||(s={}),s.matchBase&&-1===t.indexOf("/")){if(s.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!s.silent,e.pattern=t,e.strict=!1!==s.strict,e.realpath=!!s.realpath,e.realpathCache=s.realpathCache||Object.create(null),e.follow=!!s.follow,e.dot=!!s.dot,e.mark=!!s.mark,e.nodir=!!s.nodir,e.nodir&&(e.mark=!0),e.sync=!!s.sync,e.nounique=!!s.nounique,e.nonull=!!s.nonull,e.nosort=!!s.nosort,e.nocase=!!s.nocase,e.stat=!!s.stat,e.noprocess=!!s.noprocess,e.absolute=!!s.absolute,e.fs=s.fs||n,e.maxLength=s.maxLength||1/0,e.cache=s.cache||Object.create(null),e.statCache=s.statCache||Object.create(null),e.symlinks=s.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]),e.ignore.length&&(e.ignore=e.ignore.map(u))}(e,s),e.changedCwd=!1;var o=process.cwd();r(s,"cwd")?(e.cwd=i.resolve(s.cwd),e.changedCwd=e.cwd!==o):e.cwd=o,e.root=s.root||i.resolve(e.cwd,"/"),e.root=i.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/")),e.cwdAbs=a(e.cwd)?e.cwd:l(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/")),e.nomount=!!s.nomount,s.nonegate=!0,s.nocomment=!0,e.minimatch=new c(t,s),e.options=e.minimatch.options},t.ownProp=r,t.makeAbs=l,t.finish=function(e){for(var t=e.nounique,s=t?[]:Object.create(null),r=0,n=e.matches.length;r<n;r++){var i=e.matches[r];if(i&&0!==Object.keys(i).length){var o=Object.keys(i);t?s.push.apply(s,o):o.forEach((function(e){s[e]=!0}))}else if(e.nonull){var a=e.minimatch.globSet[r];t?s.push(a):s[a]=!0}}if(t||(s=Object.keys(s)),e.nosort||(s=s.sort(h)),e.mark){for(r=0;r<s.length;r++)s[r]=e._mark(s[r]);e.nodir&&(s=s.filter((function(t){var s=!/\/$/.test(t),r=e.cache[t]||e.cache[l(e,t)];return s&&r&&(s="DIR"!==r&&!Array.isArray(r)),s})))}e.ignore.length&&(s=s.filter((function(t){return!d(e,t)}))),e.found=s},t.mark=function(e,t){var s=l(e,t),r=e.cache[s],n=t;if(r){var i="DIR"===r||Array.isArray(r),o="/"===t.slice(-1);if(i&&!o?n+="/":!i&&o&&(n=n.slice(0,-1)),n!==t){var a=l(e,n);e.statCache[a]=e.statCache[s],e.cache[a]=e.cache[s]}}return n},t.isIgnored=d,t.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var n=s(358),i=s(1017),o=s(6522),a=s(4095),c=o.Minimatch;function h(e,t){return e.localeCompare(t,"en")}function u(e){var t=null;if("/**"===e.slice(-3)){var s=e.replace(/(\/\*\*)+$/,"");t=new c(s,{dot:!0})}return{matcher:new c(e,{dot:!0}),gmatcher:t}}function l(e,t){var s=t;return s="/"===t.charAt(0)?i.join(e.root,t):a(t)||""===t?t:e.changedCwd?i.resolve(e.cwd,t):i.resolve(t),"win32"===process.platform&&(s=s.replace(/\\/g,"/")),s}function d(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}},2884:(e,t,s)=>{e.exports=v;var r=s(7334),n=s(6522),i=(n.Minimatch,s(4378)),o=s(2361).EventEmitter,a=s(1017),c=s(9491),h=s(4095),u=s(4751),l=s(6772),d=l.setopts,p=l.ownProp,f=s(7844),m=(s(3837),l.childrenIgnored),g=l.isIgnored,b=s(778);function v(e,t,s){if("function"==typeof t&&(s=t,t={}),t||(t={}),t.sync){if(s)throw new TypeError("callback provided to sync glob");return u(e,t)}return new S(e,t,s)}v.sync=u;var y=v.GlobSync=u.GlobSync;function S(e,t,s){if("function"==typeof t&&(s=t,t=null),t&&t.sync){if(s)throw new TypeError("callback provided to sync glob");return new y(e,t)}if(!(this instanceof S))return new S(e,t,s);d(this,e,t),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),"function"==typeof s&&(s=b(s),this.on("error",s),this.on("end",(function(e){s(null,e)})));var n=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===r)return o();for(var i=0;i<r;i++)this._process(this.minimatch.set[i],i,!1,o);function o(){--n._processing,n._processing<=0&&n._finish()}}v.glob=v,v.hasMagic=function(e,t){var s=function(e,t){if(null===t||"object"!=typeof t)return e;for(var s=Object.keys(t),r=s.length;r--;)e[s[r]]=t[s[r]];return e}({},t);s.noprocess=!0;var r=new S(e,s).minimatch.set;if(!e)return!1;if(r.length>1)return!0;for(var n=0;n<r[0].length;n++)if("string"!=typeof r[0][n])return!0;return!1},v.Glob=S,i(S,o),S.prototype._finish=function(){if(c(this instanceof S),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();l.finish(this),this.emit("end",this.found)}},S.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,s=0;s<this.matches.length;s++)this._realpathSet(s,r)}function r(){0==--e&&t._finish()}},S.prototype._realpathSet=function(e,t){var s=this.matches[e];if(!s)return t();var n=Object.keys(s),i=this,o=n.length;if(0===o)return t();var a=this.matches[e]=Object.create(null);n.forEach((function(s,n){s=i._makeAbs(s),r.realpath(s,i.realpathCache,(function(r,n){r?"stat"===r.syscall?a[s]=!0:i.emit("error",r):a[n]=!0,0==--o&&(i.matches[e]=a,t())}))}))},S.prototype._mark=function(e){return l.mark(this,e)},S.prototype._makeAbs=function(e){return l.makeAbs(this,e)},S.prototype.abort=function(){this.aborted=!0,this.emit("abort")},S.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},S.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var s=e[t];this._emitMatch(s[0],s[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);for(this._processQueue.length=0,t=0;t<r.length;t++){var n=r[t];this._processing--,this._process(n[0],n[1],n[2],n[3])}}}},S.prototype._process=function(e,t,s,r){if(c(this instanceof S),c("function"==typeof r),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,s,r]);else{for(var i,o=0;"string"==typeof e[o];)o++;switch(o){case e.length:return void this._processSimple(e.join("/"),t,r);case 0:i=null;break;default:i=e.slice(0,o).join("/")}var a,u=e.slice(o);null===i?a=".":h(i)||h(e.join("/"))?(i&&h(i)||(i="/"+i),a=i):a=i;var l=this._makeAbs(a);if(m(this,a))return r();u[0]===n.GLOBSTAR?this._processGlobStar(i,a,l,u,t,s,r):this._processReaddir(i,a,l,u,t,s,r)}},S.prototype._processReaddir=function(e,t,s,r,n,i,o){var a=this;this._readdir(s,i,(function(c,h){return a._processReaddir2(e,t,s,r,n,i,h,o)}))},S.prototype._processReaddir2=function(e,t,s,r,n,i,o,c){if(!o)return c();for(var h=r[0],u=!!this.minimatch.negate,l=h._glob,d=this.dot||"."===l.charAt(0),p=[],f=0;f<o.length;f++)("."!==(g=o[f]).charAt(0)||d)&&(u&&!e?!g.match(h):g.match(h))&&p.push(g);var m=p.length;if(0===m)return c();if(1===r.length&&!this.mark&&!this.stat){for(this.matches[n]||(this.matches[n]=Object.create(null)),f=0;f<m;f++){var g=p[f];e&&(g="/"!==e?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=a.join(this.root,g)),this._emitMatch(n,g)}return c()}for(r.shift(),f=0;f<m;f++)g=p[f],e&&(g="/"!==e?e+"/"+g:e+g),this._process([g].concat(r),n,i,c);c()},S.prototype._emitMatch=function(e,t){if(!this.aborted&&!g(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var s=h(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=s),!this.matches[e][t]){if(this.nodir){var r=this.cache[s];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0;var n=this.statCache[s];n&&this.emit("stat",t,n),this.emit("match",t)}}},S.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var s=this,r=f("lstat\0"+e,(function(r,n){if(r&&"ENOENT"===r.code)return t();var i=n&&n.isSymbolicLink();s.symlinks[e]=i,i||!n||n.isDirectory()?s._readdir(e,!1,t):(s.cache[e]="FILE",t())}));r&&s.fs.lstat(e,r)}},S.prototype._readdir=function(e,t,s){if(!this.aborted&&(s=f("readdir\0"+e+"\0"+t,s))){if(t&&!p(this.symlinks,e))return this._readdirInGlobStar(e,s);if(p(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return s();if(Array.isArray(r))return s(null,r)}this.fs.readdir(e,function(e,t,s){return function(r,n){r?e._readdirError(t,r,s):e._readdirEntries(t,n,s)}}(this,e,s))}},S.prototype._readdirEntries=function(e,t,s){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,s(null,t)}},S.prototype._readdirError=function(e,t,s){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);n.path=this.cwd,n.code=t.code,this.emit("error",n),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return s()}},S.prototype._processGlobStar=function(e,t,s,r,n,i,o){var a=this;this._readdir(s,i,(function(c,h){a._processGlobStar2(e,t,s,r,n,i,h,o)}))},S.prototype._processGlobStar2=function(e,t,s,r,n,i,o,a){if(!o)return a();var c=r.slice(1),h=e?[e]:[],u=h.concat(c);this._process(u,n,!1,a);var l=this.symlinks[s],d=o.length;if(l&&i)return a();for(var p=0;p<d;p++)if("."!==o[p].charAt(0)||this.dot){var f=h.concat(o[p],c);this._process(f,n,!0,a);var m=h.concat(o[p],r);this._process(m,n,!0,a)}a()},S.prototype._processSimple=function(e,t,s){var r=this;this._stat(e,(function(n,i){r._processSimple2(e,t,n,i,s)}))},S.prototype._processSimple2=function(e,t,s,r,n){if(this.matches[t]||(this.matches[t]=Object.create(null)),!r)return n();if(e&&h(e)&&!this.nomount){var i=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=a.join(this.root,e):(e=a.resolve(this.root,e),i&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),n()},S.prototype._stat=function(e,t){var s=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&p(this.cache,s)){var n=this.cache[s];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return t(null,n);if(r&&"FILE"===n)return t()}var i=this.statCache[s];if(void 0!==i){if(!1===i)return t(null,i);var o=i.isDirectory()?"DIR":"FILE";return r&&"FILE"===o?t():t(null,o,i)}var a=this,c=f("stat\0"+s,(function(r,n){if(n&&n.isSymbolicLink())return a.fs.stat(s,(function(r,i){r?a._stat2(e,s,null,n,t):a._stat2(e,s,r,i,t)}));a._stat2(e,s,r,n,t)}));c&&a.fs.lstat(s,c)},S.prototype._stat2=function(e,t,s,r,n){if(s&&("ENOENT"===s.code||"ENOTDIR"===s.code))return this.statCache[t]=!1,n();var i="/"===e.slice(-1);if(this.statCache[t]=r,"/"===t.slice(-1)&&r&&!r.isDirectory())return n(null,!1,r);var o=!0;return r&&(o=r.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,i&&"FILE"===o?n():n(null,o,r)}},6522:(e,t,s)=>{e.exports=d,d.Minimatch=p;var r=function(){try{return s(1017)}catch(e){}}()||{sep:"/"};d.sep=r.sep;var n=d.GLOBSTAR=p.GLOBSTAR={},i=s(3644),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="[^/]",c="[^/]*?",h="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{}),u=/\/+/;function l(e,t){t=t||{};var s={};return Object.keys(e).forEach((function(t){s[t]=e[t]})),Object.keys(t).forEach((function(e){s[e]=t[e]})),s}function d(e,t,s){return m(t),s||(s={}),!(!s.nocomment&&"#"===t.charAt(0))&&new p(t,s).match(e)}function p(e,t){if(!(this instanceof p))return new p(e,t);m(e),t||(t={}),e=e.trim(),t.allowWindowsEscape||"/"===r.sep||(e=e.split(r.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}function f(e,t){return t||(t=this instanceof p?this.options:{}),e=void 0===e?this.pattern:e,m(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:i(e)}d.filter=function(e,t){return t=t||{},function(s,r,n){return d(s,e,t)}},d.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return d;var t=d,s=function(s,r,n){return t(s,r,l(e,n))};return(s.Minimatch=function(s,r){return new t.Minimatch(s,l(e,r))}).defaults=function(s){return t.defaults(l(e,s)).Minimatch},s.filter=function(s,r){return t.filter(s,l(e,r))},s.defaults=function(s){return t.defaults(l(e,s))},s.makeRe=function(s,r){return t.makeRe(s,l(e,r))},s.braceExpand=function(s,r){return t.braceExpand(s,l(e,r))},s.match=function(s,r,n){return t.match(s,r,l(e,n))},s},p.defaults=function(e){return d.defaults(e).Minimatch},p.prototype.debug=function(){},p.prototype.make=function(){var e=this.pattern,t=this.options;if(t.nocomment||"#"!==e.charAt(0))if(e){this.parseNegate();var s=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,s),s=this.globParts=s.map((function(e){return e.split(u)})),this.debug(this.pattern,s),s=s.map((function(e,t,s){return e.map(this.parse,this)}),this),this.debug(this.pattern,s),s=s.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,s),this.set=s}else this.empty=!0;else this.comment=!0},p.prototype.parseNegate=function(){var e=this.pattern,t=!1,s=0;if(!this.options.nonegate){for(var r=0,n=e.length;r<n&&"!"===e.charAt(r);r++)t=!t,s++;s&&(this.pattern=e.substr(s)),this.negate=t}},d.braceExpand=function(e,t){return f(e,t)},p.prototype.braceExpand=f;var m=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};p.prototype.parse=function(e,t){m(e);var s=this.options;if("**"===e){if(!s.noglobstar)return n;e="*"}if(""===e)return"";var r,i="",u=!!s.nocase,l=!1,d=[],p=[],f=!1,b=-1,v=-1,y="."===e.charAt(0)?"":s.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",S=this;function E(){if(r){switch(r){case"*":i+=c,u=!0;break;case"?":i+=a,u=!0;break;default:i+="\\"+r}S.debug("clearStateChar %j %j",r,i),r=!1}}for(var x,w=0,R=e.length;w<R&&(x=e.charAt(w));w++)if(this.debug("%s\t%s %s %j",e,w,i,x),l&&h[x])i+="\\"+x,l=!1;else switch(x){case"/":return!1;case"\\":E(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,w,i,x),f){this.debug("  in class"),"!"===x&&w===v+1&&(x="^"),i+=x;continue}S.debug("call clearStateChar %j",r),E(),r=x,s.noext&&E();continue;case"(":if(f){i+="(";continue}if(!r){i+="\\(";continue}d.push({type:r,start:w-1,reStart:i.length,open:o[r].open,close:o[r].close}),i+="!"===r?"(?:(?!(?:":"(?:",this.debug("plType %j %j",r,i),r=!1;continue;case")":if(f||!d.length){i+="\\)";continue}E(),u=!0;var _=d.pop();i+=_.close,"!"===_.type&&p.push(_),_.reEnd=i.length;continue;case"|":if(f||!d.length||l){i+="\\|",l=!1;continue}E(),i+="|";continue;case"[":if(E(),f){i+="\\"+x;continue}f=!0,v=w,b=i.length,i+=x;continue;case"]":if(w===v+1||!f){i+="\\"+x,l=!1;continue}var C=e.substring(v+1,w);try{RegExp("["+C+"]")}catch(e){var k=this.parse(C,g);i=i.substr(0,b)+"\\["+k[0]+"\\]",u=u||k[1],f=!1;continue}u=!0,f=!1,i+=x;continue;default:E(),l?l=!1:!h[x]||"^"===x&&f||(i+="\\"),i+=x}for(f&&(C=e.substr(v+1),k=this.parse(C,g),i=i.substr(0,b)+"\\["+k[0],u=u||k[1]),_=d.pop();_;_=d.pop()){var O=i.slice(_.reStart+_.open.length);this.debug("setting tail",i,_),O=O.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,s){return s||(s="\\"),t+t+s+"|"})),this.debug("tail=%j\n   %s",O,O,_,i);var P="*"===_.type?c:"?"===_.type?a:"\\"+_.type;u=!0,i=i.slice(0,_.reStart)+P+"\\("+O}E(),l&&(i+="\\\\");var T=!1;switch(i.charAt(0)){case"[":case".":case"(":T=!0}for(var M=p.length-1;M>-1;M--){var I=p[M],D=i.slice(0,I.reStart),A=i.slice(I.reStart,I.reEnd-8),N=i.slice(I.reEnd-8,I.reEnd),$=i.slice(I.reEnd);N+=$;var L=D.split("(").length-1,F=$;for(w=0;w<L;w++)F=F.replace(/\)[+*?]?/,"");var j="";""===($=F)&&t!==g&&(j="$"),i=D+A+$+j+N}if(""!==i&&u&&(i="(?=.)"+i),T&&(i=y+i),t===g)return[i,u];if(!u)return e.replace(/\\(.)/g,"$1");var q=s.nocase?"i":"";try{var B=new RegExp("^"+i+"$",q)}catch(e){return new RegExp("$.")}return B._glob=e,B._src=i,B};var g={};d.makeRe=function(e,t){return new p(e,t||{}).makeRe()},p.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,s=t.noglobstar?c:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",r=t.nocase?"i":"",i=e.map((function(e){return e.map((function(e){return e===n?s:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(e){this.regexp=!1}return this.regexp},d.match=function(e,t,s){var r=new p(t,s=s||{});return e=e.filter((function(e){return r.match(e)})),r.options.nonull&&!e.length&&e.push(t),e},p.prototype.match=function(e,t){if(void 0===t&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var s=this.options;"/"!==r.sep&&(e=e.split(r.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);var n,i,o=this.set;for(this.debug(this.pattern,"set",o),i=e.length-1;i>=0&&!(n=e[i]);i--);for(i=0;i<o.length;i++){var a=o[i],c=e;if(s.matchBase&&1===a.length&&(c=[n]),this.matchOne(c,a,t))return!!s.flipNegate||!this.negate}return!s.flipNegate&&this.negate},p.prototype.matchOne=function(e,t,s){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,o=0,a=e.length,c=t.length;i<a&&o<c;i++,o++){this.debug("matchOne loop");var h,u=t[o],l=e[i];if(this.debug(t,u,l),!1===u)return!1;if(u===n){this.debug("GLOBSTAR",[t,u,l]);var d=i,p=o+1;if(p===c){for(this.debug("** at the end");i<a;i++)if("."===e[i]||".."===e[i]||!r.dot&&"."===e[i].charAt(0))return!1;return!0}for(;d<a;){var f=e[d];if(this.debug("\nglobstar while",e,d,t,p,f),this.matchOne(e.slice(d),t.slice(p),s))return this.debug("globstar found match!",d,a,f),!0;if("."===f||".."===f||!r.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,d,t,p);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!s||(this.debug("\n>>> no match, partial?",e,d,t,p),d!==a))}if("string"==typeof u?(h=l===u,this.debug("string match",u,l,h)):(h=l.match(u),this.debug("pattern match",u,l,h)),!h)return!1}if(i===a&&o===c)return!0;if(i===a)return s;if(o===c)return i===a-1&&""===e[i];throw new Error("wtf?")}},4751:(e,t,s)=>{e.exports=p,p.GlobSync=f;var r=s(7334),n=s(6522),i=(n.Minimatch,s(2884).Glob,s(3837),s(1017)),o=s(9491),a=s(4095),c=s(6772),h=c.setopts,u=c.ownProp,l=c.childrenIgnored,d=c.isIgnored;function p(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new f(e,t).found}function f(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof f))return new f(e,t);if(h(this,e,t),this.noprocess)return this;var s=this.minimatch.set.length;this.matches=new Array(s);for(var r=0;r<s;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}f.prototype._finish=function(){if(o(this instanceof f),this.realpath){var e=this;this.matches.forEach((function(t,s){var n=e.matches[s]=Object.create(null);for(var i in t)try{i=e._makeAbs(i),n[r.realpathSync(i,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;n[e._makeAbs(i)]=!0}}))}c.finish(this)},f.prototype._process=function(e,t,s){o(this instanceof f);for(var r,i=0;"string"==typeof e[i];)i++;switch(i){case e.length:return void this._processSimple(e.join("/"),t);case 0:r=null;break;default:r=e.slice(0,i).join("/")}var c,h=e.slice(i);null===r?c=".":a(r)||a(e.join("/"))?(r&&a(r)||(r="/"+r),c=r):c=r;var u=this._makeAbs(c);l(this,c)||(h[0]===n.GLOBSTAR?this._processGlobStar(r,c,u,h,t,s):this._processReaddir(r,c,u,h,t,s))},f.prototype._processReaddir=function(e,t,s,r,n,o){var a=this._readdir(s,o);if(a){for(var c=r[0],h=!!this.minimatch.negate,u=c._glob,l=this.dot||"."===u.charAt(0),d=[],p=0;p<a.length;p++)("."!==(g=a[p]).charAt(0)||l)&&(h&&!e?!g.match(c):g.match(c))&&d.push(g);var f=d.length;if(0!==f)if(1!==r.length||this.mark||this.stat)for(r.shift(),p=0;p<f;p++){var m;g=d[p],m=e?[e,g]:[g],this._process(m.concat(r),n,o)}else{this.matches[n]||(this.matches[n]=Object.create(null));for(p=0;p<f;p++){var g=d[p];e&&(g="/"!==e.slice(-1)?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=i.join(this.root,g)),this._emitMatch(n,g)}}}},f.prototype._emitMatch=function(e,t){if(!d(this,t)){var s=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=s),!this.matches[e][t]){if(this.nodir){var r=this.cache[s];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},f.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,s;try{s=this.fs.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var r=s&&s.isSymbolicLink();return this.symlinks[e]=r,r||!s||s.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},f.prototype._readdir=function(e,t){if(t&&!u(this.symlinks,e))return this._readdirInGlobStar(e);if(u(this.cache,e)){var s=this.cache[e];if(!s||"FILE"===s)return null;if(Array.isArray(s))return s}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},f.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var s=0;s<t.length;s++){var r=t[s];r="/"===e?e+r:e+"/"+r,this.cache[r]=!0}return this.cache[e]=t,t},f.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var s=this._makeAbs(e);if(this.cache[s]="FILE",s===this.cwdAbs){var r=new Error(t.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=t.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},f.prototype._processGlobStar=function(e,t,s,r,n,i){var o=this._readdir(s,i);if(o){var a=r.slice(1),c=e?[e]:[],h=c.concat(a);this._process(h,n,!1);var u=o.length;if(!this.symlinks[s]||!i)for(var l=0;l<u;l++)if("."!==o[l].charAt(0)||this.dot){var d=c.concat(o[l],a);this._process(d,n,!0);var p=c.concat(o[l],r);this._process(p,n,!0)}}},f.prototype._processSimple=function(e,t){var s=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),s){if(e&&a(e)&&!this.nomount){var r=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=i.join(this.root,e):(e=i.resolve(this.root,e),r&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},f.prototype._stat=function(e){var t=this._makeAbs(e),s="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&u(this.cache,t)){var r=this.cache[t];if(Array.isArray(r)&&(r="DIR"),!s||"DIR"===r)return r;if(s&&"FILE"===r)return!1}var n=this.statCache[t];if(!n){var i;try{i=this.fs.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(i&&i.isSymbolicLink())try{n=this.fs.statSync(t)}catch(e){n=i}else n=i}return this.statCache[t]=n,r=!0,n&&(r=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||r,(!s||"FILE"!==r)&&r},f.prototype._mark=function(e){return c.mark(this,e)},f.prototype._makeAbs=function(e){return c.makeAbs(this,e)}},6478:(e,t,s)=>{"use strict";var r=s(8223),n=s(358),i=s(1017);function o(e,t){r.some(a(e),c,t)}function a(e){var t=process.env.PATH||"",s=process.env.PATHEXT||"";return t.replace(/["]+/g,"").split(i.delimiter).map((function(t){return s.split(i.delimiter).map((function(s){return i.join(t,e+s)}))})).reduce((function(e,t){return e.concat(t)}))}function c(e,t){n.stat(e,(function(e,s){if(e)return t(!1);t(s.isFile())}))}function h(e){try{return n.statSync(e).isFile()}catch(e){return!1}}e.exports=o,o.async=o,o.sync=function(e){return a(e).some(h)},o.all=function(e,t){r.every(e,o.async,t)},o.all.sync=function(e){return e.every(o.sync)},o.some=function(e,t){r.some(e,o.async,t)},o.some.sync=function(e){return e.some(o.sync)},o.first=function(e,t){r.detect(e,o.async,(function(e){t(e||!1)}))},o.first.sync=function(e){var t=e.filter(o.sync);return!!t.length&&t[0]},o.every=o.all,o.any=o.some},7844:(e,t,s)=>{var r=s(2479),n=Object.create(null),i=s(778);function o(e){for(var t=e.length,s=[],r=0;r<t;r++)s[r]=e[r];return s}e.exports=r((function(e,t){return n[e]?(n[e].push(t),null):(n[e]=[t],function(e){return i((function t(){var s=n[e],r=s.length,i=o(arguments);try{for(var a=0;a<r;a++)s[a].apply(null,i)}finally{s.length>r?(s.splice(0,r),process.nextTick((function(){t.apply(null,i)}))):delete n[e]}}))}(e))}))},4378:(e,t,s)=>{try{var r=s(3837);if("function"!=typeof r.inherits)throw"";e.exports=r.inherits}catch(t){e.exports=s(5717)}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}}},970:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var r=s(2781);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?h(e):t}var l,d=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function f(e){return e?"function"==typeof e.then?l.Promise:function(e){return"function"==typeof e.read&&"function"==typeof e.pause&&"function"==typeof e.resume&&"function"==typeof e.pipe&&"function"==typeof e.once&&"function"==typeof e.removeListener}(e)?e._readableState.objectMode?l.ReadableObject:l.ReadableString:Array.isArray(e)?l.Array:"object"===n(e)||e instanceof Object?l.Object:l.Primitive:l.Primitive}!function(e){e[e.Array=0]="Array",e[e.Object=1]="Object",e[e.ReadableString=2]="ReadableString",e[e.ReadableObject=3]="ReadableObject",e[e.Primitive=4]="Primitive",e[e.Promise=5]="Promise"}(l||(l={}));var m=[];m[l.Array]="[",m[l.Object]="{",m[l.ReadableString]='"',m[l.ReadableObject]="[";var g,b,v=[];v[l.Array]="]",v[l.Object]="}",v[l.ReadableString]='"',v[l.ReadableObject]="]";for(var y=[],S=0,E=Object.entries(l);S<E.length;S++){var x=(g=E[S],b=2,function(e){if(Array.isArray(e))return e}(g)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var s=[],r=!0,n=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(s.push(o.value),!t||s.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return s}}(g,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()),w=x[0],R=x[1];"number"==typeof R&&(y[R]="process".concat(w))}function _(e){return e.replace(d,(function(e){var t=p[e];return"string"==typeof t?t:"\\u".concat(e.charCodeAt(0).toString(16).padStart(4,"0"))}))}function C(e){return'"'.concat(_(e),'"')}function k(e,t){var s=e.read(t);return null===s?new Promise((function(t,s){var r=function(){return t(null)};e.once("end",r),e.once("error",s),e.once("readable",(function(){e.removeListener("end",r),e.removeListener("error",s),t(e.read())}))})):Promise.resolve(s)}function O(e){return e.then((function(e){return f(e)===l.Promise?O(e):e}))}var P=function(e){function t(e,s,r){var o,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,t),(o=u(this,a(t).call(this,{encoding:"utf8"}))).cycle=c,o.stack=[],o.depth=0,o.pushCalled=!1,o.end=!1,o.isReading=!1,o.readMore=!1;var l=n(r);return"string"!==l&&"number"!==l||(o.gap=Number.isFinite(r)?" ".repeat(r):r),Object.assign(h(o),{visited:c?new WeakMap:new WeakSet,replacerFunction:s instanceof Function&&s,replacerArray:Array.isArray(s)&&s}),s instanceof Function&&(o.replacerFunction=s),Array.isArray(s)&&(o.replacerArray=s),o.addToStack(e),o}var s,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),s=t,r=[{key:"cycler",value:function(e,t){var s=this.visited.get(t);if(s)return{$ref:s};var r=this.path();return void 0!==e&&r.push(e),r=r.map((function(e){return"[".concat(Number.isInteger(e)?e:C(e),"]")})),this.visited.set(t,r.length?"$".concat(r.join("")):"$"),t}},{key:"addToStack",value:function(e,t,s,r){var i,o,a=this,c=e;this.replacerFunction&&(c=this.replacerFunction(t||s,c,this)),c&&c.toJSON instanceof Function&&(c=c.toJSON()),(c instanceof Function||"symbol"===n(e))&&(c=void 0),void 0!==t&&this.replacerArray&&(this.replacerArray.includes(t)||(c=void 0));var h=f(c);if((r&&r.type===l.Array||void 0!==c)&&h!==l.Promise&&(r&&!r.first&&this._push(","),r&&(r.first=!1)),void 0!==c&&h!==l.Promise&&t&&(this.gap?this._push("\n".concat(this.gap.repeat(this.depth),'"').concat(_(t),'": ')):this._push('"'.concat(_(t),'":'))),h!==l.Primitive)if(this.cycle)h=f(c=this.cycler(t||s,c));else{if(this.visited.has(c))throw Object.assign(new Error("Converting circular structure to JSON"),{realValue:c,key:t||s});this.visited.add(c)}!t&&s>-1&&this.depth&&this.gap&&this._push("\n".concat(this.gap.repeat(this.depth)));var u=m[h];u&&this._push(u);var d={key:t,index:s,type:h,parent:r,value:c,first:!0};return h===l.Object?(this.depth+=1,d.unread=Object.keys(c),d.isEmpty=!d.unread.length):h===l.Array?(this.depth+=1,d.unread=c.length,d.arrayLength=d.unread,d.isEmpty=!d.unread):h!==l.ReadableString&&h!==l.ReadableObject||(this.depth+=1,c.readableEnded||(null===(i=c._readableState)||void 0===i?void 0:i.endEmitted)?this.emit("error",new Error("Readable Stream has ended before it was serialized. All stream data have been lost"),c,t||s):(c.readableFlowing||(null===(o=c._readableState)||void 0===o?void 0:o.flowing))&&(c.pause(),this.emit("error",new Error("Readable Stream is in flowing mode, data may have been lost. Trying to pause stream."),c,t||s)),d.readCount=0,c.once("end",(function(){d.end=!0,a.__read()})),c.once("error",(function(e){a.error=!0,a.emit("error",e)}))),this.stack.unshift(d),d}},{key:"removeFromStack",value:function(e){var t=e.type,s=t===l.Object||t===l.Array||t===l.ReadableString||t===l.ReadableObject;t!==l.Primitive&&(this.cycle||this.visited.delete(e.value),s&&(this.depth-=1));var r=v[t];s&&!e.isEmpty&&this.gap&&this._push("\n".concat(this.gap.repeat(this.depth))),r&&this._push(r);var n=this.stack.indexOf(e);this.stack.splice(n,1)}},{key:"_push",value:function(e){this.pushCalled=!0,this.push(e)}},{key:"processReadableObject",value:function(e,t){var s=this;if(!e.end)return k(e.value,t).then((function(t){null!==t&&(e.first||s._push(","),e.first=!1,s.addToStack(t,void 0,e.readCount),e.readCount+=1)}));this.removeFromStack(e)}},{key:"processObject",value:function(e){if(e.unread.length){var t=e.unread.shift(),s=e.value[t];this.addToStack(s,t,void 0,e)}else this.removeFromStack(e)}},{key:"processArray",value:function(e){var t=e.unread;if(t){var s=e.arrayLength-t,r=e.value[s];e.unread-=1,this.addToStack(r,void 0,s,e)}else this.removeFromStack(e)}},{key:"processPrimitive",value:function(e){if(void 0!==e.value){var t,s=n(e.value);switch(s){case"string":t=C(e.value);break;case"number":t=Number.isFinite(e.value)?String(e.value):"null";break;case"bigint":case"boolean":t=String(e.value);break;case"object":if(!e.value){t="null";break}default:throw Object.assign(new Error('Unknown type "'.concat(s,'". Please file an issue!')),{value:e.value})}this._push(t)}else!this.stack[1]||this.stack[1].type!==l.Array&&this.stack[1].type!==l.ReadableObject?e.addSeparatorAfterEnd=!1:this._push("null");this.removeFromStack(e)}},{key:"processReadableString",value:function(e,t){var s=this;if(!e.end)return k(e.value,t).then((function(e){e&&s._push(_(e.toString()))}));this.removeFromStack(e)}},{key:"processPromise",value:function(e){var t=this;return O(e.value).then((function(s){t.removeFromStack(e),t.addToStack(s,e.key,e.index,e.parent)}))}},{key:"processStackTopItem",value:function(e){var t,s=this,r=this.stack[0];if(!r||this.error)return Promise.resolve();try{t=this[y[r.type]](r,e)}catch(e){return Promise.reject(e)}return Promise.resolve(t).then((function(){0===s.stack.length&&(s.end=!0,s._push(null))}))}},{key:"__read",value:function(e){var t=this;if(!this.isReading&&!this.error)return this.isReading=!0,this.readMore=!1,this.processStackTopItem(e).then((function(){t.end||t.error||!t.readMore&&t.pushCalled?t.isReading=!1:setImmediate((function(){t.isReading=!1,t.__read()}))})).catch((function(e){t.error=!0,t.emit("error",e)}));this.readMore=!0}},{key:"_read",value:function(e){this.pushCalled=!1,this.__read(e)}},{key:"path",value:function(){return this.stack.map((function(e){var t=e.key,s=e.index;return t||s})).filter((function(e){return e||e>-1})).reverse()}}],r&&o(s.prototype,r),t}(r.Readable);const T=P},1890:(e,t,s)=>{const r=s(4231),n=s(3610),{mkdirpNative:i,mkdirpNativeSync:o}=s(9378),{mkdirpManual:a,mkdirpManualSync:c}=s(8600),{useNative:h,useNativeSync:u}=s(6167),l=(e,t)=>(e=n(e),t=r(t),h(t)?i(e,t):a(e,t));l.sync=(e,t)=>(e=n(e),t=r(t),u(t)?o(e,t):c(e,t)),l.native=(e,t)=>i(n(e),r(t)),l.manual=(e,t)=>a(n(e),r(t)),l.nativeSync=(e,t)=>o(n(e),r(t)),l.manualSync=(e,t)=>c(n(e),r(t)),e.exports=l},8812:(e,t,s)=>{const{dirname:r}=s(1017),n=(e,t,s)=>s===t?Promise.resolve():e.statAsync(t).then((e=>e.isDirectory()?s:void 0),(s=>"ENOENT"===s.code?n(e,r(t),t):void 0)),i=(e,t,s)=>{if(s!==t)try{return e.statSync(t).isDirectory()?s:void 0}catch(s){return"ENOENT"===s.code?i(e,r(t),t):void 0}};e.exports={findMade:n,findMadeSync:i}},8600:(e,t,s)=>{const{dirname:r}=s(1017),n=(e,t,s)=>{t.recursive=!1;const i=r(e);return i===e?t.mkdirAsync(e,t).catch((e=>{if("EISDIR"!==e.code)throw e})):t.mkdirAsync(e,t).then((()=>s||e),(r=>{if("ENOENT"===r.code)return n(i,t).then((s=>n(e,t,s)));if("EEXIST"!==r.code&&"EROFS"!==r.code)throw r;return t.statAsync(e).then((e=>{if(e.isDirectory())return s;throw r}),(()=>{throw r}))}))},i=(e,t,s)=>{const n=r(e);if(t.recursive=!1,n===e)try{return t.mkdirSync(e,t)}catch(e){if("EISDIR"!==e.code)throw e;return}try{return t.mkdirSync(e,t),s||e}catch(r){if("ENOENT"===r.code)return i(e,t,i(n,t,s));if("EEXIST"!==r.code&&"EROFS"!==r.code)throw r;try{if(!t.statSync(e).isDirectory())throw r}catch(e){throw r}}};e.exports={mkdirpManual:n,mkdirpManualSync:i}},9378:(e,t,s)=>{const{dirname:r}=s(1017),{findMade:n,findMadeSync:i}=s(8812),{mkdirpManual:o,mkdirpManualSync:a}=s(8600);e.exports={mkdirpNative:(e,t)=>(t.recursive=!0,r(e)===e?t.mkdirAsync(e,t):n(t,e).then((s=>t.mkdirAsync(e,t).then((()=>s)).catch((s=>{if("ENOENT"===s.code)return o(e,t);throw s}))))),mkdirpNativeSync:(e,t)=>{if(t.recursive=!0,r(e)===e)return t.mkdirSync(e,t);const s=i(t,e);try{return t.mkdirSync(e,t),s}catch(s){if("ENOENT"===s.code)return a(e,t);throw s}}}},4231:(e,t,s)=>{const{promisify:r}=s(3837),n=s(358);e.exports=e=>{if(e)if("object"==typeof e)e={mode:511,fs:n,...e};else if("number"==typeof e)e={mode:e,fs:n};else{if("string"!=typeof e)throw new TypeError("invalid options argument");e={mode:parseInt(e,8),fs:n}}else e={mode:511,fs:n};return e.mkdir=e.mkdir||e.fs.mkdir||n.mkdir,e.mkdirAsync=r(e.mkdir),e.stat=e.stat||e.fs.stat||n.stat,e.statAsync=r(e.stat),e.statSync=e.statSync||e.fs.statSync||n.statSync,e.mkdirSync=e.mkdirSync||e.fs.mkdirSync||n.mkdirSync,e}},3610:(e,t,s)=>{const r=process.env.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:n,parse:i}=s(1017);e.exports=e=>{if(/\0/.test(e))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:e,code:"ERR_INVALID_ARG_VALUE"});if(e=n(e),"win32"===r){const t=/[*|"<>?:]/,{root:s}=i(e);if(t.test(e.substr(s.length)))throw Object.assign(new Error("Illegal characters in path."),{path:e,code:"EINVAL"})}return e}},6167:(e,t,s)=>{const r=s(358),n=(process.env.__TESTING_MKDIRP_NODE_VERSION__||process.version).replace(/^v/,"").split("."),i=+n[0]>10||10==+n[0]&&+n[1]>=12,o=i?e=>e.mkdir===r.mkdir:()=>!1,a=i?e=>e.mkdirSync===r.mkdirSync:()=>!1;e.exports={useNative:o,useNativeSync:a}},1501:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(6774);function n(e){return void 0===e?-1:e.height}var i=function(){function e(e,t){this.intervalTree=e,this.records=[],this.height=0,this.key=t.low,this.max=t.high,this.records.push(t)}return e.prototype.getNodeHigh=function(){for(var e=this.records[0].high,t=1;t<this.records.length;t++)this.records[t].high>e&&(e=this.records[t].high);return e},e.prototype.updateHeight=function(){this.height=Math.max(n(this.left),n(this.right))+1},e.prototype.updateMaxOfParents=function(){if(void 0!==this){var e=this.getNodeHigh();void 0!==this.left&&void 0!==this.right?this.max=Math.max(Math.max(this.left.max,this.right.max),e):void 0!==this.left&&void 0===this.right?this.max=Math.max(this.left.max,e):void 0===this.left&&void 0!==this.right?this.max=Math.max(this.right.max,e):this.max=e,this.parent&&this.parent.updateMaxOfParents()}},e.prototype._updateMaxAfterRightRotate=function(){var e=this.parent,t=e.left,s=t.getNodeHigh();void 0===t.left&&void 0!==t.right?t.max=Math.max(s,t.right.max):void 0!==t.left&&void 0===t.right?t.max=Math.max(s,t.left.max):void 0===t.left&&void 0===t.right?t.max=s:t.max=Math.max(Math.max(t.left.max,t.right.max),s);var r=this.getNodeHigh();void 0===this.left&&void 0!==this.right?this.max=Math.max(r,this.right.max):void 0!==this.left&&void 0===this.right?this.max=Math.max(r,this.left.max):void 0===this.left&&void 0===this.right?this.max=r:this.max=Math.max(Math.max(this.left.max,this.right.max),r),e.max=Math.max(Math.max(e.left.max,e.right.max),e.getNodeHigh())},e.prototype._updateMaxAfterLeftRotate=function(){var e=this.parent,t=e.right,s=t.getNodeHigh();void 0===t.left&&void 0!==t.right?t.max=Math.max(s,t.right.max):void 0!==t.left&&void 0===t.right?t.max=Math.max(s,t.left.max):void 0===t.left&&void 0===t.right?t.max=s:t.max=Math.max(Math.max(t.left.max,t.right.max),s);var r=this.getNodeHigh();void 0===this.left&&void 0!==this.right?this.max=Math.max(r,this.right.max):void 0!==this.left&&void 0===this.right?this.max=Math.max(r,this.left.max):void 0===this.left&&void 0===this.right?this.max=r:this.max=Math.max(Math.max(this.left.max,this.right.max),r),e.max=Math.max(Math.max(e.left.max,t.max),e.getNodeHigh())},e.prototype._leftRotate=function(){var e=this.right;e.parent=this.parent,void 0===e.parent?this.intervalTree.root=e:e.parent.left===this?e.parent.left=e:e.parent.right===this&&(e.parent.right=e),this.right=e.left,void 0!==this.right&&(this.right.parent=this),e.left=this,this.parent=e,this.updateHeight(),e.updateHeight()},e.prototype._rightRotate=function(){var e=this.left;e.parent=this.parent,void 0===e.parent?this.intervalTree.root=e:e.parent.left===this?e.parent.left=e:e.parent.right===this&&(e.parent.right=e),this.left=e.right,void 0!==this.left&&(this.left.parent=this),e.right=this,this.parent=e,this.updateHeight(),e.updateHeight()},e.prototype._rebalance=function(){if(n(this.left)>=2+n(this.right)){var e=this.left;n(e.left)>=n(e.right)?(this._rightRotate(),this._updateMaxAfterRightRotate()):(e._leftRotate(),this._rightRotate(),this._updateMaxAfterRightRotate())}else if(n(this.right)>=2+n(this.left)){var t=this.right;n(t.right)>=n(t.left)?(this._leftRotate(),this._updateMaxAfterLeftRotate()):(t._rightRotate(),this._leftRotate(),this._updateMaxAfterLeftRotate())}},e.prototype.insert=function(t){t.low<this.key?void 0===this.left?(this.left=new e(this.intervalTree,t),this.left.parent=this):this.left.insert(t):void 0===this.right?(this.right=new e(this.intervalTree,t),this.right.parent=this):this.right.insert(t),this.max<t.high&&(this.max=t.high),this.updateHeight(),this._rebalance()},e.prototype._getOverlappingRecords=function(e,t,s){if(e.key<=s&&t<=e.getNodeHigh()){for(var r=[],n=0;n<e.records.length;n++)e.records[n].high>=t&&r.push(e.records[n]);return r}return[]},e.prototype.search=function(e,t){if(void 0===this)return[];var s,r=[],n=[];return e>this.max?[]:(void 0!==this.left&&this.left.max>=e&&(r=this.left.search(e,t)),s=this._getOverlappingRecords(this,e,t),t<this.key?r.concat(s):(void 0!==this.right&&(n=this.right.search(e,t)),r.concat(s,n)))},e.prototype.searchExisting=function(e){if(void 0!==this){if(this.key===e)return this;if(e<this.key){if(void 0!==this.left)return this.left.searchExisting(e)}else if(void 0!==this.right)return this.right.searchExisting(e)}},e.prototype._minValue=function(){return void 0===this.left?this:this.left._minValue()},e.prototype.remove=function(e){var t=this.parent;if(e.key<this.key)return void 0!==this.left?this.left.remove(e):void 0;if(e.key>this.key)return void 0!==this.right?this.right.remove(e):void 0;if(void 0!==this.left&&void 0!==this.right){var s=this.right._minValue();return this.key=s.key,this.records=s.records,this.right.remove(this)}return t.left===this?(void 0!==this.right?(t.left=this.right,this.right.parent=t):(t.left=this.left,void 0!==this.left&&(this.left.parent=t)),t.updateMaxOfParents(),t.updateHeight(),t._rebalance(),this):t.right===this?(void 0!==this.right?(t.right=this.right,this.right.parent=t):(t.right=this.left,void 0!==this.left&&(this.left.parent=t)),t.updateMaxOfParents(),t.updateHeight(),t._rebalance(),this):void 0},e}();t.Node=i;var o=function(){function e(){this.count=0}return e.prototype.insert=function(e){if(e.low>e.high)throw new Error("`low` value must be lower or equal to `high` value");if(void 0===this.root)return this.root=new i(this,e),this.count++,!0;var t=this.root.searchExisting(e.low);if(void 0!==t){for(var s=0;s<t.records.length;s++)if(r(t.records[s],e))return!1;return t.records.push(e),e.high>t.max&&(t.max=e.high,t.parent&&t.parent.updateMaxOfParents()),this.count++,!0}return this.root.insert(e),this.count++,!0},e.prototype.search=function(e,t){return void 0===this.root?[]:this.root.search(e,t)},e.prototype.remove=function(e){if(void 0===this.root)return!1;var t=this.root.searchExisting(e.low);if(void 0===t)return!1;if(t.records.length>1){for(var s=void 0,n=0;n<t.records.length;n++)if(r(t.records[n],e)){s=t.records[n],t.records.splice(n,1);break}if(s){if(s=void 0,e.high===t.max){var o=t.getNodeHigh();void 0!==t.left&&void 0!==t.right?t.max=Math.max(Math.max(t.left.max,t.right.max),o):void 0!==t.left&&void 0===t.right?t.max=Math.max(t.left.max,o):void 0===t.left&&void 0!==t.right?t.max=Math.max(t.right.max,o):t.max=o,t.parent&&t.parent.updateMaxOfParents()}return this.count--,!0}return!1}if(1===t.records.length){if(r(t.records[0],e)){if(this.root.key===t.key){var a=new i(this,{low:e.low,high:e.low});a.left=this.root,this.root.parent=a;var c=this.root.remove(t);return this.root=a.left,void 0!==this.root&&(this.root.parent=void 0),!!c&&(c=void 0,this.count--,!0)}return!!(c=this.root.remove(t))&&(c=void 0,this.count--,!0)}return!1}return!1},e.prototype.inOrder=function(){return new c(this.root)},e.prototype.preOrder=function(){return new h(this.root)},e}();t.IntervalTree=o;var a=function(){function e(){this.tree=new o}return e.prototype.insert=function(e,t,s){return this.tree.insert({low:e,high:t,data:s})},e.prototype.remove=function(e,t,s){return this.tree.remove({low:e,high:t,data:s})},e.prototype.search=function(e,t){return this.tree.search(e,t).map((function(e){return e.data}))},e.prototype.inOrder=function(){return this.tree.inOrder()},e.prototype.preOrder=function(){return this.tree.preOrder()},Object.defineProperty(e.prototype,"count",{get:function(){return this.tree.count},enumerable:!0,configurable:!0}),e}();t.default=a;var c=function(){function e(e){this.stack=[],void 0!==e&&this.push(e)}return e.prototype.next=function(){return void 0===this.currentNode?{done:!0,value:void 0}:this.i<this.currentNode.records.length?{done:!1,value:this.currentNode.records[this.i++]}:(void 0!==this.currentNode.right?this.push(this.currentNode.right):this.pop(),this.next())},e.prototype.push=function(e){for(this.currentNode=e,this.i=0;void 0!==this.currentNode.left;)this.stack.push(this.currentNode),this.currentNode=this.currentNode.left},e.prototype.pop=function(){this.currentNode=this.stack.pop(),this.i=0},e}();t.InOrder=c,"function"==typeof Symbol&&(c.prototype[Symbol.iterator]=function(){return this});var h=function(){function e(e){this.stack=[],this.i=0,this.currentNode=e}return e.prototype.next=function(){return void 0===this.currentNode?{done:!0,value:void 0}:this.i<this.currentNode.records.length?{done:!1,value:this.currentNode.records[this.i++]}:(void 0!==this.currentNode.right&&this.push(this.currentNode.right),void 0!==this.currentNode.left&&this.push(this.currentNode.left),this.pop(),this.next())},e.prototype.push=function(e){this.stack.push(e)},e.prototype.pop=function(){this.currentNode=this.stack.pop(),this.i=0},e}();t.PreOrder=h,"function"==typeof Symbol&&(h.prototype[Symbol.iterator]=function(){return this})},778:(e,t,s)=>{var r=s(2479);function n(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function i(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},s=e.name||"Function wrapped with `once`";return t.onceError=s+" shouldn't be called more than once",t.called=!1,t}e.exports=r(n),e.exports.strict=r(i),n.proto=n((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})}))},4095:e=>{"use strict";function t(e){return"/"===e.charAt(0)}function s(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),s=t[1]||"",r=Boolean(s&&":"!==s.charAt(1));return Boolean(t[2]||r)}e.exports="win32"===process.platform?s:t,e.exports.posix=t,e.exports.win32=s},984:(e,t,s)=>{const r=s(9491),n=s(1017),i=s(358);let o;try{o=s(2884)}catch(e){}const a={nosort:!0,silent:!0};let c=0;const h="win32"===process.platform,u=e=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach((t=>{e[t]=e[t]||i[t],e[t+="Sync"]=e[t]||i[t]})),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,!1===e.glob&&(e.disableGlob=!0),!0!==e.disableGlob&&void 0===o)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");e.disableGlob=e.disableGlob||!1,e.glob=e.glob||a},l=(e,t,s)=>{"function"==typeof t&&(s=t,t={}),r(e,"rimraf: missing path"),r.equal(typeof e,"string","rimraf: path should be a string"),r.equal(typeof s,"function","rimraf: callback function required"),r(t,"rimraf: invalid options argument provided"),r.equal(typeof t,"object","rimraf: options should be object"),u(t);let n=0,i=null,a=0;const h=(e,r)=>e?s(e):(a=r.length,0===a?s():void r.forEach((e=>{const r=o=>{if(o){if(("EBUSY"===o.code||"ENOTEMPTY"===o.code||"EPERM"===o.code)&&n<t.maxBusyTries)return n++,setTimeout((()=>d(e,t,r)),100*n);if("EMFILE"===o.code&&c<t.emfileWait)return setTimeout((()=>d(e,t,r)),c++);"ENOENT"===o.code&&(o=null)}c=0,(e=>{i=i||e,0==--a&&s(i)})(o)};d(e,t,r)})));if(t.disableGlob||!o.hasMagic(e))return h(null,[e]);t.lstat(e,((s,r)=>{if(!s)return h(null,[e]);o(e,t.glob,h)}))},d=(e,t,s)=>{r(e),r(t),r("function"==typeof s),t.lstat(e,((r,n)=>r&&"ENOENT"===r.code?s(null):(r&&"EPERM"===r.code&&h&&p(e,t,r,s),n&&n.isDirectory()?m(e,t,r,s):void t.unlink(e,(r=>{if(r){if("ENOENT"===r.code)return s(null);if("EPERM"===r.code)return h?p(e,t,r,s):m(e,t,r,s);if("EISDIR"===r.code)return m(e,t,r,s)}return s(r)})))))},p=(e,t,s,n)=>{r(e),r(t),r("function"==typeof n),t.chmod(e,438,(r=>{r?n("ENOENT"===r.code?null:s):t.stat(e,((r,i)=>{r?n("ENOENT"===r.code?null:s):i.isDirectory()?m(e,t,s,n):t.unlink(e,n)}))}))},f=(e,t,s)=>{r(e),r(t);try{t.chmodSync(e,438)}catch(e){if("ENOENT"===e.code)return;throw s}let n;try{n=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw s}n.isDirectory()?v(e,t,s):t.unlinkSync(e)},m=(e,t,s,n)=>{r(e),r(t),r("function"==typeof n),t.rmdir(e,(r=>{!r||"ENOTEMPTY"!==r.code&&"EEXIST"!==r.code&&"EPERM"!==r.code?r&&"ENOTDIR"===r.code?n(s):n(r):g(e,t,n)}))},g=(e,t,s)=>{r(e),r(t),r("function"==typeof s),t.readdir(e,((r,i)=>{if(r)return s(r);let o,a=i.length;if(0===a)return t.rmdir(e,s);i.forEach((r=>{l(n.join(e,r),t,(r=>{if(!o)return r?s(o=r):void(0==--a&&t.rmdir(e,s))}))}))}))},b=(e,t)=>{let s;if(u(t=t||{}),r(e,"rimraf: missing path"),r.equal(typeof e,"string","rimraf: path should be a string"),r(t,"rimraf: missing options"),r.equal(typeof t,"object","rimraf: options should be object"),t.disableGlob||!o.hasMagic(e))s=[e];else try{t.lstatSync(e),s=[e]}catch(r){s=o.sync(e,t.glob)}if(s.length)for(let e=0;e<s.length;e++){const r=s[e];let n;try{n=t.lstatSync(r)}catch(e){if("ENOENT"===e.code)return;"EPERM"===e.code&&h&&f(r,t,e)}try{n&&n.isDirectory()?v(r,t,null):t.unlinkSync(r)}catch(e){if("ENOENT"===e.code)return;if("EPERM"===e.code)return h?f(r,t,e):v(r,t,e);if("EISDIR"!==e.code)throw e;v(r,t,e)}}},v=(e,t,s)=>{r(e),r(t);try{t.rmdirSync(e)}catch(r){if("ENOENT"===r.code)return;if("ENOTDIR"===r.code)throw s;"ENOTEMPTY"!==r.code&&"EEXIST"!==r.code&&"EPERM"!==r.code||y(e,t)}},y=(e,t)=>{r(e),r(t),t.readdirSync(e).forEach((s=>b(n.join(e,s),t)));const s=h?100:1;let i=0;for(;;){let r=!0;try{const n=t.rmdirSync(e,t);return r=!1,n}finally{if(++i<s&&r)continue}}};e.exports=l,l.sync=b},6774:e=>{e.exports=function(e,t,s,r){var n=s?s.call(r,e,t):void 0;if(void 0!==n)return!!n;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),c=0;c<i.length;c++){var h=i[c];if(!a(h))return!1;var u=e[h],l=t[h];if(!1===(n=s?s.call(r,u,l,h):void 0)||void 0===n&&u!==l)return!1}return!0}},9948:(e,t,s)=>{"use strict";const{Readable:r,Writable:n,Duplex:i,Transform:o}=s(2781),a=Symbol.for("object-stream.none"),c=Symbol.for("object-stream.final"),h=Symbol.for("object-stream.many"),u=e=>new o({writableObjectMode:!0,readableObjectMode:!0,transform(t,s,r){try{const n=e.call(this,t,s);if(n&&"function"==typeof n.then)return void n.then((e=>(f.sanitize(e,this),r(null))),(e=>r(e)));if(n&&"function"==typeof n.next)return void(async(e,t)=>{for(;;){let s=e.next();if(s&&"function"==typeof s.then&&(s=await s),s.done)break;let r=s.value;r&&"function"==typeof r.then&&(r=await r),f.sanitize(r,t)}})(n,this).then((()=>r(null)),(e=>r(e)));f.sanitize(n,this),r(null)}catch(e){r(e)}}}),l=e=>new o({writableObjectMode:!0,readableObjectMode:!0,transform(t,s,r){try{let n=t;for(let t=0;t<e.length;++t){const i=e[t].call(this,n,s);if(i===f.none)return void r(null);if(f.isFinal(i)){n=f.getFinalValue(i);break}n=i}f.sanitize(n,this),r(null)}catch(e){r(e)}}}),d=e=>e&&"function"==typeof e.pipe&&"function"==typeof e.on&&(!e._writableState||!1!==("object"==typeof e._readableState?e._readableState.readable:null))&&(!e._writableState||e._readableState),p=e=>e&&"function"==typeof e.write&&"function"==typeof e.on&&(!e._readableState||!1!==("object"==typeof e._writableState?e._writableState.writable:null));class f extends i{constructor(e,t){if(super(t||{writableObjectMode:!0,readableObjectMode:!0}),!(e instanceof Array&&e.length))throw Error("Chain's argument should be a non-empty array.");this.streams=e.filter((e=>e)).map(((e,t,s)=>{if("function"==typeof e||e instanceof Array)return f.convertToTransform(e);if((r=e)&&"function"==typeof r.pipe&&r._readableState&&"function"==typeof r.on&&"function"==typeof r.write||!t&&d(e)||t===s.length-1&&p(e))return e;var r;throw Error("Arguments should be functions, arrays or streams.")})).filter((e=>e)),this.input=this.streams[0],this.output=this.streams.reduce(((e,t)=>e&&e.pipe(t)||t)),p(this.input)||(this._write=(e,t,s)=>s(null),this._final=e=>e(null),this.input.on("end",(()=>this.end()))),d(this.output)?(this.output.on("data",(e=>!this.push(e)&&this.output.pause())),this.output.on("end",(()=>this.push(null)))):(this._read=()=>{},this.resume(),this.output.on("finish",(()=>this.push(null)))),t&&t.skipEvents||this.streams.forEach((e=>e.on("error",(e=>this.emit("error",e)))))}_write(e,t,s){let r=null;try{this.input.write(e,t,(e=>s(e||r)))}catch(e){r=e}}_final(e){let t=null;try{this.input.end(null,null,(s=>e(s||t)))}catch(e){t=e}}_read(){this.output.resume()}static make(e,t){return new f(e,t)}static sanitize(e,t){f.isFinal(e)?e=f.getFinalValue(e):f.isMany(e)&&(e=f.getManyValues(e)),null!=e&&e!==f.none&&(e instanceof Array?e.forEach((e=>null!=e&&t.push(e))):t.push(e))}static convertToTransform(e){return"function"==typeof e?u(e):e instanceof Array&&e.length?l(e):null}}f.none=a,f.final=e=>({[c]:e}),f.isFinal=e=>e&&"object"==typeof e&&c in e,f.getFinalValue=e=>e[c],f.many=e=>({[h]:e}),f.isMany=e=>e&&"object"==typeof e&&h in e,f.getManyValues=e=>e[h],f.chain=f.make,f.make.Constructor=f,e.exports=f},4629:(e,t,s)=>{"use strict";const r=s(2361),n=e=>function(){this.done?this.done=!1:this.stack.push(this.current,this.key),this.current=new e,this.key=null};class i extends r{static connectTo(e,t){return new i(t).connectTo(e)}constructor(e){super(),this.stack=[],this.current=this.key=null,this.done=!0,e&&(this.reviver="function"==typeof e.reviver&&e.reviver,this.reviver&&(this.stringValue=this._saveValue=this._saveValueWithReviver),e.numberAsString&&(this.numberValue=this.stringValue))}connectTo(e){return e.on("data",(e=>{this[e.name]&&(this[e.name](e.value),this.done&&this.emit("done",this))})),this}get depth(){return(this.stack.length>>1)+(this.done?0:1)}get path(){const e=[];for(let t=0;t<this.stack.length;t+=2){const s=this.stack[t+1];e.push(null===s?this.stack[t].length:s)}return e}dropToLevel(e){if(e<this.depth)if(e){const t=e-1<<1;this.current=this.stack[t],this.key=this.stack[t+1],this.stack.splice(t)}else this.stack=[],this.current=this.key=null,this.done=!0;return this}consume(e){return this[e.name]&&this[e.name](e.value),this}keyValue(e){this.key=e}numberValue(e){this._saveValue(parseFloat(e))}nullValue(){this._saveValue(null)}trueValue(){this._saveValue(!0)}falseValue(){this._saveValue(!1)}endObject(){if(this.stack.length){const e=this.current;this.key=this.stack.pop(),this.current=this.stack.pop(),this._saveValue(e)}else this.done=!0}_saveValue(e){this.done?this.current=e:this.current instanceof Array?this.current.push(e):(this.current[this.key]=e,this.key=null)}_saveValueWithReviver(e){this.done?this.current=this.reviver("",e):this.current instanceof Array?(e=this.reviver(""+this.current.length,e),this.current.push(e),void 0===e&&delete this.current[this.current.length-1]):(void 0!==(e=this.reviver(this.key,e))&&(this.current[this.key]=e),this.key=null)}}i.prototype.stringValue=i.prototype._saveValue,i.prototype.startObject=n(Object),i.prototype.startArray=n(Array),i.prototype.endArray=i.prototype.endObject,e.exports=i},2913:(e,t,s)=>{"use strict";const r=s(558),n={value1:/^(?:[\"\{\[\]\-\d]|true\b|false\b|null\b|\s{1,256})/,string:/^(?:[^\"\\]{1,256}|\\[bfnrt\"\\\/]|\\u[\da-fA-F]{4}|\")/,key1:/^(?:[\"\}]|\s{1,256})/,colon:/^(?:\:|\s{1,256})/,comma:/^(?:[\,\]\}]|\s{1,256})/,ws:/^\s{1,256}/,numberStart:/^\d/,numberDigit:/^\d{0,256}/,numberFraction:/^[\.eE]/,numberExponent:/^[eE]/,numberExpSign:/^[-+]/};let i=!0;try{new RegExp(".","y"),i=!1}catch(e){}!i&&Object.keys(n).forEach((e=>{let t=n[e].source.slice(1);"(?:"===t.slice(0,3)&&")"===t.slice(-1)&&(t=t.slice(3,-1)),n[e]=new RegExp(t,"y")})),n.numberFracStart=n.numberExpStart=n.numberStart,n.numberFracDigit=n.numberExpDigit=n.numberDigit;const o={true:!0,false:!1,null:null},a={object:"objectStop",array:"arrayStop","":"done"},c={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",'"':'"',"\\":"\\","/":"/"};class h extends r{static make(e){return new h(e)}constructor(e){super(Object.assign({},e,{readableObjectMode:!0})),this._packKeys=this._packStrings=this._packNumbers=this._streamKeys=this._streamStrings=this._streamNumbers=!0,e&&("packValues"in e&&(this._packKeys=this._packStrings=this._packNumbers=e.packValues),"packKeys"in e&&(this._packKeys=e.packKeys),"packStrings"in e&&(this._packStrings=e.packStrings),"packNumbers"in e&&(this._packNumbers=e.packNumbers),"streamValues"in e&&(this._streamKeys=this._streamStrings=this._streamNumbers=e.streamValues),"streamKeys"in e&&(this._streamKeys=e.streamKeys),"streamStrings"in e&&(this._streamStrings=e.streamStrings),"streamNumbers"in e&&(this._streamNumbers=e.streamNumbers),this._jsonStreaming=e.jsonStreaming),!this._packKeys&&(this._streamKeys=!0),!this._packStrings&&(this._streamStrings=!0),!this._packNumbers&&(this._streamNumbers=!0),this._done=!1,this._expect=this._jsonStreaming?"done":"value",this._stack=[],this._parent="",this._open_number=!1,this._accumulator=""}_flush(e){this._done=!0,super._flush((t=>{if(t)return e(t);this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),e(null)}))}_processBuffer(e){let t,s,r=0;e:for(;;)switch(this._expect){case"value1":case"value":if(n.value1.lastIndex=r,t=n.value1.exec(this._buffer),!t){if(this._done||r+16<this._buffer.length)return r<this._buffer.length?e(new Error("Parser cannot parse input: expected a value")):e(new Error("Parser has expected a value"));break e}switch(s=t[0],s){case'"':this._streamStrings&&this.push({name:"startString"}),this._expect="string";break;case"{":this.push({name:"startObject"}),this._stack.push(this._parent),this._parent="object",this._expect="key1";break;case"[":this.push({name:"startArray"}),this._stack.push(this._parent),this._parent="array",this._expect="value1";break;case"]":if("value1"!==this._expect)return e(new Error("Parser cannot parse input: unexpected token ']'"));this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),this.push({name:"endArray"}),this._parent=this._stack.pop(),this._expect=a[this._parent];break;case"-":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"-"})),this._packNumbers&&(this._accumulator="-"),this._expect="numberStart";break;case"0":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"0"})),this._packNumbers&&(this._accumulator="0"),this._expect="numberFraction";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:s})),this._packNumbers&&(this._accumulator=s),this._expect="numberDigit";break;case"true":case"false":case"null":if(this._buffer.length-r===s.length&&!this._done)break e;this.push({name:s+"Value",value:o[s]}),this._expect=a[this._parent]}i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"keyVal":case"string":if(n.string.lastIndex=r,t=n.string.exec(this._buffer),!t){if(r<this._buffer.length&&(this._done||this._buffer.length-r>=6))return e(new Error("Parser cannot parse input: escaped characters"));if(this._done)return e(new Error("Parser has expected a string value"));break e}if(s=t[0],'"'===s)"keyVal"===this._expect?(this._streamKeys&&this.push({name:"endKey"}),this._packKeys&&(this.push({name:"keyValue",value:this._accumulator}),this._accumulator=""),this._expect="colon"):(this._streamStrings&&this.push({name:"endString"}),this._packStrings&&(this.push({name:"stringValue",value:this._accumulator}),this._accumulator=""),this._expect=a[this._parent]);else if(s.length>1&&"\\"===s.charAt(0)){const e=2==s.length?c[s.charAt(1)]:(h=s,String.fromCharCode(parseInt(h.slice(2),16)));("keyVal"===this._expect?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:e}),("keyVal"===this._expect?this._packKeys:this._packStrings)&&(this._accumulator+=e)}else("keyVal"===this._expect?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:s}),("keyVal"===this._expect?this._packKeys:this._packStrings)&&(this._accumulator+=s);i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"key1":case"key":if(n.key1.lastIndex=r,t=n.key1.exec(this._buffer),!t){if(r<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an object key"));break e}if(s=t[0],'"'===s)this._streamKeys&&this.push({name:"startKey"}),this._expect="keyVal";else if("}"===s){if("key1"!==this._expect)return e(new Error("Parser cannot parse input: unexpected token '}'"));this.push({name:"endObject"}),this._parent=this._stack.pop(),this._expect=a[this._parent]}i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"colon":if(n.colon.lastIndex=r,t=n.colon.exec(this._buffer),!t){if(r<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ':'"));break e}s=t[0],":"===s&&(this._expect="value"),i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"arrayStop":case"objectStop":if(n.comma.lastIndex=r,t=n.comma.exec(this._buffer),!t){if(r<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ','"));break e}if(this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),s=t[0],","===s)this._expect="arrayStop"===this._expect?"value":"key";else if("}"===s||"]"===s){if("}"===s?"arrayStop"===this._expect:"arrayStop"!==this._expect)return e(new Error("Parser cannot parse input: expected '"+("arrayStop"===this._expect?"]":"}")+"'"));this.push({name:"}"===s?"endObject":"endArray"}),this._parent=this._stack.pop(),this._expect=a[this._parent]}i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberStart":if(n.numberStart.lastIndex=r,t=n.numberStart.exec(this._buffer),!t){if(r<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a starting digit"));break e}s=t[0],this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),this._expect="0"===s?"numberFraction":"numberDigit",i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberDigit":if(n.numberDigit.lastIndex=r,t=n.numberDigit.exec(this._buffer),!t){if(r<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a digit"));break e}if(s=t[0],!s){if(r<this._buffer.length){this._expect="numberFraction";break}if(this._done){this._expect=a[this._parent];break}break e}this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberFraction":if(n.numberFraction.lastIndex=r,t=n.numberFraction.exec(this._buffer),!t){if(r<this._buffer.length||this._done){this._expect=a[this._parent];break}break e}s=t[0],this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),this._expect="."===s?"numberFracStart":"numberExpSign",i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberFracStart":if(n.numberFracStart.lastIndex=r,t=n.numberFracStart.exec(this._buffer),!t){if(r<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a fractional part of a number"));break e}s=t[0],this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),this._expect="numberFracDigit",i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberFracDigit":if(n.numberFracDigit.lastIndex=r,t=n.numberFracDigit.exec(this._buffer),s=t[0],!s){if(r<this._buffer.length){this._expect="numberExponent";break}if(this._done){this._expect=a[this._parent];break}break e}this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberExponent":if(n.numberExponent.lastIndex=r,t=n.numberExponent.exec(this._buffer),!t){if(r<this._buffer.length){this._expect=a[this._parent];break}if(this._done){this._expect="done";break}break e}s=t[0],this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),this._expect="numberExpSign",i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberExpSign":if(n.numberExpSign.lastIndex=r,t=n.numberExpSign.exec(this._buffer),!t){if(r<this._buffer.length){this._expect="numberExpStart";break}if(this._done)return e(new Error("Parser has expected an exponent value of a number"));break e}s=t[0],this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),this._expect="numberExpStart",i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberExpStart":if(n.numberExpStart.lastIndex=r,t=n.numberExpStart.exec(this._buffer),!t){if(r<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an exponent part of a number"));break e}s=t[0],this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),this._expect="numberExpDigit",i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"numberExpDigit":if(n.numberExpDigit.lastIndex=r,t=n.numberExpDigit.exec(this._buffer),s=t[0],!s){if(r<this._buffer.length||this._done){this._expect=a[this._parent];break}break e}this._streamNumbers&&this.push({name:"numberChunk",value:s}),this._packNumbers&&(this._accumulator+=s),i?this._buffer=this._buffer.slice(s.length):r+=s.length;break;case"done":if(n.ws.lastIndex=r,t=n.ws.exec(this._buffer),!t){if(r<this._buffer.length){if(this._jsonStreaming){this._expect="value";break}return e(new Error("Parser cannot parse input: unexpected characters"))}break e}s=t[0],this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),i?this._buffer=this._buffer.slice(s.length):r+=s.length}var h;!i&&(this._buffer=this._buffer.slice(r)),e(null)}}h.parser=h.make,h.make.Constructor=h,e.exports=h},5275:(e,t,s)=>{"use strict";const r=s(143),n=s(7786);class i extends r{static make(e){return new i(e)}static withParser(e){return n(i.make,e)}constructor(e){super(e),this._level=1,this._counter=0}_wait(e,t,s){return"startArray"!==e.name?s(new Error("Top-level object should be an array.")):(this._transform=this._filter,this._transform(e,t,s))}_push(e){this._assembler.current.length&&(e?(++this._counter,this._assembler.current.pop()):this.push({key:this._counter++,value:this._assembler.current.pop()}))}}i.streamArray=i.make,i.make.Constructor=i,e.exports=i},143:(e,t,s)=>{"use strict";const{Transform:r}=s(2781),n=s(4629);class i{constructor(e){this.depth=e}startObject(){++this.depth}endObject(){--this.depth}startArray(){++this.depth}endArray(){--this.depth}}e.exports=class extends r{constructor(e){super(Object.assign({},e,{writableObjectMode:!0,readableObjectMode:!0})),e&&(this.objectFilter=e.objectFilter,this.includeUndecided=e.includeUndecided),"function"!=typeof this.objectFilter&&(this._filter=this._transform),this._transform=this._wait||this._filter,this._assembler=new n(e)}_transform(e,t,s){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&this._push()),s(null)}_filter(e,t,s){if(this._assembler[e.name]){this._assembler[e.name](e.value);const t=this.objectFilter(this._assembler);if(t)return this._assembler.depth===this._level&&(this._push(),this._transform=this._filter),this._transform=this._accept,s(null);if(!1===t)return this._saved_assembler=this._assembler,this._assembler=new i(this._saved_assembler.depth),this._saved_assembler.dropToLevel(this._level),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter),this._transform=this._reject,s(null);this._assembler.depth===this._level&&this._push(!this.includeUndecided)}s(null)}_accept(e,t,s){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._push(),this._transform=this._filter)),s(null)}_reject(e,t,s){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter)),s(null)}}},558:(e,t,s)=>{"use strict";const{Transform:r}=s(2781),{StringDecoder:n}=s(1576);e.exports=class extends r{constructor(e){super(Object.assign({},e,{writableObjectMode:!1})),this._buffer=""}_transform(e,t,s){"string"==typeof e?this._transform=this._transformString:(this._stringDecoder=new n,this._transform=this._transformBuffer),this._transform(e,t,s)}_transformBuffer(e,t,s){this._buffer+=this._stringDecoder.write(e),this._processBuffer(s)}_transformString(e,t,s){this._buffer+=e.toString(),this._processBuffer(s)}_processBuffer(e){this._buffer&&(this.push(this._buffer,"utf8"),this._buffer=""),e(null)}_flushInput(){this._stringDecoder&&(this._buffer+=this._stringDecoder.end())}_flush(e){this._flushInput(),this._processBuffer(e)}}},7786:(e,t,s)=>{"use strict";const r=s(9948),n=s(2913);e.exports=(e,t)=>new r([new n(t),e(t)],Object.assign({},t,{writableObjectMode:!1,readableObjectMode:!0}))},6276:(e,t,s)=>{const r=s(358),n=s(2037),i=s(1017),o=s(6113),a={fs:r.constants,os:n.constants},c=s(984),h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",u=/XXXXXX/,l=(a.O_CREAT||a.fs.O_CREAT)|(a.O_EXCL||a.fs.O_EXCL)|(a.O_RDWR||a.fs.O_RDWR),d="win32"===n.platform(),p=a.EBADF||a.os.errno.EBADF,f=a.ENOENT||a.os.errno.ENOENT,m=[],g=r.rmdirSync.bind(r),b=c.sync;let v=!1;function y(e,t){const s=P(e,t),n=s[0],i=s[1];try{M(n)}catch(e){return i(e)}let o=n.tries;!function e(){try{const t=T(n);r.stat(t,(function(s){if(!s)return o-- >0?e():i(new Error("Could not get a unique tmp filename, max tries reached "+t));i(null,t)}))}catch(e){i(e)}}()}function S(e){const t=P(e)[0];M(t);let s=t.tries;do{const e=T(t);try{r.statSync(e)}catch(t){return e}}while(s-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function E(e,t){const s=function(e){if(e&&!N(e))return t(e);t()};0<=e[0]?r.close(e[0],(function(){r.unlink(e[1],s)})):r.unlink(e[1],s)}function x(e){let t=null;try{0<=e[0]&&r.closeSync(e[0])}catch(e){if(!$(e,-p,"EBADF")&&!N(e))throw e}finally{try{r.unlinkSync(e[1])}catch(e){N(e)||(t=e)}}if(null!==t)throw t}function w(e,t,s,r){const n=_(x,[t,e],r),i=_(E,[t,e],r,n);return s.keep||m.unshift(n),r?n:i}function R(e,t,s){const n=t.unsafeCleanup?c:r.rmdir.bind(r),i=_(t.unsafeCleanup?b:g,e,s),o=_(n,e,s,i);return t.keep||m.unshift(i),s?i:o}function _(e,t,s,r){let n=!1;return function i(o){if(!n){const a=r||i,c=m.indexOf(a);return c>=0&&m.splice(c,1),n=!0,s||e===g||e===b?e(t):e(t,o||function(){})}}}function C(e){let t=[],s=null;try{s=o.randomBytes(e)}catch(t){s=o.pseudoRandomBytes(e)}for(var r=0;r<e;r++)t.push(h[s[r]%h.length]);return t.join("")}function k(e){return null===e||O(e)||!e.trim()}function O(e){return void 0===e}function P(e,t){if("function"==typeof e)return[{},e];if(O(e))return[{},t];const s={};for(const t of Object.getOwnPropertyNames(e))s[t]=e[t];return[s,t]}function T(e){const t=e.tmpdir;if(!O(e.name))return i.join(t,e.dir,e.name);if(!O(e.template))return i.join(t,e.dir,e.template).replace(u,C(6));const s=[e.prefix?e.prefix:"tmp","-",process.pid,"-",C(12),e.postfix?"-"+e.postfix:""].join("");return i.join(t,e.dir,s)}function M(e){e.tmpdir=L(e);const t=e.tmpdir;if(O(e.name)||A(e.name,"name",t),O(e.dir)||A(e.dir,"dir",t),!O(e.template)&&(A(e.template,"template",t),!e.template.match(u)))throw new Error(`Invalid template, found "${e.template}".`);if(!O(e.tries)&&isNaN(e.tries)||e.tries<0)throw new Error(`Invalid tries, found "${e.tries}".`);e.tries=O(e.name)?e.tries||3:1,e.keep=!!e.keep,e.detachDescriptor=!!e.detachDescriptor,e.discardDescriptor=!!e.discardDescriptor,e.unsafeCleanup=!!e.unsafeCleanup,e.dir=O(e.dir)?"":i.relative(t,I(e.dir,t)),e.template=O(e.template)?void 0:i.relative(t,I(e.template,t)),e.template=k(e.template)?void 0:i.relative(e.dir,e.template),e.name=O(e.name)?void 0:D(e.name),e.prefix=O(e.prefix)?"":e.prefix,e.postfix=O(e.postfix)?"":e.postfix}function I(e,t){const s=D(e);return s.startsWith(t)?i.resolve(s):i.resolve(i.join(t,s))}function D(e){return k(e)?e:e.replace(/["']/g,"")}function A(e,t,s){if("name"===t){if(i.isAbsolute(e))throw new Error(`${t} option must not contain an absolute path, found "${e}".`);let s=i.basename(e);if(".."===s||"."===s||s!==e)throw new Error(`${t} option must not contain a path, found "${e}".`)}else{if(i.isAbsolute(e)&&!e.startsWith(s))throw new Error(`${t} option must be relative to "${s}", found "${e}".`);let r=I(e,s);if(!r.startsWith(s))throw new Error(`${t} option must be relative to "${s}", found "${r}".`)}}function N(e){return $(e,-f,"ENOENT")}function $(e,t,s){return d?e.code===s:e.code===s&&e.errno===t}function L(e){return i.resolve(D(e&&e.tmpdir||n.tmpdir()))}process.addListener("exit",(function(){if(v)for(;m.length;)try{m[0]()}catch(e){}})),Object.defineProperty(e.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return L()}}),e.exports.dir=function(e,t){const s=P(e,t),n=s[0],i=s[1];y(n,(function(e,t){if(e)return i(e);r.mkdir(t,n.mode||448,(function(e){if(e)return i(e);i(null,t,R(t,n,!1))}))}))},e.exports.dirSync=function(e){const t=P(e)[0],s=S(t);return r.mkdirSync(s,t.mode||448),{name:s,removeCallback:R(s,t,!0)}},e.exports.file=function(e,t){const s=P(e,t),n=s[0],i=s[1];y(n,(function(e,t){if(e)return i(e);r.open(t,l,n.mode||384,(function(e,s){if(e)return i(e);if(n.discardDescriptor)return r.close(s,(function(e){return i(e,t,void 0,w(t,-1,n,!1))}));{const e=n.discardDescriptor||n.detachDescriptor;i(null,t,s,w(t,e?-1:s,n,!1))}}))}))},e.exports.fileSync=function(e){const t=P(e)[0],s=t.discardDescriptor||t.detachDescriptor,n=S(t);var i=r.openSync(n,l,t.mode||384);return t.discardDescriptor&&(r.closeSync(i),i=void 0),{name:n,fd:i,removeCallback:w(n,s?-1:i,t,!0)}},e.exports.tmpName=y,e.exports.tmpNameSync=S,e.exports.setGracefulCleanup=function(){v=!0}},5585:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MIError=t.VariableObject=void 0;const r=s(9074),n=s(3200),i=s(2942);t.VariableObject=class{constructor(e,t){this.parent=e,this.name=r.MINode.valueOf(t,"name"),this.exp=r.MINode.valueOf(t,"exp"),this.numchild=parseInt(r.MINode.valueOf(t,"numchild")),this.type=r.MINode.valueOf(t,"type"),this.value=r.MINode.valueOf(t,"value"),this.threadId=r.MINode.valueOf(t,"thread-id"),this.frozen=!!r.MINode.valueOf(t,"frozen"),this.dynamic=!!r.MINode.valueOf(t,"dynamic"),this.displayhint=r.MINode.valueOf(t,"displayhint"),this.children={},this.hasMore=!!r.MINode.valueOf(t,"has_more")}createToolTip(e,t){let s=this.type;if(this.isCompound())return s;let r=0;return(/^0[xX][0-9A-Fa-f]+/.test(t)||/^[-]?[0-9]+/.test(t))&&(r=parseInt(t.toLowerCase()),s+=" "+e+";\n",s+=n.toStringDecHexOctBin(r)),s}applyChanges(e){this.value=r.MINode.valueOf(e,"value"),r.MINode.valueOf(e,"type_changed")&&(this.type=r.MINode.valueOf(e,"new_type")),this.dynamic=!!r.MINode.valueOf(e,"dynamic"),this.displayhint=r.MINode.valueOf(e,"displayhint"),this.hasMore=!!r.MINode.valueOf(e,"has_more")}isCompound(){return this.numchild>0||"{...}"===this.value||this.dynamic&&("array"===this.displayhint||"map"===this.displayhint)}toProtocolVariable(){const e={name:this.exp,evaluateName:this.fullExp||this.exp,value:void 0===this.value?"<unknown>":this.value,type:this.type,presentationHint:{kind:this.displayhint},variablesReference:this.id};return this.numchild>0&&this.value.startsWith("0x")&&(e.memoryReference=i.hexFormat(parseInt(this.value))),e.type=this.createToolTip(e.name,e.value),e}},t.MIError=class{constructor(e,t){Object.defineProperty(this,"name",{get:()=>this.constructor.name}),Object.defineProperty(this,"message",{get:()=>e}),Object.defineProperty(this,"source",{get:()=>t}),Error.captureStackTrace(this,this.constructor)}toString(){return`${this.message} (from ${this.source})`}},Object.setPrototypeOf(t.MIError,Object.create(Error.prototype)),t.MIError.prototype.constructor=t.MIError},7582:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GdbDisassembler=void 0;const n=s(9955),i=s(2942),o=s(9074),a=s(1017),c=s(3200),h=s(6206),u=s(6434);var l;!function(e){e[e.X64=0]="X64",e[e.X86=1]="X86",e[e.ARM64=2]="ARM64",e[e.ARM=3]="ARM",e[e.XTENSA=4]="XTENSA",e[e.UNKNOWN=5]="UNKNOWN"}(l||(l={}));class d{constructor(e){this.instructions=e,this.instructions=Array.from(e),this.adjustBoundaries()}adjustBoundaries(){const e=this.instructions.length>0?this.instructions[this.instructions.length-1]:null;e&&(this.startAddress=this.instructions[0].pvtAddress,h.assert(e.pvtInstructionBytes.length%3==2),this.endAddress=e.pvtAddress+(e.pvtInstructionBytes.length+1)/3)}get span(){return this.endAddress-this.startAddress}isInsideRange(e,t){return e>=this.startAddress&&t<=this.endAddress}isOverlappingRange(e,t){const s=t-e,r=Math.min(this.startAddress,e);return!(Math.max(this.endAddress,t)-r>this.span+s)}findInstrIndex(e){const t=this.instructions.length;for(let s=0;s<t;s++){const t=this.instructions[s];if(t.pvtAddress===e)return s;if(t.pvtIsData){const r=t.pvtAddress+(t.pvtInstructionBytes.length+1)/3;if(e>=t.pvtAddress&&e<r)return s}}return-1}findNearbyLowerInstr(e,t){const s=Math.max(0,e-t);for(let t=this.instructions.length-1;t>0;t--){const r=this.instructions[t].pvtAddress;if(r>=s&&r<=e)return r}return e}tryMerge(e){if(!this.isOverlappingRange(e.startAddress,e.endAddress))return!1;if(this.span===e.span&&this.startAddress===e.startAddress)return!0;if(this.endAddress===e.startAddress)return this.instructions=this.instructions.concat(e.instructions),this.adjustBoundaries(),!0;if(e.endAddress===this.startAddress)return this.instructions=e.instructions.concat(this.instructions),this.adjustBoundaries(),!0;const t=this.startAddress<=e.startAddress?this:e,s=this.startAddress<=e.startAddress?e:this,r=t.instructions.length-1,n=t.instructions[r].pvtAddress,i=s.instructions.length;for(let e=0;e<i;e++)if(s.instructions[e].pvtAddress===n){const n=s.instructions.slice(e+1);return t.instructions=t.instructions.concat(n),this.instructions=t.instructions,this.adjustBoundaries(),f.debug&&console.log("Merge @",this.instructions[r-1],this.instructions[r],this.instructions[r+1]),!0}return!1}shallowCopy(){return new d(this.instructions)}forceMerge(e){this.tryMerge(e)||(this.startAddress<e.startAddress?this.instructions=this.instructions.concat(e.instructions):this.instructions=e.instructions.concat(this.instructions),this.adjustBoundaries())}}class p{constructor(e,t,s=!0){this.instructions=e,this.foundAt=t,this.instructions=s?Array.from(this.instructions):this.instructions}}class f{constructor(e,t){this.gdbSession=e,this.launchArgs=t,this.doTiming=!0,this.Architecture=l.ARM,this.maxInstrSize=4,this.minInstrSize=2,this.instrMultiple=2,this.cache=[],this.disasmRequestQueue=[],this.disasmBusy=!1,t.showDevDebugOutput&&t.showDevDebugOutput!==c.ADAPTER_DEBUG_MODE.NONE&&(f.debug=!0)}get miDebugger(){return this.gdbSession.miDebugger}handleMsg(e,t){this.gdbSession.handleMsg(e,t)}isRangeInValidMem(e,t){for(const s of this.gdbSession.symbolTable.memoryRegions){if(s.inVmaRegion(e)&&s.inVmaRegion(t))return!0;if(s.inLmaRegion(e)&&s.inLmaRegion(t))return!0}return!1}isValidAddr(e){for(const t of this.gdbSession.symbolTable.memoryRegions)if(t.inVmaRegion(e)||t.inLmaRegion(e))return!0;return!1}getMemFlagForAddr(e){return this.isValidAddr(e)?"":"?? "}setArchitecture(){return r(this,void 0,void 0,(function*(){const e=(yield this.miDebugger.sendCommand('interpreter-exec console "show architecture"',!1,!0)).output;let t=!1;for(const s of e.toLowerCase().split("\n")){if(s.includes("x86-64"))this.Architecture=l.X64,this.minInstrSize=1,this.maxInstrSize=26,this.instrMultiple=1;else if(s.includes("i386"))this.Architecture=l.X86,this.minInstrSize=1,this.maxInstrSize=20,this.instrMultiple=1;else if(s.includes("arm64"))this.Architecture=l.ARM64,this.minInstrSize=2,this.maxInstrSize=8,this.instrMultiple=2;else if(s.includes("aarch64"))this.Architecture=l.ARM64,this.minInstrSize=2,this.maxInstrSize=8,this.instrMultiple=2;else if(s.includes("arm"))this.Architecture=l.ARM,this.minInstrSize=2,this.maxInstrSize=4,this.instrMultiple=2;else{if(!s.includes("xtensa"))continue;this.Architecture=l.XTENSA,this.minInstrSize=1,this.maxInstrSize=16,this.instrMultiple=1}t=!0;break}t?this.Architecture!==l.ARM&&this.handleMsg("log",`Info: Untested architecture for disassembly: Gdb command "show architecture" shows "${e}"\n`):(this.handleMsg("log",`Warning: Unknown architecture for disassembly. Results may not be accurate at edge of memories\n    Gdb command "show architecture" shows "${e}"\n`),this.Architecture=l.UNKNOWN,this.minInstrSize=1,this.maxInstrSize=26,this.instrMultiple=1)}))}getMemoryRegions(){return r(this,void 0,void 0,(function*(){if(this.memoryRegions)return;try{yield this.setArchitecture(),this.memoryRegions=[];const e=(yield this.miDebugger.sendCommand('interpreter-exec console "info mem"',!1,!0)).output;let t;const s=RegExp(/^[0-9]+\s+([^\s])\s+(0x[0-9a-fA-F]+)\s+(0x[0-9a-fA-F]+)\s+([^\r\n]*)/gim);for(;t=s.exec(e);){const[e,s,r,n]=t.slice(1,5);if("y"===e){const e=parseInt(r),i=parseInt(s),o=n.split(/\s+/g);this.memoryRegions.length,this.memoryRegions.push(new u.MemoryRegion({name:t[1],size:e-i,vmaStart:i,lmaStart:i,vmaStartOrig:i,attrs:o}))}}}catch(e){this.handleMsg("log",`Error: ${e.toString()}`)}const e=this.memoryRegions.length;if(this.memoryRegions=this.memoryRegions.concat(this.gdbSession.symbolTable.memoryRegions),this.memoryRegions.length>0){this.handleMsg("log",'Note: We detected the following memory regions as valid using gdb "info mem" and "objdump -h"\n'),this.handleMsg("log","    This information is used to adjust bounds only when normal disassembly fails.\n");const t=["Size","VMA Beg","VMA End","LMA Beg","LMA End"].map((e=>e.padStart(10))),s="".padEnd(80,"=")+"\n";this.handleMsg("stdout",s),this.handleMsg("stdout","  Using following memory regions for disassembly\n"),this.handleMsg("stdout",s),this.handleMsg("stdout",t.join("")+"  Attributes\n"),this.handleMsg("stdout",s);let r=0;for(const t of this.memoryRegions){r++===e&&(0===e&&this.handleMsg("stdout","  Unfortunately, No memory information from gdb (or gdb-server). Will try to manage without\n"),this.handleMsg("stdout","  ".padEnd(80,"-")+"\n"));const s=[t.size,t.vmaStart,t.vmaEnd-1,t.lmaStart,t.lmaEnd-1].map((e=>i.hexFormat(e,8,!1).padStart(10)));t.vmaStart===t.lmaStart&&(s[3]=s[4]="  ".padEnd(10,"-"));const n=(r>e?`(${t.name}) `:"")+t.attrs.join(" ");this.handleMsg("stdout",s.join("")+"  "+n+"\n")}this.handleMsg("stdout",s)}}))}clipLow(e,t){for(const s of this.memoryRegions){if(s.inVmaRegion(e))return s.inVmaRegion(t)?t:s.vmaStart;if(s.inLmaRegion(e))return s.inLmaRegion(t)?t:s.lmaStart}return t}clipHigh(e,t){for(const s of this.memoryRegions){if(s.inVmaRegion(e))return s.inVmaRegion(t)?t:s.vmaEnd;if(s.inLmaRegion(e))return s.inLmaRegion(t)?t:s.lmaEnd}return t}formatSym(e,t){if(e)return`<${e.length>22?".."+e.substring(e.length-20):e}+${t}>`}parseDisassembleResults(e,t,s,r){const i=(e,r)=>{const n=o.MINode.valueOf(e,"address")||"0x????????",i=o.MINode.valueOf(e,"func-name")||void 0,a=parseInt(o.MINode.valueOf(e,"offset")||"0"),c=o.MINode.valueOf(e,"inst"),h=o.MINode.valueOf(e,"opcodes")||"",d=parseInt(n),p=s?"":this.getMemFlagForAddr(d),f=h.replace(/\s/g,"").padEnd(2*this.maxInstrSize+2)+p+c,m=this.formatSym(i,a),g={address:n,pvtAddress:d,instruction:f,symbol:i,pvtInstructionBytes:h};m&&(g.instructionBytes=m),r&&(g.location=r.source,g.line=r.startLine,g.endLine=r.endLine),t===d&&(u=l.length),l.push(g)};let c=0,h=0,u=-1;const l=[],d=e.result("asm_insns")||[];let f=0,m="";for(const e of d)if("src_and_asm_line"!==e[0])i(e),m="",f=0,h++;else{const t=e[1],s=o.MINode.valueOf(t,"file"),r=o.MINode.valueOf(t,"fullname")||s,u=parseInt(o.MINode.valueOf(t,"line")||"1"),l=o.MINode.valueOf(t,"line_asm_insn")||[],d=r?new n.Source(a.basename(r),r):void 0,p={source:d,startLine:u,endLine:u};if(r&&m===r){const e=f&&u>f?Math.min(2,u-f):0;p.startLine=u-e,f=u}else f=0,m=r;for(const e of l)d?(c++,i(e,p)):(h++,i(e))}if(this.doTiming){const e=c+h;this.handleMsg("stdout",`Debug: ${r} => Found ${e} instrunctions. ${c} with source code, ${h} without\n`)}return new p(l,u,!1)}getProtocolDisassembly(e,t){let s=e.qStart;const n=e.qEnd,o=e.verify;return new Promise((a=>r(this,void 0,void 0,(function*(){let r=0;const c=Math.ceil((this.maxInstrSize-this.minInstrSize)/this.instrMultiple),h=()=>{const u=this.findInCache(s,n);if(u){const e=u.findInstrIndex(o);if(e<0){const e=`Bad instruction cache. Could not find address ${o} that should have been found`;this.handleMsg("log",e+"\n"),a(new Error(e))}else a(new p(u.instructions,e));return}const l=e.isKnownStart||this.isRangeInValidMem(s,n),m=n;let g;if(g=`data-disassemble -s ${i.hexFormat(s)} -e ${i.hexFormat(m)} -- 5`,this.doTiming){const t=e.symNode?` (${e.symNode.symbol.name})`:"",r=(m-s+" bytes").padStart(15);this.handleMsg("log",`Debug: Gdb command: -${g}${r} ${t}\n`)}this.miDebugger.sendCommand(g,!1,!1,!0).then((e=>{try{const n=this.parseDisassembleResults(e,o,l,g);if(n.foundAt<0){if(f.debug){const e=`Could not disassemble at this address Looking for ${i.hexFormat(o)}: ${g} `;console.log(e,n.instructions)}if(s>=this.instrMultiple&&r<c)r++,s-=this.instrMultiple,h();else{const e=`Error: Could not disassemble at this address ${i.hexFormat(o)} `+JSON.stringify(t);this.handleMsg("log",e+"\n"),a(new Error(e))}}else{const e=new d(n.instructions);this.addToCache(e),a(n)}}catch(e){a(e)}}),(e=>{this.handleMsg("log",`Error: GDB failed: ${e.toString()}\n`),a(e)}))};h()}))))}findInCache(e,t){for(const s of this.cache)if(s.isInsideRange(e,t))return f.debug&&console.log("Instruction cache hit: ",{startAddr:i.hexFormat(e),endAddr:i.hexFormat(t)},s),s;return null}addToCache(e){for(let t=0;t<this.cache.length;){const s=this.cache[t++];if(s.tryMerge(e))return void(t<this.cache.length&&s.tryMerge(this.cache[t])&&this.cache.splice(t,1))}this.cache.push(e),this.cache.sort(((e,t)=>e.startAddress-t.startAddress))}disassembleProtocolRequest(e,t,s){if(void 0===t.memoryReference)return this.customDisassembleRequest(e,t);const r=null==s?void 0:s.seq;return new Promise(((n,i)=>{f.debug&&this.handleMsg("log",`Debug-${r}: Enqueuing ${JSON.stringify(s)}\n`);const o={response:e,args:t,request:s,resolve:n,reject:i};this.disasmRequestQueue.push(o),this.disasmBusy?this.doTiming&&this.handleMsg("log",`Debug-${r}: ******** Waiting for previous request to complete\n`):this.runDisasmRequest()}))}runDisasmRequest(){if(this.disasmRequestQueue.length>0){this.disasmBusy=!0;const e=this.disasmRequestQueue.shift();this.disassembleProtocolRequest2(e.response,e.args,e.request).then((()=>{this.disasmBusy=!1,e.resolve(),this.runDisasmRequest()}),(t=>{this.disasmBusy=!1,e.reject(t),this.runDisasmRequest()}))}}disassembleProtocolRequest2(e,t,s){return new Promise(((o,a)=>r(this,void 0,void 0,(function*(){try{yield this.getMemoryRegions();const r=null==s?void 0:s.seq;f.debug&&(this.handleMsg("log",`Debug-${r}: Dequeuing...\n`),console.log("disassembleRequest: ",t));const a=parseInt(t.memoryReference),u=t.offset||0,l=t.instructionOffset||0,m=this.doTiming?new c.HrTimer:void 0;if(0!==u)throw new Error("VSCode using non-zero disassembly offset? Don't know how to handle this yet. Please report this problem");const g=Math.max(0,Math.min(a,a+l*this.maxInstrSize)),b=a+(t.instructionCount+l)*this.maxInstrSize,v=this.findDisasmRanges(g,b,a),y=v.map((e=>this.getProtocolDisassembly(e,t))),S=yield Promise.all(y);for(Array.from(S);S.length>0&&!(S[0]instanceof p);)S.shift(),v.shift();for(;S.length>0&&!(S[S.length-1]instanceof p);)S.pop(),v.pop();if(0===S.length)throw new Error(`Disassembly failed completely for ${i.hexFormat(g)} - ${i.hexFormat(b)}`);let E;for(const e of S){const t=v.shift();if(!(e instanceof p))throw new Error(`Disassembly failed completely for ${i.hexFormat(t.qStart)} - ${i.hexFormat(t.qEnd)}`);const s=new d(e.instructions);E?E.forceMerge(s):E=s}let x=E.instructions,w=E.findInstrIndex(a);if(f.debug&&console.log(`Found ${x.length}. baseInstrIndex = ${w}.`),w<0)throw new Error("Could not find an instruction at the baseAddress. Something is not right. Please report this problem");let R=x.length>0?x[0].pvtAddress:a,_=-l-w;const C=[];for(;_>0;_--)R-=this.minInstrSize,C.push(n(R));C.length>0&&(x=C.reverse().concat(x),w+=C.length);const k=w+l;for(k>0&&(x.splice(0,k),w-=k),R=x[x.length-1].pvtAddress;x.length<t.instructionCount;)R+=this.minInstrSize,x.push(n(R));if(x.length>t.instructionCount&&x.splice(t.instructionCount),f.debug&&(console.log(`Returning ${x.length} instructions of ${E.instructions.length} queried. baseInstrIndex = ${w}.`),w>=0&&w<x.length?console.log(x[w]):w!==l&&w!==-l&&w!==x.length+l&&(console.error(`This may be a problem. Referenced index should be exactly ${l} off`),console.log(x))),this.cleaupAndCheckInstructions(x),h.assert(x.length===t.instructionCount,`Instruction count did not match. Please reports this problem ${JSON.stringify(s)}`),e.body={instructions:x},this.doTiming){const e=m.createPaddedMs(3);this.handleMsg("log",`Debug-${r}: Elapsed time for Disassembly Request: ${e} ms\n`)}this.gdbSession.sendResponse(e),o()}catch(t){const r=`Unable to disassemble: ${t.toString()}: ${JSON.stringify(s)}`;f.debug&&console.log(r+"\n"),this.gdbSession.sendErrorResponsePub(e,1,r),o()}}))));function n(e){return{address:i.hexFormat(e),instruction:"<mem-out-of-bounds?>",pvtAddress:e}}}findDisasmRanges(e,t,s){e=this.clipLow(s,e),t=this.clipHigh(s,t);const r=[],n=this.gdbSession.symbolTable.symbolsAsIntervalTree.search(e,t);let i={qStart:Math.min(e,s),qEnd:Math.max(t,s+this.maxInstrSize),verify:s,isKnownStart:!1};if(r.push(i),n.length>0){let e=n[0],s=e.high+1;i.qEnd=s,i.verify=i.qStart=e.low,i.symNode=e,i.isKnownStart=!0;for(let t=1;t<n.length;t++){const o=n[t];if(e.low!==o.low||e.high!==o.high){const e=o.low-s;s=o.high+1,0===e?i.qEnd=s:(i.qEnd=Math.max(i.qEnd,o.low),i={qStart:o.low,qEnd:s,verify:o.low,isKnownStart:!0,symNode:o},r.push(i))}e=o}i.qEnd=Math.max(i.qEnd,t)}return console.table(r),r}cleaupAndCheckInstructions(e){if(e.length>0){let t=null,s=0;for(let r=0;r<e.length;r++){const n=e[r];if(n.pvtInstructionBytes&&!n.pvtIsData){const e=(n.pvtInstructionBytes.length+1)/3;if(e<this.minInstrSize||e>this.maxInstrSize)throw new Error(`Bad/corrupted disassembly (too many/few bytes? Please report this problem ${n.address} ${n.instruction}`)}if(t&&n.line===t.line&&n.location&&t.location&&n.location.path===t.location.path)if(s<10){const t=Object.assign({},n);s++,delete t.location,delete t.line,e[r]=t}else s=0;else s=0;t=n}}}customDisassembleRequest(e,t){return r(this,void 0,void 0,(function*(){if(t.function)try{const s=yield this.getDisassemblyForFunction(t.function,t.file);e.body={instructions:s.instructions,name:s.name,file:s.file,address:s.address,length:s.length},this.gdbSession.sendResponse(e)}catch(t){this.gdbSession.sendErrorResponsePub(e,1,`Unable to disassemble: ${t.toString()}`)}else if(t.startAddress)try{let s=this.gdbSession.symbolTable.getFunctionAtAddress(t.startAddress);if(s)s=yield this.getDisassemblyForFunction(s.name,s.file),e.body={instructions:s.instructions,name:s.name,file:s.file,address:s.address,length:s.length},this.gdbSession.sendResponse(e);else{const s=yield this.getDisassemblyForAddresses(t.startAddress,t.length||256);e.body={instructions:s},this.gdbSession.sendResponse(e)}}catch(t){this.gdbSession.sendErrorResponsePub(e,1,`Unable to disassemble: ${t.toString()}`)}else this.gdbSession.sendErrorResponsePub(e,1,"Unable to disassemble; invalid parameters.")}))}getDisassemblyForFunction(e,t){return r(this,void 0,void 0,(function*(){const s=this.gdbSession.symbolTable.getFunctionByName(e,t);if(!s)throw new Error(`Unable to find function with name ${e}.`);if(s.instructions)return s;const r=s.address,n=s.address+s.length,a=(yield this.miDebugger.sendCommand(`data-disassemble -s ${i.hexFormat(r)} -e ${i.hexFormat(n)} -- 2`)).result("asm_insns").map((e=>({address:o.MINode.valueOf(e,"address"),functionName:o.MINode.valueOf(e,"func-name"),offset:parseInt(o.MINode.valueOf(e,"offset")),instruction:o.MINode.valueOf(e,"inst"),opcodes:o.MINode.valueOf(e,"opcodes")})));return s.instructions=a,s}))}getDisassemblyForAddresses(e,t){return r(this,void 0,void 0,(function*(){const s=e+t;return(yield this.miDebugger.sendCommand(`data-disassemble -s ${i.hexFormat(e)} -e ${i.hexFormat(s)} -- 2`)).result("asm_insns").map((e=>({address:o.MINode.valueOf(e,"address"),functionName:o.MINode.valueOf(e,"func-name"),offset:parseInt(o.MINode.valueOf(e,"offset")),instruction:o.MINode.valueOf(e,"inst"),opcodes:o.MINode.valueOf(e,"opcodes")})))}))}}t.GdbDisassembler=f,f.debug=!0},548:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expandValue=t.isExpandable=void 0;const r=s(9074),n=/^([a-zA-Z_\-][a-zA-Z0-9_\-]*|\[\d+\])\s*=\s*/,i=/^[a-zA-Z_\-][a-zA-Z0-9_\-]*/,o=/^\<.+?\>/,a=/^(0x[0-9a-fA-F]+\s*)"/,c=/^0x[0-9a-fA-F]+/,h=/^0x0+\b/,u=/^(\d+) ['"]/,l=/^\d+(\.\d+)?/;t.isExpandable=function(e){let t;return 0===(e=e.trim()).length?0:e.startsWith("{...}")?2:"{"===e[0]?1:e.startsWith("true")||e.startsWith("false")||(t=h.exec(e))||(t=a.exec(e))?0:(t=c.exec(e))?2:((t=u.exec(e))||(t=l.exec(e))||(t=i.exec(e))||(t=o.exec(e)),0)},t.expandValue=function(e,t,s="",d){const p=()=>{if('"'!==(t=t.trim())[0]&&"'"!==t[0])return"";let e=1,s=!0;const r=t[0];let n=t.substr(1),i=!1;for(;s;)i?i=!1:"\\"===n[0]?i=!0:n[0]===r&&(s=!1),n=n.substr(1),e++;const o=t.substr(0,e).trim();return t=t.substr(e).trim(),o},f=[s];let m,g,b,v,y,S="";const E=e=>{let t="",s="";return f.push(e),f.forEach((e=>{if(s="",""!==e)if(e.startsWith("["))t+=e;else if(t){for(;e.startsWith("*");)s+="*",e=e.substr(1);t=t+"."+e}else t=e})),f.pop(),s+t};return m=()=>'"'===(t=t.trim())[0]?p():"{"===t[0]?(()=>{if("{"!==(t=t.trim())[0])return;if("}"===(t=t.substr(1).trim())[0])return t=t.substr(1).trim(),[];if(t.startsWith("...")&&"}"===(t=t.substr(3).trim())[0])return t=t.substr(1).trim(),"<...>";const e=t.indexOf("="),s=t.indexOf("{"),r=t.indexOf(",");let n=s;if(-1!==r&&r<s&&(n=r),-1!==n&&e>n||-1===e){const e=[];f.push("[0]");let s=m();f.pop(),e.push(y("[0]",s));let r=0;for(;;){if(f.push("["+ ++r+"]"),!(s=b())){f.pop();break}f.pop(),e.push(y("["+r+"]",s))}return t=t.substr(1).trim(),e}let i=v(!0);if(i){const e=[];for(e.push(i);i=g(!0);)e.push(i);return t=t.substr(1).trim(),e}})():(()=>{let e,s;return 0===(t=t.trim()).length?e=void 0:t.startsWith("true")?(e="true",t=t.substr(4).trim()):t.startsWith("false")?(e="false",t=t.substr(5).trim()):(s=h.exec(t))?(e="<nullptr>",t=t.substr(s[0].length).trim()):(s=a.exec(t))?(t=t.substr(s[1].length).trim(),e=p()):(s=c.exec(t))?(e="*"+s[0],t=t.substr(s[0].length).trim()):(s=u.exec(t))?(e=s[1],t=t.substr(s[0].length-1),e+=" "+p()):(s=l.exec(t))||(s=i.exec(t))||(s=o.exec(t))?(e=s[0],t=t.substr(s[0].length).trim()):e=t,e})(),v=(e=!1)=>{t=t.trim();const s=n.exec(t);if(!s)return;t=t.substr(s[0].length).trim();const r=S=s[1];e&&f.push(S);const i=m();return e&&f.pop(),y(r,i)},y=(t,s)=>{let n=0;return"object"==typeof s&&(n=e(s),s="Object"),"string"==typeof s&&s.startsWith("*0x")&&(d&&"1"===r.MINode.valueOf(d,"arg")?(n=e(E("*("+t),{arg:!0}),s="<args>"):(n=e(E("*"+t)),s="Object@"+s)),"string"==typeof s&&s.startsWith("<...>")&&(n=e(E(t)),s="..."),{name:t,value:s,variablesReference:n}},b=()=>{if(","===(t=t.trim())[0])return t=t.substr(1).trim(),m()},g=(e=!1)=>{if(","===(t=t.trim())[0])return t=t.substr(1).trim(),v(e)},t=t.trim(),m()}},1922:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MI2=t.escape=t.parseReadMemResults=void 0;const n=s(5585),i=s(2081),o=s(2361),a=s(9074),c=s(1017),h=s(2037),u=s(2159),l=s(2942),d=s(3200);function p(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}c.posix,t.parseReadMemResults=function(e){return{startAddress:e.resultRecords.results[0][1][0][0][1],endAddress:e.resultRecords.results[0][1][0][2][1],data:e.resultRecords.results[0][1][0][3][1]}},t.escape=p;const f=/^(?:\d*|undefined)[\*\+\=]|[\~\@\&\^]/,m=/(?:\d*|undefined)\(gdb\)/,g=/\d+/;function b(e){return!f.exec(e)}class v extends o.EventEmitter{constructor(e,t){super(),this.application=e,this.args=t,this.currentToken=1,this.nextTokenComing=1,this.handlers={},this.needOutput={},this.buffer="",this.errbuf="",this.firstStop=!0,this.exited=!1,this.status="none",this.pid=-1,this.lastContinueSeqId=-1,this.actuallyStarted=!1,this.exiting=!1,this.commandQueue=[],this.commandQueueBusy=!1}start(e,t){return new Promise(((s,r)=>{this.process=i.spawn(this.application,this.args,{cwd:e,env:this.procEnv}),this.pid=this.process.pid,this.process.stdout.on("data",this.stdout.bind(this)),this.process.stderr.on("data",this.stderr.bind(this)),this.process.on("exit",this.onExit.bind(this)),this.process.on("error",this.onError.bind(this)),this.process.on("spawn",(()=>{u.ServerConsoleLog(`GDB started ppid=${process.pid} pid=${this.process.pid}`,this.process.pid)}));const n=!this.debugOutput;this.sendCommand("gdb-version",!1,!0,n).then((e=>{this.actuallyStarted=!0,this.parseVersionInfo(e.output);const n=[this.gdbMajorVersion>=8?"gdb-set mi-async on":"gdb-set target-async on",...t].map((e=>this.sendCommand(e)));Promise.all(n).then((()=>{s()}),r)}),(()=>{r()}))}))}onError(e){this.emit("launcherror",e)}parseVersionInfo(e){const t=RegExp(/^GNU gdb\s\(.*\)\s?(\d+)\.(\d+)\.[^\r\n]*/gm).exec(e);null!==t&&(e=e.substr(0,t.index),this.gdbMajorVersion=parseInt(t[1]),this.gdbMinorVersion=parseInt(t[2]),this.gdbMajorVersion<9&&this.log("stderr","WARNING: Cortex-Debug will deprecate use of GDB version 8 after July 2022. Please upgrade to version 9+\n")),e&&this.log("console",e)}connect(e){return new Promise(((t,s)=>{const r=e.map((e=>this.sendCommand(e)));Promise.all(r).then((()=>{this.emit("debug-ready"),t()}),s)}))}onExit(){this.actuallyStarted||"linux"===h.platform()&&this.log("log",'Error: Unable to start GDB. Make sure you can start gdb from the command-line and run\n    any command like "echo hello". If you cannot, it is most likely because "libncurses5" is not installed.\n'),u.ServerConsoleLog("GDB: exited",this.pid),this.process&&(this.process=null,this.exited=!0,this.emit("quit"))}stdout(e){this.buffer+="string"==typeof e?e:e.toString("utf8");const t=this.buffer.lastIndexOf("\n");-1!==t&&(this.onOutput(this.buffer.substr(0,t)),this.buffer=this.buffer.substr(t+1)),this.buffer.length&&this.onOutputPartial(this.buffer)&&(this.buffer="")}stderr(e){this.errbuf+="string"==typeof e?e:e.toString("utf8");const t=this.errbuf.lastIndexOf("\n");-1!==t&&(this.onOutputStderr(this.errbuf.substr(0,t)),this.errbuf=this.errbuf.substr(t+1)),this.errbuf.length&&(this.logNoNewLine("stderr",this.errbuf),this.errbuf="")}onOutputStderr(e){(e=e.split("\n")).forEach((e=>{this.log("stderr",e)}))}onOutputPartial(e){return!!b(e)&&(this.logNoNewLine("stdout",e),!0)}onOutput(e){(e=e.split("\n")).forEach((e=>{if(b(e))m.exec(e)||this.log("stdout",e);else{const t=a.parseMI(e);this.debugOutput&&this.debugOutput!==d.ADAPTER_DEBUG_MODE.NONE&&(this.debugOutput!==d.ADAPTER_DEBUG_MODE.RAW&&this.debugOutput!==d.ADAPTER_DEBUG_MODE.BOTH||this.log("log","-> "+e),this.debugOutput!==d.ADAPTER_DEBUG_MODE.RAW&&this.log("log","GDB -> App: "+JSON.stringify(t))),void 0!==t.token&&(void 0!==this.needOutput[t.token]&&(t.output=this.needOutput[t.token]),this.nextTokenComing=t.token+1);let s=!1;void 0!==t.token&&t.resultRecords&&(this.handlers[t.token]?(this.handlers[t.token](t),delete this.handlers[t.token],s=!0):t.token===this.lastContinueSeqId?(this.status="stopped",this.log("stderr",`GDB Error? continue command is reported as error after initially succeeding. token '${t.token}'`),this.emit("continue-failed",t)):this.log("stderr",`Internal Error? Multiple results or no handler for query token '${t.token}'`)),!s&&t.resultRecords&&"error"===t.resultRecords.resultClass&&this.log("stderr",t.result("msg")||e),t.outOfBandRecord&&(t.outOfBandRecord.forEach((e=>{if(e.isStream)"console"===e.type&&void 0!==this.needOutput[this.nextTokenComing]?this.needOutput[this.nextTokenComing]+=e.content:this.log(e.type,e.content);else if("exec"===e.type)if(this.emit("exec-async-output",t),"running"===e.asyncClass)this.status="running",this.debugOutput&&this.log("log",`mi2.status = ${this.status}`),this.emit("running",t);else if("stopped"===e.asyncClass){this.status="stopped",this.debugOutput&&this.log("log",`mi2.status = ${this.status}`);const e=t.record("reason");"breakpoint-hit"===e?this.emit("breakpoint",t):e&&e.includes("watchpoint-trigger")?this.emit("watchpoint",t):e&&e.includes("watchpoint-scope")?this.emit("watchpoint-scope",t):"end-stepping-range"===e?this.emit("step-end",t):"function-finished"===e?this.emit("step-out-end",t):"signal-received"===e?this.emit("signal-stop",t):"exited-normally"===e?this.emit("exited-normally",t):"exited"===e?(this.log("stderr","Program exited with code "+t.record("exit-code")),this.emit("exited-normally",t)):void 0===e&&this.firstStop?(this.log("console","Program stopped, probably due to a reset and/or halt issued by debugger"),this.emit("stopped",t,"entry")):(this.log("console","Not implemented stop reason (assuming exception): "+e||0),this.emit("stopped",t)),this.firstStop=!1,this.emit("generic-stopped",t)}else this.log("log",JSON.stringify(t));else if("notify"===e.type){let t,s,r;for(const n of e.output)"id"===n[0]?t=n[1]:"group-id"===n[0]?s=n[1]:"frame"===n[0]&&(r=n[1]);"thread-created"===e.asyncClass?this.emit("thread-created",{threadId:parseInt(t),threadGroupId:s}):"thread-exited"===e.asyncClass?this.emit("thread-exited",{threadId:parseInt(t),threadGroupId:s}):"thread-selected"===e.asyncClass?this.emit("thread-selected",{threadId:parseInt(t),frameId:r}):"thread-group-exited"===e.asyncClass&&this.emit("thread-group-exited",{threadGroupId:t})}})),s=!0),void 0===t.token&&void 0===t.resultRecords&&0===t.outOfBandRecord.length&&(s=!0),s||this.log("log","Unhandled: "+JSON.stringify(t))}}))}tryKill(){if(!this.exited&&this.process){const e=this.process;try{u.ServerConsoleLog("GDB kill()",this.pid),process.kill(-e.pid)}catch(t){this.log("log","kill failed for "+-e.pid+t),this.onExit()}}}stop(){return r(this,void 0,void 0,(function*(){if(!this.exited&&!this.exiting){let e;this.exiting=!0;const t=t=>{e&&clearTimeout(e),e=setTimeout((()=>{e&&!this.exited&&(u.ServerConsoleLog("GDB Kill timer expired for a disconnect+exit, so forcing a kill",this.pid),this.tryKill()),e=void 0}),t)},s=()=>{e&&(clearTimeout(e),e=void 0)};this.process.on("exit",(e=>{s()}));try{t(500),yield new Promise((e=>setTimeout(e,100))),yield this.sendCommand("target-disconnect")}catch(e){if(this.exited)return u.ServerConsoleLog("GDB already exited during a target-disconnect",this.pid),void s();u.ServerConsoleLog(`target-disconnect failed with exception: ${e}. Proceeding to gdb-exit`+e,this.pid)}if(t(350),yield new Promise((e=>setTimeout(e,250))),this.exited)return void u.ServerConsoleLog("gdb already exited before an exit was requested",this.pid);this.sendRaw("-gdb-exit")}}))}detach(){let e=setTimeout((()=>{e&&(u.ServerConsoleLog("target-detach hung: target probably running, thats okay, continue to stop()",this.pid),e=null,this.stop())}),100);this.sendCommand("target-detach").then((()=>{e&&(clearTimeout(e),e=null),this.stop()}),(t=>{e&&(clearTimeout(e),e=null),u.ServerConsoleLog("target-detach failed: target probably running, thats okay, continue to stop()",this.pid),this.stop()}))}interrupt(e=""){return new Promise(((t,s)=>{this.sendCommand(`exec-interrupt ${e}`).then((e=>{t("done"===e.resultRecords.resultClass)}),s)}))}continue(e){return new Promise(((t,s)=>{this.sendCommand(`exec-continue --thread ${e}`).then((e=>{t("running"===e.resultRecords.resultClass)}),s)}))}next(e,t){return new Promise(((s,r)=>{const n=t?"exec-next-instruction":"exec-next";this.sendCommand(`${n} --thread ${e}`).then((e=>{s("running"===e.resultRecords.resultClass)}),r)}))}step(e,t){return new Promise(((s,r)=>{const n=t?"exec-step-instruction":"exec-step";this.sendCommand(`${n} --thread ${e}`).then((e=>{s("running"===e.resultRecords.resultClass)}),r)}))}stepOut(e){return new Promise(((t,s)=>{this.sendCommand(`exec-finish --thread ${e}`).then((e=>{t("running"===e.resultRecords.resultClass)}),s)}))}goto(e,t){return new Promise(((s,r)=>{const n='"'+(e?p(e)+":":"")+t.toString()+'"';this.sendCommand("break-insert -t "+n).then((()=>{this.sendCommand("exec-jump "+n).then((e=>{s("running"===e.resultRecords.resultClass)}),r)}),r)}))}restart(e){return this._sendCommandSequence(e)}postStart(e){return this._sendCommandSequence(e)}_sendCommandSequence(e){return new Promise(((t,s)=>{const r=(e=>{if(0===e.length)t(!0);else{const t=e[0];this.sendCommand(t).then((t=>{r(e.slice(1))}),s)}}).bind(this);r(e)}))}changeVariable(e,t){return this.sendCommand("gdb-set var "+e+"="+t)}setBreakPointCondition(e,t){return this.sendCommand("break-condition "+e+" "+t)}addBreakPoint(e){return new Promise(((t,s)=>{let r="";if(e.hitCondition)if(">"===e.hitCondition[0])r+="-i "+g.exec(e.hitCondition.substr(1))[0]+" ";else{const t=g.exec(e.hitCondition)[0];t.length!==e.hitCondition.length?(this.log("stderr","Unsupported break count expression: '"+e.hitCondition+"'. Only supports 'X' for breaking once after X times or '>X' for ignoring the first X breaks"),r+="-t "):0!==parseInt(t)&&(r+="-t -i "+parseInt(t)+" ")}e.condition&&(r+=`-c "${e.condition}" `),e.raw?r+="*"+p(e.raw):r+='"'+p(e.file)+":"+e.line+'"';const i=e.logMessage?"dprintf-insert":"break-insert";e.logMessage&&(r+=" "+e.logMessage),this.sendCommand(`${i} ${r}`).then((i=>{if("done"===i.resultRecords.resultClass){const s=parseInt(i.result("bkpt.number")),r=i.result("bkpt.line"),n=i.result("bkpt.addr");if(e.line=r?parseInt(r):e.line,e.number=s,n&&(e.address=n),void 0===e.file){const t=i.result("bkpt.fullname")||i.record("bkpt.file");e.file=t||void 0}t(e)}else s(new n.MIError(i.result("msg")||"Internal error",`Setting breakpoint at ${r}`))}),s)}))}addInstrBreakPoint(e){return new Promise(((t,s)=>{let r="";e.condition&&(r+=`-c "${e.condition}" `),r+="*"+l.hexFormat(e.address),this.sendCommand(`break-insert ${r}`).then((i=>{if("done"===i.resultRecords.resultClass){const s=parseInt(i.result("bkpt.number"));e.number=s,t(e)}else s(new n.MIError(i.result("msg")||"Internal error",`Setting breakpoint at ${r}`))}),s)}))}removeBreakpoints(e){return new Promise(((t,s)=>{if(0===e.length)t(!0);else{const r="break-delete "+e.join(" ");this.sendCommand(r).then((e=>{t("done"===e.resultRecords.resultClass)}),s)}}))}addDataBreakPoint(e){return new Promise(((t,s)=>{let r="";if(e.hitCondition)if(">"===e.hitCondition[0])r+="-i "+g.exec(e.hitCondition.substr(1))[0]+" ";else{const t=g.exec(e.hitCondition)[0];t.length!==e.hitCondition.length?(this.log("stderr","Unsupported break count expression: '"+e.hitCondition+"'. Only supports 'X' for breaking once after X times or '>X' for ignoring the first X breaks"),r+="-t "):0!==parseInt(t)&&(r+="-t -i "+parseInt(t)+" ")}r+=e.dataId;const i="read"===e.accessType?"-r":"readWrite"===e.accessType?"-a":"";this.sendCommand(`break-watch ${i} ${r}`).then((i=>{if("done"===i.resultRecords.resultClass){const r=parseInt(i.result("hw-awpt.number")||i.result("wpt.number"));e.number=r,e.condition?this.setBreakPointCondition(r,e.condition).then((r=>{"done"===r.resultRecords.resultClass?t(e):s(new n.MIError(r.result("msg")||"Internal error","Setting breakpoint condition"))}),(e=>{this.sendCommand(`break-delete ${r}`).then((e=>{}),(e=>{})),s(e)})):t(e)}else s(new n.MIError(i.result("msg")||"Internal error",`Setting breakpoint at ${r}`))}),s)}))}getFrame(e,t){return new Promise(((s,r)=>{const n=`stack-info-frame --thread ${e} --frame ${t}`;this.sendCommand(n).then((e=>{const t=e.result("frame"),r=a.MINode.valueOf(t,"level"),n=a.MINode.valueOf(t,"addr"),i=a.MINode.valueOf(t,"func"),o=a.MINode.valueOf(t,"file"),c=a.MINode.valueOf(t,"fullname");let h=0;const u=a.MINode.valueOf(t,"line");u&&(h=parseInt(u)),s({address:n,fileName:o,file:c,function:i,level:r,line:h})}),r)}))}getStackDepth(e){return new Promise(((t,s)=>{this.sendCommand(`stack-info-depth --thread ${e} 10000`).then((e=>{const s=e.result("depth"),r=parseInt(s);t(r)}),s)}))}getStack(e,t,s){return new Promise(((r,n)=>{this.sendCommand(`stack-list-frames --thread ${e} ${t} ${s}`).then((e=>{const t=e.result("stack"),s=[];t.forEach((e=>{const t=a.MINode.valueOf(e,"@frame.level"),r=a.MINode.valueOf(e,"@frame.addr"),n=a.MINode.valueOf(e,"@frame.func"),i=a.MINode.valueOf(e,"@frame.file"),o=a.MINode.valueOf(e,"@frame.fullname");let c=0;const h=a.MINode.valueOf(e,"@frame.line");h&&(c=parseInt(h));const u=parseInt(a.MINode.valueOf(e,"@frame.from"));s.push({address:r,fileName:i,file:o,function:n||u,level:t,line:c})})),r(s)}),n)}))}getStackVariables(e,t){return r(this,void 0,void 0,(function*(){const s=(yield this.sendCommand(`stack-list-variables --thread ${e} --frame ${t} --simple-values`)).result("variables"),r=[];for(const e of s){const t=a.MINode.valueOf(e,"name"),s=a.MINode.valueOf(e,"value"),n=a.MINode.valueOf(e,"type");r.push({name:t,valueStr:s,type:n,raw:e})}return r}))}examineMemory(e,t){return new Promise(((s,r)=>{this.sendCommand("data-read-memory-bytes 0x"+e.toString(16)+" "+t).then((e=>{s(e.result("memory[0].contents"))}),r)}))}evalExpression(e,t,s){return new Promise(((r,n)=>{const i=v.getThreadFrameStr(t,s);this.sendCommand(`data-evaluate-expression ${i} `+e).then((e=>{r(e)}),n)}))}varCreate(e,t,s="-",i="@",o,a){return r(this,void 0,void 0,(function*(){let r=null;t=t.trim(),/,[bdhonx]$/i.test(t)&&(r=t.substring(t.length-1).toLocaleLowerCase(),t=t.substring(0,t.length-2)),t=t.replace(/"/g,'\\"');const c="*"===i&&void 0!==o&&void 0!==a?`--thread ${o} --frame ${a}`:"",h=yield this.sendCommand(`var-create ${c} ${s} ${i} "${t}"`);let u=null;if(r&&"-"!==s){const e=yield this.sendCommand(`var-set-format ${s} ${v.FORMAT_SPEC_MAP[r]}`);u=e.result("value")}let l=h.result("");return u&&(l=l.map((e=>"value"===e[0]?["value",u]:e))),new n.VariableObject(e,l)}))}varEvalExpression(e){return r(this,void 0,void 0,(function*(){return this.sendCommand(`var-evaluate-expression ${e}`)}))}varListChildren(e,t){return r(this,void 0,void 0,(function*(){const s=["private","protected","public"],r=(yield this.sendCommand(`var-list-children --all-values ${t}`)).result("children")||[],i=[];for(const t of r){const r=new n.VariableObject(e,t[1]);r.exp.startsWith("<anonymous ")||s.find((e=>e===r.exp))?i.push(...yield this.varListChildren(e,r.name)):i.push(r)}return i}))}static getThreadFrameStr(e,t){return(e>0?`--thread ${e} `:"")+(t>=0?`--frame ${t}`:"")}varUpdate(e="*",t,s){return r(this,void 0,void 0,(function*(){return this.sendCommand(`var-update ${v.getThreadFrameStr(t,s)} --all-values ${e}`)}))}varAssign(e,t,s,n){return r(this,void 0,void 0,(function*(){return this.sendCommand(`var-assign ${v.getThreadFrameStr(s,n)} ${e} ${t}`)}))}logNoNewLine(e,t){this.emit("msg",e,t)}log(e,t){this.emit("msg",e,"\n"===t[t.length-1]?t:t+"\n")}sendUserInput(e){return e.startsWith("-")?this.sendCommand(e.substr(1)):this.sendCommand(`interpreter-exec console "${e}"`)}sendRaw(e){var t;(null===(t=this.process)||void 0===t?void 0:t.stdin)&&(this.debugOutput&&this.log("log",e),this.process.stdin.write(e+"\n"))}getCurrentToken(){return this.currentToken}isRunning(){return!!this.process}sendOneCommand(e){const t=this.currentToken++;return new Promise(((s,r)=>{const i=t=>{const i=t;if(e.suppressFailure&&i)this.log("stderr",`WARNING: Error executing command '${e.command}'`),s(i);else if(i)try{const t=i.result("msg");r(new n.MIError(t||"Internal error",e.command))}catch(t){console.log(`Huh? ${t}`),r(new n.MIError(t.toString(),e.command))}else r(new n.MIError(t?t.toString():"Unknown error",e.command))};e.swallowStdout&&(this.needOutput[t]="");const o=this.debugOutput;e.forceNoDebug&&this.debugOutput&&(this.log("log",`Suppressing output for '${t}-${e.command}'`),this.debugOutput=void 0),this.handlers[t]=r=>{this.debugOutput=o,e.swallowStdout&&delete this.needOutput[t],"error"===r.resultRecords.resultClass?i(r):s(r)},e.command.startsWith("exec-continue")&&(this.lastContinueSeqId=t);try{this.sendRaw(t+"-"+e.command)}catch(e){this.debugOutput=o,i(e)}}))}sendCommand(e,t=!1,s=!1,n=!1){return new Promise(((i,o)=>r(this,void 0,void 0,(function*(){const r={command:e,suppressFailure:t,swallowStdout:s,forceNoDebug:n,resolve:i,reject:o};for(this.commandQueue.push(r);!this.commandQueueBusy&&this.commandQueue.length>0;){this.commandQueueBusy=!0;const e=this.commandQueue.shift();try{const t=yield this.sendOneCommand(e);e.resolve(t)}catch(t){e.reject(t)}this.commandQueueBusy=!1}}))))}}t.MI2=v,v.FORMAT_SPEC_MAP={b:"binary",d:"decimal",h:"hexadecimal",o:"octal",n:"natural",x:"hexadecimal"}},9074:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseMI=t.MINode=void 0;const s=/^[0-7]{3}/,r={"\\":"\\",'"':'"',"'":"'",n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v",0:"\0"};class n{constructor(e,t,s){this.output="",this.token=e,this.outOfBandRecord=t,this.resultRecords=s}static valueOf(e,t){if(!e)return;const s=/^\.?([a-zA-Z_\-][a-zA-Z0-9_\-]*)/,r=/^\[(\d+)\](?:$|\.)/;if(!(t=t.trim()))return e;let n=e;do{let e=s.exec(t);if(e){if(t=t.substr(e[0].length),!n.length||"string"==typeof n)return;{const t=[];for(const s of n)s[0]===e[1]&&t.push(s[1]);if(t.length>1)n=t;else{if(1!==t.length)return;n=t[0]}}}else if("@"===t[0])n=[n],t=t.substr(1);else{if(e=r.exec(t),!e)return;{t=t.substr(e[0].length);const s=parseInt(e[1]);if(n.length&&"string"!=typeof n&&s>=0&&s<n.length)n=n[s];else if(0!==s)return}}t=t.trim()}while(t);return n}record(e){if(this.outOfBandRecord&&0!==this.outOfBandRecord.length)return n.valueOf(this.outOfBandRecord[0].output,e)}result(e){if(this.resultRecords)return n.valueOf(this.resultRecords.results,e)}}t.MINode=n;const i=/^(?:(\d*|undefined)([\*\+\=])|([\~\@\&]))/,o=/^(\d*)\^(done|running|connected|error|exit)/,a=/^\r\n?/,c=/^([a-zA-Z_\-][a-zA-Z0-9_\-]*)/,h=/^(.*?),/;t.parseMI=function(e){let t;const u=[];let l;const d={"*":"exec","+":"status","=":"notify"},p={"~":"console","@":"target","&":"log"},f=()=>{if('"'!==e[0])return"";let t,n=1,i=!0,o=e.substr(1),a=!1;for(;i;)a?a=!1:"\\"===o[0]?a=!0:'"'===o[0]&&(i=!1),o=o.substr(1),n++;try{t=function(e){const t=Buffer.alloc(4*e.length);let n=0;if('"'!==e[0]||'"'!==e[e.length-1])throw new Error("Not a valid string");e=e.slice(1,-1);for(let i=0;i<e.length;i++)if("\\"===e[i]){if(++i>=e.length)throw new Error("Not a valid escape sequence");const o=r[e[i]];if(o)n+=t.write(o,n);else{const r=s.exec(e.substr(i));r?(t.writeUInt8(parseInt(r[0],8),n++),i+=2):n+=t.write(e[i],n)}}else{if('"'===e[i])throw new Error("Not a valid string");n+=t.write(e[i],n)}return t.toString("utf8",0,n)}(e.substr(0,n))}catch(s){t=e.substr(0,n)}return e=e.substr(n),t};let m,g,b,v,y;for(m=()=>'"'===e[0]?f():"{"===e[0]||"["===e[0]?(()=>{if("{"!==e[0]&&"["!==e[0])return;const t="["===e[0];if("}"===(e=e.substr(1))[0]||"]"===e[0])return e=e.substr(1),[];if(t){let t=m();if(t){const s=[];for(s.push(t);void 0!==(t=b());)s.push(t);return e=e.substr(1),s}}let s=v();if(s){const t=[];for(t.push(s);s=g();)t.push(s);return e=e.substr(1),t}e=(t?"[":"{")+e})():void 0,v=()=>{const t=c.exec(e);if(t)return e=e.substr(t[0].length+1),[t[1],m()]},b=()=>{if(","===e[0])return e=e.substr(1),m()},g=()=>{if(","===e[0])return e=e.substr(1),v()};y=i.exec(e);){if(e=e.substr(y[0].length),y[1]&&void 0===t&&"undefined"!==y[1]&&(t=parseInt(y[1])),y[2]){const t=h.exec(e);e=e.substr(t[1].length);const s={isStream:!1,type:d[y[2]],asyncClass:t[1],output:[]};let r;for(;r=g();)s.output.push(r);u.push(s)}else if(y[3]){const e={isStream:!0,type:p[y[3]],content:f()};u.push(e)}e=e.replace(a,"")}if(y=o.exec(e)){let s;for(e=e.substr(y[0].length),y[1]&&void 0===t&&(t=parseInt(y[1])),l={resultClass:y[2],results:[]};s=g();)l.results.push(s);e=e.replace(a,"")}return new n(t,u||[],l)}},2159:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GDBServer=t.ServerConsoleLog=t.GdbPid=void 0;const n=s(2081),i=s(2037),o=s(1808),a=s(358),c=s(2361),h=s(9512),u=s(3200),l=s(530);function d(e,s){try{const r=i.tmpdir(),n=new Date;s&&(t.GdbPid=s),e=`[${n.toISOString()}] ppid=${process.pid} pid=${t.GdbPid} `+e,console.log(e),e.endsWith("\n")||(e+="\n"),a.appendFileSync(`${r}/cortex-debug-server-exiting.log`,e)}catch(e){console.log(e.toString())}}t.GdbPid=-1,t.ServerConsoleLog=d;let p=[];class f extends c.EventEmitter{constructor(e,t,s,r,n,i){super(),this.cwd=e,this.application=t,this.args=s,this.initMatch=r,this.port=n,this.consolePort=i,this.outBuffer="",this.errBuffer="",this.consoleSocket=null,this.pid=-1,this.exitTimeout=null,this.killInProgress=!1}init(){return new Promise(((e,t)=>r(this,void 0,void 0,(function*(){if(null!==this.application){this.initResolve=e,this.initReject=t;try{yield this.connectToConsole()}catch(e){d("GDBServer: Could not connect to console: "+e),t(e)}this.process=n.spawn(this.application,this.args,{cwd:this.cwd}),p.push(this),this.pid=this.process.pid,this.process.stdout.on("data",this.onStdout.bind(this)),this.process.stderr.on("data",this.onStderr.bind(this)),this.process.on("exit",this.onExit.bind(this)),this.process.on("error",this.onError.bind(this)),-1!==this.application.indexOf("st-util")&&"win32"===i.platform()&&h.setTimeout((()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)}),500),null==this.initMatch&&h.setTimeout((()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)}),100)}else e(!0)}))))}isExternal(){return!this.application}isProcessRunning(){return!!this.process}exit(){if(this.process&&!this.killInProgress)try{d(`GDBServer(${this.pid}): forcing an exit with kill()`),this.killInProgress=!0,this.process.kill()}catch(e){d(`GDBServer(${this.pid}): Trying to force and exit failed ${e}`)}}onExit(e,t){d(`GDBServer(${this.pid}): exited code=${e} signal=${t}`),p=p.filter((e=>e!==this)),this.process=null,this.exitTimeout&&(clearTimeout(this.exitTimeout),this.exitTimeout=null),this.emit("exit",e,t),this.disconnectConsole()}onError(e){this.initReject&&(this.initReject(e),this.initReject=null,this.initResolve=null),this.emit("launcherror",e)}onStdout(e){if(this.sendToConsole(e),this.initResolve){this.outBuffer+="string"==typeof e?e:e.toString("utf8"),this.initResolve&&this.initMatch&&this.initMatch.test(this.outBuffer)&&(this.initResolve(!0),this.initResolve=null,this.initReject=null);const t=this.outBuffer.lastIndexOf("\n");-1!==t&&(this.outBuffer=this.outBuffer.substring(t+1))}}onStderr(e){if(this.sendToConsole(e),this.initResolve){this.errBuffer+="string"==typeof e?e:e.toString("utf8"),this.initResolve&&this.initMatch&&this.initMatch.test(this.errBuffer)&&(this.initResolve(!0),this.initResolve=null,this.initReject=null);const t=this.errBuffer.lastIndexOf("\n");-1!==t&&(this.errBuffer=this.errBuffer.substring(t+1))}}connectToConsole(){return new Promise(((e,t)=>{const s=new o.Socket;s.on("data",(e=>{try{this.process.stdin.write(e,"utf8")}catch(e){console.error(`stdin write failed ${e}`)}})),s.once("close",(()=>{this.consoleSocket=null})),s.on("error",(e=>{if("ECONNRESET"!==e.code){const s=`Error: unexpected socket error ${e}. Please report this problem`;this.emit("output",s+"\n"),console.error(s),this.consoleSocket||t(e)}else this.consoleSocket&&(this.consoleSocket.destroy(),this.consoleSocket=null)})),s.connect(this.consolePort,"127.0.0.1",(()=>{s.write(l.greenFormat(u.quoteShellCmdLine([this.application,...this.args])+"\n")),this.consoleSocket=s,e()}))}))}sendToConsole(e){this.consoleSocket?this.consoleSocket.write(e):console.error("sendToConsole: console not open. How did this happen?")}disconnectConsole(){try{this.consoleSocket&&(this.consoleSocket.destroy(),this.consoleSocket=null)}catch(e){}}}t.GDBServer=f,f.SERVER_TIMEOUT=1e4,f.LOCALHOST="0.0.0.0",process.on("exit",((e,t)=>{if(p.length>0){d(`Debug Adapter killed by VSCode? code=${e} signal=${t}`);for(const e of[...p])e.exit()}}))},6434:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolTable=t.MemoryRegion=t.SymbolNode=void 0;const n=s(2037),i=s(1017),o=s(358),a=s(6113),c=s(3200),h=s(1501),u=s(970),l=s(5275),d=s(9796),p=s(565),f=s(2942),m=RegExp(/^([0-9a-f]{8})\s([lg\ !])([w\ ])([C\ ])([W\ ])([I\ ])([dD\ ])([FfO\ ])\s(.*?)\t([0-9a-f]+)\s(.*)$/),g=RegExp(/^([0-9a-f]+).*\t(.+):[0-9]+/),b={F:p.SymbolType.Function,f:p.SymbolType.File,O:p.SymbolType.Object," ":p.SymbolType.Normal},v={l:p.SymbolScope.Local,g:p.SymbolScope.Global," ":p.SymbolScope.Neither,"!":p.SymbolScope.Both};class y{constructor(e,t,s){this.symbol=e,this.low=t,this.high=s}}t.SymbolNode=y;class S{constructor(e){Object.assign(this,e),this.vmaEnd=this.vmaStart+this.size+1,this.lmaEnd=this.lmaStart+this.size+1}inVmaRegion(e){return e>=this.vmaStart&&e<this.vmaEnd}inLmaRegion(e){return e>=this.lmaStart&&e<this.lmaEnd}inRegion(e){return this.inVmaRegion(e)||this.inLmaRegion(e)}}function E(e,t,s){"win32"===n.platform()&&(e=e.toLowerCase().replace("\\","/"));const r=e.lastIndexOf("/"),i=r>=0?e.substring(0,r+1):"",o=e.substring(r+1),a=o.replace(t,s);return a===o?null:i+a}t.MemoryRegion=S;class x{constructor(e,t){this.gdbSession=e,this.executables=t,this.allSymbols=[],this.fileTable=[],this.memoryRegions=[],this.staticsByFile={},this.globalVars=[],this.globalFuncsMap={},this.staticVars=[],this.staticFuncsMap={},this.fileMap={},this.symbolsAsIntervalTree=new h.IntervalTree,this.symbolsByAddress=new Map,this.symbolsByAddressOrig=new Map,this.varsByFile=null,this.nmPromises=[],this.rttSymbolName="_SEGGER_RTT",this.currentObjDumpFile=null,this.addressToFileOrig=new Map;const s=this.gdbSession.args;if(this.objdumpPath=s.objdumpPath,!this.objdumpPath)if(this.objdumpPath="win32"!==n.platform()?`${s.toolchainPrefix}-objdump`:`${s.toolchainPrefix}-objdump.exe`,s.toolchainPath)this.objdumpPath=i.normalize(i.join(s.toolchainPath,this.objdumpPath));else if(s.gdbPath){const e=E(s.gdbPath,/gdb/i,"objdump");this.objdumpPath=e||this.objdumpPath}}createSymtableSerializedFName(e){return this.createFileMapCacheFileName(e,"-syms")+".gz"}serializeSymbolTable(e){const t={},s=this.allSymbols.length>0?Object.keys(this.allSymbols[0]):[];this.fileTable=[];const r=[];for(const e of this.allSymbols){const s=e.file;let n=t[s];void 0===n&&(n=this.fileTable.length,this.fileTable.push(s),t[s]=n);const i=e.file;e.file=n,r.push(Object.values(e)),e.file=i}const n={version:x.CurrentVersion,memoryRegions:this.memoryRegions,fileTable:this.fileTable,symbolKeys:s,allSymbols:r},i=this.createSymtableSerializedFName(e),a=o.createWriteStream(i,{flags:"w"});a.on("error",(()=>{console.error("Saving symbol table failed!!!")})),a.on("close",(()=>{console.log("Saved symbol table")}));const c=new u.default([n]);c.on("error",(()=>{console.error("Saving symbol table JsonStreamStringify() failed!!!")})),c.pipe(d.createGzip()).pipe(a).on("finish",(()=>{console.log("Pipe ended")}))}deSerializeSymbolTable(e){return new Promise((t=>{const s=this.createSymtableSerializedFName(e);if(!o.existsSync(s))return void t(!1);const r=o.createReadStream(s);r.on("error",(()=>{t(!1)})),console.time("abc");const n=l.withParser();n.on("data",(({key:e,value:t})=>{console.timeLog("abc","Parsed data:"),r.close(),i(t)})),r.pipe(d.createGunzip()).pipe(n.input);const i=e=>{try{const s=e;if(!s||s.version!==x.CurrentVersion)return void t(!1);this.fileMap={};for(const e of s.fileTable)null!==e&&this.addPathVariations(e);this.allSymbols=[];const r=s.symbolKeys;r.length;for(const e of s.allSymbols){const t={};e.forEach(((e,s)=>t[r[s]]=e)),t.file=s.fileTable[t.file],this.addSymbol(t)}this.memoryRegions=[];for(const e of s.memoryRegions)this.memoryRegions.push(new S(e));console.timeEnd("abc"),t(!0)}catch(e){t(!1)}}}))}loadSymbols(){return new Promise((e=>r(this,void 0,void 0,(function*(){const t="Total running objdump & nm";console.time(t);try{yield this.loadFromObjdumpAndNm();const s="Postprocessing symbols";console.time(s),this.categorizeSymbols(),this.sortGlobalVars(),e(),console.timeEnd(s)}catch(t){this.gdbSession.handleMsg("log",`Error: objdump failed! statics/globals/functions may not be properly classified: ${t.toString()}`),this.gdbSession.handleMsg("log","    ENOENT means program not found. If that is not the issue, please report this problem."),e()}finally{console.timeEnd(t)}}))))}addSymbol(e){if(!this.symbolsByAddress.get(e.address)){if(!this.rttSymbol&&e.name===this.rttSymbolName&&e.type===p.SymbolType.Object&&e.length>0&&(this.rttSymbol=e),this.allSymbols.push(e),e.type===p.SymbolType.Function||e.length>0){const t=new y(e,e.address,e.address+Math.max(1,e.length)-1);this.symbolsAsIntervalTree.insert(t)}this.symbolsByAddress.set(e.address,e),this.symbolsByAddressOrig.set(e.addressOrig,e)}}readObjdumpHeaderLine(e,t,s){if(!t)return""===t;const r=RegExp(/^\s*[0-9]+\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)\s+(.*)$/),n=t.match(r);if(n){const t=n[7].trim().toLowerCase().split(/[,\s]+/g);if(!t.find((e=>"alloc"===e)))return!0;const s=n[1],r=e.offset||0,i=parseInt(n[3],16);let o=i+r;const a=e.sectionMap[s];".text"===s&&"number"==typeof e.textaddress&&(o=e.textaddress,a||(e.sections.push({address:o,addressOrig:i,name:s}),e.sectionMap[s]=e.sections[e.sections.length-1])),a&&(a.addressOrig=o,o=a.address);const c=new S({name:s,size:parseInt(n[2],16),vmaStart:o,vmaStartOrig:i,lmaStart:parseInt(n[4],16),attrs:t});this.memoryRegions.push(c)}else RegExp(/^SYMBOL TABLE:/).test(t)&&(this.objdumpReader.callback=this.readObjdumpSymbolLine.bind(this,e));return!0}readObjdumpSymbolLine(e,t,s){if(!t)return""===t;const r=t.match(m);if(r){"d"===r[7]&&"f"===r[8]&&(r[11]?this.currentObjDumpFile=x.NormalizePath(r[11].trim()):this.currentObjDumpFile=null);const t=b[r[8]],s=v[r[2]];let n=r[11].trim(),i=!1;n.startsWith(".hidden")&&(n=n.substring(7).trim(),i=!0);const o=r[9].trim(),a=e.offset||0,c=parseInt(r[1],16),h=e.sectionMap[o],u={addressOrig:c,address:c+(h?c-h.addressOrig:a),name:n,file:this.currentObjDumpFile,type:t,scope:s,section:r[9].trim(),length:parseInt(r[10],16),isStatic:!(s!==p.SymbolScope.Local||!this.currentObjDumpFile),instructions:null,hidden:i};this.addSymbol(u)}return!0}loadFromObjdumpAndNm(){return new Promise(((e,t)=>r(this,void 0,void 0,(function*(){let s=!1;const r=[];for(const e of this.executables){const n=e.file;if(c.validateELFHeader(n))try{const i={cwd:this.gdbSession.args.cwd},o=Date.now(),a=["--syms","-C","-h","-w",n];this.currentObjDumpFile=null,this.objdumpReader=new c.SpawnLineReader,this.objdumpReader.on("error",(e=>{s=!0,t(e)})),this.objdumpReader.on("exit",((e,t)=>{console.log("objdump exited",e,t)})),this.objdumpReader.on("close",((e,t)=>{this.objdumpReader=void 0,this.currentObjDumpFile=null;{const e=Date.now()-o;this.gdbSession.handleMsg("log",`Finished reading symbols from objdump: Time: ${e} ms\n`)}})),this.gdbSession.handleMsg("log",`Reading symbols from ${this.objdumpPath} ${a.join(" ")}\n`),r.push({args:[this.objdumpPath,...a],promise:this.objdumpReader.startWithProgram(this.objdumpPath,a,i,this.readObjdumpHeaderLine.bind(this,e))});const h=Date.now(),u=E(this.objdumpPath,/objdump/i,"nm"),l=["--defined-only","-S","-l","-C","-p",n],d=new c.SpawnLineReader;d.on("error",(e=>{this.gdbSession.handleMsg("log",`Error: ${u} failed! statics/global/functions may not be properly classified: ${e.toString()}\n`),this.gdbSession.handleMsg("log","    Expecting `nm` next to `objdump`. If that is not the problem please report this.\n"),this.nmPromises=[]})),d.on("exit",((e,t)=>{})),d.on("close",(()=>{{const e=Date.now()-h;this.gdbSession.handleMsg("log",`Finished reading symbols from nm: Time: ${e} ms\n`)}})),this.gdbSession.handleMsg("log",`Reading symbols from ${u} ${l.join(" ")}\n`),this.nmPromises.push({args:[u,...l],promise:d.startWithProgram(u,l,i,this.readNmSymbolLine.bind(this,e))})}catch(e){if(!s)return s=!0,void t(e)}else this.gdbSession.handleMsg("log",`Warn: ${n} is not an ELF file format. Some features won't work -- Globals, Locals, disassembly, etc.`)}yield this.waitOnProgs(r),this.finishNmSymbols(),e()}))))}waitOnProgs(e){return r(this,void 0,void 0,(function*(){for(const t of e)try{yield t.promise}catch(e){this.gdbSession.handleMsg("log",`Failed running: ${[t.args.join(" ")]}.\n    ${e}`)}return Promise.resolve()}))}finishNmSymbols(){return this.nmPromises.length?(this.finishNmSymbolsPromise||(this.finishNmSymbolsPromise=new Promise((e=>r(this,void 0,void 0,(function*(){try{yield this.waitOnProgs(this.nmPromises);for(const e of this.addressToFileOrig){const t=this.symbolsByAddressOrig.get(e[0]);t?t.file=e[1]:console.error("Unknown symbol address. Need to investigate",f.hexFormat(e[0]),e)}}catch(e){}finally{this.addressToFileOrig.clear(),this.nmPromises=[]}}))))),this.finishNmSymbolsPromise):Promise.resolve()}readNmSymbolLine(e,t,s){const r=t&&t.match(g);if(r){const t=e.offset||0,s=parseInt(r[1],16)+t,n=x.NormalizePath(r[2]);this.addressToFileOrig.set(s,n),this.addPathVariations(n)}return!0}updateSymbolSize(e,t){this.symbolsAsIntervalTree.remove(e),e.symbol.length=t,e=new y(e.symbol,e.low,e.low+t-1),this.symbolsAsIntervalTree.insert(e)}sortGlobalVars(){this.globalVars.sort(((e,t)=>e.name.localeCompare(t.name,void 0,{sensitivity:"base"})));const e=[];for(;this.globalVars.length>0&&this.globalVars[0].name.startsWith("__");)e.push(this.globalVars.shift());this.globalVars=this.globalVars.concat(e)}categorizeSymbols(){for(const e of this.allSymbols){const t=e.scope,s=e.type;if(t!==p.SymbolScope.Local)s===p.SymbolType.Function?(e.scope=p.SymbolScope.Global,this.globalFuncsMap[e.name]=e):s===p.SymbolType.Object&&t===p.SymbolScope.Global&&this.globalVars.push(e);else if(e.file){if(s===p.SymbolType.Object)this.staticVars.push(e);else if(s===p.SymbolType.Function){const t=this.staticFuncsMap[e.name];t?t.push(e):this.staticFuncsMap[e.name]=[e]}}else s===p.SymbolType.Function?(e.scope=p.SymbolScope.Global,this.globalFuncsMap[e.name]=e):p.SymbolType.Object}}printSyms(e){e=e||console.log;for(const t of this.allSymbols){let s=t.name;if(t.type===p.SymbolType.Function?s+=" (f)":t.type===p.SymbolType.Object&&(s+=" (o)"),t.file&&(s+=" (s)"),e(s),t.file){const s=this.fileMap[t.file];if(s)for(const t of s)e("\t"+t);else e("\tNoMap for? "+t.file)}}}printToFile(e){try{const t=o.openSync(e,"w");this.printSyms((e=>{o.writeSync(t,e),o.writeSync(t,"\n")})),o.closeSync(t)}catch(e){console.log("printSymsToFile: failed"+e)}}addToFileMap(e,t){t=x.NormalizePath(t);const s=this.fileMap[e]||[];return-1===s.indexOf(t)&&s.push(t),this.fileMap[e]=s,s}addPathVariations(e){const t=x.NormalizePath(e),s=i.basename(t);return this.addToFileMap(s,s),this.addToFileMap(s,t),this.addToFileMap(t,s),{curSimpleName:s,curName:t}}getFileNameHashed(e){try{e=x.NormalizePath(e);const t=x.CurrentVersion,s=`v${t}-gdb.${this.gdbSession.miDebugger.gdbMajorVersion}.${this.gdbSession.miDebugger.gdbMinorVersion}`,r=o.statSync(e),n=process.cwd,i=`${e}-${r.mtimeMs}-${s}-${n}`,c=a.createHash("sha256");return c.update(i),c.digest("hex")}catch(e){throw e}}createFileMapCacheFileName(e,t=""){const s=this.getFileNameHashed(e)+t+".json";return i.join(n.tmpdir(),"Cortex-Debug-"+s)}getFunctionAtAddress(e){const t=this.symbolsAsIntervalTree.search(e,e);for(const e of t)if(e&&e.symbol.type===p.SymbolType.Function)return e.symbol;return null}getFunctionSymbols(){return this.allSymbols.filter((e=>e.type===p.SymbolType.Function))}getGlobalVariables(){return this.globalVars}getStaticVariableNames(e){return r(this,void 0,void 0,(function*(){if(this.varsByFile){const t=x.NormalizePath(e),s=this.varsByFile[t]||this.varsByFile[e];return s?s.staticNames:null}return yield this.finishNmSymbols(),this.getStaticVariables(e).map((e=>e.name))}))}getStaticVariables(e){if(!e)return[];const t=x.NormalizePath(e);let s=this.staticsByFile[e];if(!s){s=[];for(const r of this.staticVars)if(r.file===t||r.file===e)s.push(r);else{const n=this.fileMap[r.file];(n&&-1!==n.indexOf(t)||n&&-1!==n.indexOf(e))&&s.push(r)}this.staticsByFile[e]=s}return s}getFunctionByName(e,t){if(t){const s=x.NormalizePath(t),r=this.staticFuncsMap[e];if(r){for(const e of r)if(e.file===t||e.file===s)return e;for(const e of r){const r=this.fileMap[e.file];if(r&&-1!==r.indexOf(s))return e;if(r&&-1!==r.indexOf(t))return e}}}return this.globalFuncsMap[e]}getGlobalOrStaticVarByName(e,t){if(!t&&this.rttSymbol&&e===this.rttSymbolName)return this.rttSymbol;if(t){const s=x.NormalizePath(t);for(const r of this.staticVars)if(r.name===e&&(r.file===t||r.file===s))return r;return null}for(const t of this.globalVars.concat(this.staticVars))if(t.name===e)return t;return null}loadSymbolsFromGdb(e){return new Promise(((t,s)=>{e.then((()=>r(this,void 0,void 0,(function*(){t(!0)}))),(e=>{s(e)}))}))}static NormalizePath(e){return e?(e="win32"===n.platform()?e.replace(/\//g,"\\"):e.replace(/\\/g,"/"),e=i.normalize(e),"win32"===n.platform()&&(e=e.toLowerCase()),e):e}}t.SymbolTable=x,x.CurrentVersion=1},8179:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BMPServerController=void 0;const r=s(3200),n=s(2361);class i extends n.EventEmitter{constructor(){super(),this.name="BMP",this.portsNeeded=[]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){const e=[`target-select extended-remote ${this.args.BMPGDBSerialPort}`];return"enable"===this.args.powerOverBMP?(e.push('interpreter-exec console "monitor tpwr enable"'),e.push('interpreter-exec console "shell sleep 0.1"')):"disable"===this.args.powerOverBMP&&e.push('interpreter-exec console "monitor tpwr disable"'),"jtag"===this.args.interface?e.push('interpreter-exec console "monitor jtag_scan"'):e.push('interpreter-exec console "monitor swdp_scan"'),e.push(`interpreter-exec console "attach ${this.args.targetId}"`,'interpreter-exec console "set mem inaccessible-by-default off"'),e}launchCommands(){return[...r.genDownloadCommands(this.args,[]),'interpreter-exec console "SoftwareReset"',"enable-pretty-printing"]}attachCommands(){return["enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "SoftwareReset"']}swoAndRTTCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,s=this.args.swoConfig.cpuFrequency,n=Math.floor(s/t)-1,i=[];return i.push("EnableITMAccess",`BaseSWOSetup ${n}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"),i.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),i.map((e=>`interpreter-exec console "${e}"`))}serverExecutable(){return null}allocateRTTPorts(){return Promise.resolve()}serverArguments(){return[]}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new r.SWOConfigureEvent({type:"serial",args:this.args,device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.BMPServerController=i},3200:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SpawnLineReader=t.validateELFHeader=t.sanitizeDevDebug=t.quoteShellCmdLine=t.quoteShellAndCmdChars=t.HrTimer=t.ResettableTimeout=t.ResettableInterval=t.getNonce=t.parseHostPort=t.toStringDecHexOctBin=t.parseHexOrDecInt=t.getAnyFreePort=t.createPortName=t.calculatePortMask=t.RTTServerHelper=t.genDownloadCommands=t.defSymbolFile=t.ChainedEvents=t.TelemetryEvent=t.RTTConfigureEvent=t.BinaryEncoding=t.TextEncoding=t.TerminalInputMode=t.SWOConfigureEvent=t.StoppedEvent=t.GenericCustomEvent=t.NumberFormat=t.CortexDebugKeys=t.ADAPTER_DEBUG_MODE=void 0;const n=s(9955),i=s(2361),o=s(3725),a=s(2159),c=s(2081),h=s(358),u=s(4521);var l,d,p,f,m,g,b;!function(e){e.NONE="none",e.PARSED="parsed",e.BOTH="both",e.RAW="raw",e.VSCODE="vscode"}(l=t.ADAPTER_DEBUG_MODE||(t.ADAPTER_DEBUG_MODE={})),(p=t.CortexDebugKeys||(t.CortexDebugKeys={})).REGISTER_DISPLAY_MODE="registerUseNaturalFormat",p.VARIABLE_DISPLAY_MODE="variableUseNaturalFormat",p.SERVER_LOG_FILE_NAME="dbgServerLogfile",p.DEV_DEBUG_MODE="showDevDebugOutput",(d=t.NumberFormat||(t.NumberFormat={}))[d.Auto=0]="Auto",d[d.Hexadecimal=1]="Hexadecimal",d[d.Decimal=2]="Decimal",d[d.Binary=3]="Binary";class v extends n.Event{constructor(e,t){super("custom-event-"+e,{info:t})}}t.GenericCustomEvent=v;class y extends n.Event{constructor(e,t,s){super("stopped",{reason:e,threadId:t,allThreadsStopped:s})}}t.StoppedEvent=y;class S extends n.Event{constructor(e){super("swo-configure",e)}}t.SWOConfigureEvent=S,(g=t.TerminalInputMode||(t.TerminalInputMode={})).COOKED="cooked",g.RAW="raw",g.RAWECHO="rawecho",g.DISABLED="disabled",(m=t.TextEncoding||(t.TextEncoding={})).UTF8="utf8",m.UTF16LE="utf16le",m.ASCII="ascii",m.UCS2="ucs2",(f=t.BinaryEncoding||(t.BinaryEncoding={})).UNSIGNED="unsigned",f.SIGNED="signed",f.Q1616="Q16.16",f.FLOAT="float";class E extends n.Event{constructor(e){super("rtt-configure",e)}}t.RTTConfigureEvent=E;class x extends n.Event{constructor(e,t,s,r={}){super("record-event",{category:e,action:t,label:s,parameters:r})}}function w(e){const t=/[\s\"\*\[\]!@#$%^&*\(\)\\:]/g.test(e)?'"':"";return t+(e=e.replace(/"/g,'\\"').replace(/\\/g,"\\\\")).replace(/"/g,'\\"')+t}t.TelemetryEvent=x,(b=t.ChainedEvents||(t.ChainedEvents={})).POSTSTART="postStart",b.POSTINIT="postInit",t.defSymbolFile=function(e){return{file:e,sections:[],sectionMap:{}}},t.genDownloadCommands=function(e,t){if(Array.isArray(null==e?void 0:e.loadFiles)){if(0===e.loadFiles.length)return[];{const s=[...t];for(const t of e.loadFiles){const e=t.replace("\\","/");s.push(`file-exec-file "${e}"`,"target-download")}return s}}return[...t,"target-download"]},t.RTTServerHelper=class{constructor(){this.rttLocalPortMap={},this.allocDone=!1}allocateRTTPorts(e,t=6e4){if(this.allocDone=!0,!e||!e.enabled||!e.decoders||0===e.decoders.length)return Promise.resolve();const s="??";for(const t of e.decoders)if(t.ports&&t.ports.length>0){t.tcpPorts=[];for(const e of t.ports)this.rttLocalPortMap[e]=s}else this.rttLocalPortMap[t.port]=s;const r={min:t,max:t+2e3,retrieve:Object.keys(this.rttLocalPortMap).length,consecutive:!1};return o.TcpPortScanner.findFreePorts(r,a.GDBServer.LOCALHOST).then((t=>{for(const r of e.decoders)if(r.ports&&r.ports.length>0){r.tcpPorts=[];for(const e of r.ports){let n=this.rttLocalPortMap[e];n===s&&(n=t.shift().toString(),this.rttLocalPortMap[e]=n),r.tcpPorts.push(n)}}else{let e=this.rttLocalPortMap[r.port];e===s&&(e=t.shift().toString(),this.rttLocalPortMap[r.port]=e),r.tcpPort=e}}))}emitConfigures(e,t){if(e.enabled)for(const s of e.decoders)(s.tcpPort||s.tcpPorts)&&t.emit("event",new E({type:"socket",decoder:s}))}},t.calculatePortMask=function(e){if(!e)return 0;let t=0;return e.forEach((e=>{if("advanced"===e.type)for(const s of e.ports)t=(t|1<<s)>>>0;else t=(t|1<<e.port)>>>0})),t},t.createPortName=function(e,t="gdbPort"){return t+(0===e?"":e.toString())},t.getAnyFreePort=function(e){return new Promise(((t,s)=>r(this,void 0,void 0,(function*(){function r(){o.TcpPortScanner.findFreePorts({min:6e4,max:62e3,retrieve:1,consecutive:!1},a.GDBServer.LOCALHOST).then((e=>{t(e[0])})).catch((e=>{s(e)}))}e>0?o.TcpPortScanner.isPortInUseEx(e,a.GDBServer.LOCALHOST,o.TcpPortScanner.AvoidPorts).then((s=>{s?r():(o.TcpPortScanner.EmitAllocated([e]),t(e))})):r()}))))},t.parseHexOrDecInt=function(e){return e.startsWith("0x")?parseInt(e.substring(2),16):parseInt(e,10)},t.toStringDecHexOctBin=function(e){if(Number.isNaN(e))return"NaN: Not a number";if(!Number.isSafeInteger(e))return"Big Num: "+e.toString()+"\nother-radix values not yet available. Sorry";let t=`dec: ${e}`;e<0&&(e=1+~((e=-e)>>>0)>>>0);let s=e.toString(16);s="0x"+"0".repeat(Math.max(0,8-s.length))+s,t+=`\nhex: ${s}`,s=e.toString(8),s="0".repeat(Math.max(0,12-s.length))+s,t+=`\noct: ${s}`,s=e.toString(2),s="0".repeat(Math.max(0,32-s.length))+s;let r="";for(;;){if(s.length<=8){r=s+r;break}r=" "+s.slice(-8)+r,s=s.slice(0,-8)}return t+=`\nbin: ${r}`,t},t.parseHostPort=function(e){let t,s="127.0.0.1";const r=e.match(/(.*)\:([0-9]+)/);return r?(s=r[1]?r[1]:s,t=parseInt(r[2],10)):(e.startsWith(":")&&(e=e.slice(1)),t=parseInt(e,10)),{port:t,host:s}},t.getNonce=function(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let s=0;s<32;s++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},t.ResettableInterval=class{constructor(e,t,s=!1,...r){this.cb=e,this.interval=t,this.args=r,s&&this.cb(...this.args),this.intervalId=setInterval(this.cb,this.interval,...this.args)}kill(){this.isRunning()&&(clearInterval(this.intervalId),this.intervalId=null)}reset(e){this.kill(),void 0!==e&&(this.interval=e),this.intervalId=setInterval(this.cb,this.interval,...this.args)}isRunning(){return null!=this.intervalId}},t.ResettableTimeout=class{constructor(e,t,...s){this.cb=e,this.interval=t,this.timeoutId=null,this.args=s,this.timeoutId=setTimeout(((...e)=>{this.timeoutId=null,this.cb(...this.args)}),this.interval,...this.args)}kill(){this.isRunning()&&(clearTimeout(this.timeoutId),this.timeoutId=null)}reset(e){this.kill(),void 0!==e&&(this.interval=e),this.timeoutId=setTimeout(this.cb,this.interval,...this.args)}isRunning(){return null!==this.timeoutId}},t.HrTimer=class{constructor(){this.start=process.hrtime.bigint()}restart(){this.start=process.hrtime.bigint()}getStart(){return this.start}deltaNs(){return(process.hrtime.bigint()-this.start).toString()}deltaUs(){return this.toStringWithRes(3)}deltaMs(){return this.toStringWithRes(6)}createPaddedMs(e){return this.deltaMs().padStart(e,"0")}createDateTimestamp(){const e=this.createPaddedMs(6);return`[${(new Date).toISOString()}, +${e}ms]`}toStringWithRes(e){let t=(process.hrtime.bigint()-this.start+BigInt(Math.pow(10,e)/2)).toString();return t=t.length<=e?"0":t.substr(0,t.length-e),t}},t.quoteShellAndCmdChars=w,t.quoteShellCmdLine=function(e){return e.map((e=>w(e))).join(" ")},t.sanitizeDevDebug=function(e){const t=Object.values(l);let s=e.showDevDebugOutput;if("string"==typeof s&&(s=s.toLowerCase().trim(),e.showDevDebugOutput=s),!1===s||"false"===s||""===s||"none"===s)delete e.showDevDebugOutput;else if(!0===s||"true)"===s)e.showDevDebugOutput=l.RAW;else if(t.indexOf(s)<0)return e.showDevDebugOutput=l.VSCODE,!1;return!0},t.validateELFHeader=function(e,t){try{if(!h.existsSync(e))return t&&t(`File not found "executable": "${e}"`,!0),!1;const s=Buffer.alloc(16),r=h.openSync(e,"r"),n=h.readSync(r,s,0,16,0);return h.closeSync(r),16!==n?(t&&t(`Could not read 16 bytes from "executable": "${e}"`,!0),!1):127===s[0]&&69===s[1]&&76===s[2]&&70===s[3]||(t&&t(`Not a valid ELF file "executable": "${e}". Many debug functions may not work`,!1),!1)}catch(s){return t&&t(`Could not read file "executable": "${e}" ${s?s.toString():""}`,!0),!1}};class R extends i.EventEmitter{constructor(){super()}startWithProgram(e,t=[],s={},r=null){if(this.promise)throw new Error("SpawnLineReader: can't reuse this object");return this.callback=r,this.promise=new Promise((r=>{try{const n=c.spawn(e,t,s);n.on("error",(e=>{this.emit("error",e),r(!1)})),n.on("exit",((e,t)=>{this.emit("exit",e,t)})),this.doReadline(n.stdout,r)}catch(e){this.emit("error",e)}})),this.promise}startWithStream(e,t=null){if(this.promise)throw new Error("SpawnLineReader: can't reuse this object");return this.callback=t,this.promise=new Promise((t=>{this.doReadline(e,t)})),this.promise}startWithFile(e,t=null,s=null){if(this.promise)throw new Error("SpawnLineReader: can't reuse this object");return this.callback=s,this.promise=new Promise((s=>{const r=h.createReadStream(e,t||{flags:"r"});r.on("error",(e=>{this.emit("error",e),s(!1)})),r.on("open",(()=>{this.doReadline(r,s)}))})),this.promise}doReadline(e,t){try{const s=u.createInterface({input:e,crlfDelay:1/0,console:!1});s.on("line",(e=>{this.callback?this.callback(e)||s.close():this.emit("line",e)})),s.once("close",(()=>{this.callback&&this.callback(null),e.destroy(),this.emit("close"),t(!0)}))}catch(e){this.emit("error",e)}}}t.SpawnLineReader=R},8962:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalServerController=void 0;const r=s(3200),n=s(2037),i=s(6276),o=s(2361),a=s(2081);class c extends o.EventEmitter{constructor(){super(),this.name="External",this.portsNeeded=[],this.swoPath=i.tmpNameSync()}setPorts(e){this.ports=e}setArguments(e){this.args=e,this.args.swoConfig.enabled&&"win32"===n.platform()&&(this.swoPath=this.swoPath.replace(/\\/g,"/"))}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote ${this.args.gdbTarget}`]}launchCommands(){return[...r.genDownloadCommands(this.args,['interpreter-exec console "monitor reset halt"']),'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}swoAndRTTCommands(){return[]}restartCommands(){return['interpreter-exec console "monitor reset halt"']}serverExecutable(){return null}allocateRTTPorts(){return Promise.resolve()}serverArguments(){return[]}initMatch(){return null}serverLaunchStarted(){this.args.swoConfig.enabled&&"probe"===this.args.swoConfig.source&&"win32"!==n.platform()&&(a.spawnSync("mkfifo",[this.swoPath]),this.emit("event",new r.SWOConfigureEvent({type:"fifo",args:this.args,path:this.swoPath})))}serverLaunchCompleted(){this.args.swoConfig.enabled&&("probe"===this.args.swoConfig.source&&"win32"===n.platform()?this.emit("event",new r.SWOConfigureEvent({type:"file",args:this.args,path:this.swoPath})):"socket"===this.args.swoConfig.source?this.emit("event",new r.SWOConfigureEvent({type:"socket",args:this.args,port:this.args.swoConfig.swoPort})):"file"===this.args.swoConfig.source?this.emit("event",new r.SWOConfigureEvent({type:"file",args:this.args,path:this.args.swoConfig.swoPath})):"serial"===this.args.swoConfig.source&&this.emit("event",new r.SWOConfigureEvent({type:"serial",args:this.args,device:this.args.swoConfig.swoPath,baudRate:this.args.swoConfig.swoFrequency})))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.ExternalServerController=c},530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.magentaFormat=t.greenFormat=t.BR_GREEN_FG=t.BR_MAGENTA_FG=t.RESET=t.BOLD=t.CSI=t.ESC=void 0,t.ESC="",t.CSI=t.ESC+"[",t.BOLD=t.CSI+"1m",t.RESET=t.CSI+"0m",t.BR_MAGENTA_FG=t.CSI+"95m",t.BR_GREEN_FG=t.CSI+"92m",t.greenFormat=function(e){return t.BR_GREEN_FG+e+t.RESET},t.magentaFormat=function(e){return t.BR_MAGENTA_FG+e+t.RESET}},2942:(e,t)=>{"use strict";function s(e,t){let s=0;const r=e+t-1;for(let t=e;t<=r;t++)s=(s|1<<t)>>>0;return s}function r(e){return/^0b([01]+)$/i.test(e)?parseInt(e.substring(2),2):/^0x([0-9a-f]+)$/i.test(e)?parseInt(e.substring(2),16):/^[0-9]+/i.test(e)?parseInt(e,10):/^#[0-1]+/i.test(e)?parseInt(e.substring(1),2):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.parseDimIndex=t.parseInteger=t.extractBits=t.createMask=t.binaryFormat=t.hexFormat=void 0,t.hexFormat=function(e,t=8,s=!0){let r=(e>>>0).toString(16);return r=r.padStart(t,"0"),s?"0x"+r:r},t.binaryFormat=function(e,t=0,s=!0,r=!1){let n=(e>>>0).toString(2);for(;n.length<t;)n="0"+n;if(r){const e=4-n.length%4;for(let t=0;t<e;t++)n="0"+n;const t=n.match(/[01]{4}/g);n=t.join(" "),n=n.substring(e)}return s?"0b"+n:n},t.createMask=s,t.extractBits=function(e,t,r){return(e&s(t,r))>>>t>>>0},t.parseInteger=r,t.parseDimIndex=function(e,t){if(-1!==e.indexOf(",")){const s=e.split(",").map((e=>e.trim()));if(s.length!==t)throw new Error("dimIndex Element has invalid specification.");return s}if(/^([0-9]+)\-([0-9]+)$/i.test(e)){const s=e.split("-").map((e=>r(e))),n=s[0];if(s[1]-n+1<t)throw new Error("dimIndex Element has invalid specification.");const i=[];for(let e=0;e<t;e++)i.push(`${n+e}`);return i}if(/^[a-zA-Z]\-[a-zA-Z]$/.test(e)){const s=e.charCodeAt(0);if(e.charCodeAt(2)-s+1<t)throw new Error("dimIndex Element has invalid specification.");const r=[];for(let e=0;e<t;e++)r.push(String.fromCharCode(s+e));return r}return[]}},121:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GDBDebugSession=void 0;const n=s(9955),i=s(1922),o=s(2942),a=s(5585),c=s(3200),h=s(2159),u=s(9074),l=s(548),d=s(7582),p=s(2037),f=s(1017),m=s(358),g=s(6478),b=s(6113),v=s(9512),y=s(2361),S=s(7391),E=s(2073),x=s(6856),w=s(2057),R=s(7266),_=s(8179),C=s(7880),k=s(1317),O=s(8962),P=s(6434),T=s(565),M=s(3725),I={jlink:S.JLinkServerController,openocd:E.OpenOCDServerController,stutil:x.STUtilServerController,stlink:w.STLinkServerController,pyocd:R.PyOCDServerController,pe:C.PEServerController,bmp:_.BMPServerController,qemu:k.QEMUServerController,external:O.ExternalServerController};var D;!function(e){e.LAUNCH="entry",e.ATTACH="attach",e.RESTART="restart",e.RESET="reset"}(D||(D={}));class A{constructor(e,t){this.name=e,this.options=t}}const N=65535,$=65536,L=131072,F=196607,j=196608;function q(e){return e=e.trim(),["continue","c","cont"].find((t=>t===e))?"exec-continue --all":e.startsWith("-")?e.substring(1):`interpreter-exec console "${e.replace(/"/g,'\\"')}"`}let B=0;class G extends n.Event{constructor(e,t){super("custom-stop",{reason:e,threadID:t}),console.log(`${B} **** Stopped reason:${e} thread:${t}`),B++}}class V{constructor(e,t){this.shouldContinue=e,this.haveMore=t}}class H{constructor(e,t,s,r,n){this.functor=e,this.response=t,this.args=s,this.resolve=r,this.reject=n}}class U{constructor(e=!0){this.alwaysResolve=e,this.queue=[],this.queueBusy=!1,this.pendedContinue=new V(!1,this.haveMore.bind(this))}add(e,t,s){return new Promise(((n,i)=>r(this,void 0,void 0,(function*(){for(this.queue.push(new H(e,t,s,n,i));!this.queueBusy&&this.queue.length>0;){this.queueBusy=!0;const e=this.queue.shift();try{yield e.functor(e.response,e.args,this.pendedContinue),e.resolve()}catch(t){this.alwaysResolve?e.resolve():e.reject(t)}this.queueBusy=!1}}))))}haveMore(){return this.queue.length>0}}class W extends n.Event{constructor(e,t=!0){super("custom-continued",{threadID:e,allThreads:t}),console.log(`${B} **** Running thread:${e}`),B++}}class z extends n.LoggingDebugSession{constructor(e,t=!1,s=1){super(void 0,e,t),this.isServer=t,this.usingParentServer=!1,this.variableHandles=new n.Handles(j),this.variableHandlesReverse={},this.forceDisassembly=!1,this.activeEditorPath=null,this.currentThreadId=0,this.activeThreadIds=new Set,this.disableSendStoppedEvents=!1,this.stopped=!1,this.stoppedReason="",this.continuing=!1,this.stoppedThreadId=0,this.functionBreakpoints=[],this.breakpointMap=new Map,this.breakpointById=new Map,this.instrBreakpointMap=new Map,this.dataBreakpointMap=new Map,this.fileExistsCache=new Map,this.onInternalEvents=new y.EventEmitter,this.suppressRadixMsgs=!1,this.dbgSymbolTable=null,this.errResponseSent=!1,this.disconnectingPromise=void 0,this.sendDummyStackTrace=!1,this.timeStart=Date.now(),this.functionBreakPointsQ=new U,this.pendingBkptResponse=!1,this.registerMap=new Map,this.registerMapReverse=new Map,this.floatingVariableMap={},this.evaluateQ=new U,M.TcpPortScanner.PortAllocated.on("allocated",(e=>{this.sendEvent(new c.GenericCustomEvent("ports-allocated",e))}))}sendErrorResponsePub(e,t,s,r,n){this.sendErrorResponse(e,t,s,r,n)}initDebugger(){this.miDebugger.on("quit",this.quitEvent.bind(this)),this.miDebugger.on("exited-normally",this.quitEvent.bind(this)),this.miDebugger.on("stopped",this.stopEvent.bind(this)),this.miDebugger.on("msg",this.handleMsg.bind(this)),this.miDebugger.on("breakpoint",this.handleBreakpoint.bind(this)),this.miDebugger.on("watchpoint",this.handleWatchpoint.bind(this,"hit")),this.miDebugger.on("watchpoint-scope",this.handleWatchpoint.bind(this,"scope")),this.miDebugger.on("step-end",this.handleBreak.bind(this)),this.miDebugger.on("step-out-end",this.handleBreak.bind(this)),this.miDebugger.on("signal-stop",this.handlePause.bind(this)),this.miDebugger.on("running",this.handleRunning.bind(this)),this.miDebugger.on("continue-failed",this.handleContinueFailed.bind(this)),this.miDebugger.on("thread-created",this.handleThreadCreated.bind(this)),this.miDebugger.on("thread-exited",this.handleThreadExited.bind(this)),this.miDebugger.on("thread-selected",this.handleThreadSelected.bind(this)),this.miDebugger.on("thread-group-exited",this.handleThreadGroupExited.bind(this))}initializeRequest(e,t){e.body.supportsHitConditionalBreakpoints=!0,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsConditionalBreakpoints=!0,e.body.supportsLogPoints=!0,e.body.supportsFunctionBreakpoints=!0,e.body.supportsEvaluateForHovers=!0,e.body.supportsSetVariable=!0,e.body.supportsRestartRequest=!0,e.body.supportsGotoTargetsRequest=!0,e.body.supportSuspendDebuggee=!0,e.body.supportTerminateDebuggee=!0,e.body.supportsDataBreakpoints=!0,e.body.supportsDisassembleRequest=!0,e.body.supportsSteppingGranularity=!0,e.body.supportsInstructionBreakpoints=!0,e.body.supportsReadMemoryRequest=!0,this.sendResponse(e)}setupLogger(e,t){const s=e&&this.origShowDevDebugOutput===c.ADAPTER_DEBUG_MODE.VSCODE?n.Logger.LogLevel.Verbose:n.Logger.LogLevel.Stop,r=e&&this.origShowDevDebugOutput===c.ADAPTER_DEBUG_MODE.VSCODE&&t.showDevDebugTimestamps;n.logger.setup(s,!1,r)}launchAttachInit(e){this.origShowDevDebugOutput=e.showDevDebugOutput,this.setupLogger(!0,e),e.showDevDebugOutput===c.ADAPTER_DEBUG_MODE.VSCODE&&(e.showDevDebugOutput=c.ADAPTER_DEBUG_MODE.RAW),this.args=this.normalizeArguments(e),this.handleMsg("stdout",`Cortex-Debug: VSCode debugger extension version ${e.pvtVersion} git(be7d3c8+dirty). Usaage info: https://github.com/Marus/cortex-debug#usage`),this.origShowDevDebugOutput===c.ADAPTER_DEBUG_MODE.VSCODE&&this.handleMsg("log",'"configuration": '+JSON.stringify(e,void 0,4)+"\n"),M.TcpPortScanner.AvoidPorts.clear();for(const t of e.pvtAvoidPorts||[])for(let e=0;e<4;e++)M.TcpPortScanner.AvoidPorts.add(t+e)}loadSymbols(){return new Promise((e=>{const t=this.args.symbolFiles||[c.defSymbolFile(this.args.executable)];this.symbolTable=new P.SymbolTable(this,t),this.symbolTable.loadSymbols().then((()=>{if(this.args.rttConfig.enabled){const e=this.symbolTable.rttSymbolName;if(this.args.rttConfig.address||(this.handleMsg("stderr",'INFO: "rttConfig.address" not specified. Defaulting to "auto"\n'),this.args.rttConfig.address="auto"),"auto"===this.args.rttConfig.address){const t=this.symbolTable.getGlobalOrStaticVarByName(e);if(t){const e=this.args.rttConfig.searchId||"SEGGER RTT";this.args.rttConfig.address=o.hexFormat(t.address),this.args.rttConfig.searchSize=Math.max(this.args.rttConfig.searchSize||0,e.length),this.args.rttConfig.searchId=e,this.args.rttConfig.clearSearch=void 0===this.args.rttConfig.clearSearch||this.args.rttConfig.clearSearch}else this.args.rttConfig.enabled=!1,this.handleMsg("stderr",`Could not find symbol '${e}' in executable. Make sure you compile/link with debug ON or you can specify your own RTT address\n`)}}e()}),(t=>{this.handleMsg("log",`WARNING: Loading symbols failed. Please report this issue. Debugging may still work ${t}\n`),e()}))}))}dbgSymbolStuff(e,t,s,n){return r(this,void 0,void 0,(function*(){if("hdm"===p.userInfo().username){this.handleMsg("log",`Reading symbols from ${t}\n`);const e=new P.SymbolTable(this,[c.defSymbolFile(t)]);this.dbgSymbolTable=e,yield e.loadSymbols(),e.printToFile(t+".cd-dump");let r=e.getFunctionByName(s,n);console.log(r),r=e.getFunctionByName("memset"),console.log(r),this.handleMsg("log","Finished Reading symbols\n");const i=e.getFunctionSymbols().filter((e=>e.name===s));console.log(i)}}))}launchRequest(e,t){this.launchAttachInit(t),this.processLaunchAttachRequest(e,!1)}attachRequest(e,t){this.launchAttachInit(t),this.processLaunchAttachRequest(e,!0)}normalizeArguments(e){if(e.graphConfig=e.graphConfig||[],e.executable&&!f.isAbsolute(e.executable)&&(e.executable=f.normalize(f.join(e.cwd,e.executable))),e.svdFile&&!f.isAbsolute(e.svdFile)&&(e.svdFile=f.normalize(f.join(e.cwd,e.svdFile))),e.swoConfig&&e.swoConfig.decoders&&(e.swoConfig.decoders=e.swoConfig.decoders.map((t=>("advanced"===t.type&&t.decoder&&!f.isAbsolute(t.decoder)&&(t.decoder=f.normalize(f.join(e.cwd,t.decoder))),t)))),e.rttConfig&&e.rttConfig.decoders&&(e.rttConfig.decoders=e.rttConfig.decoders.map((t=>("advanced"===t.type&&t.decoder&&!f.isAbsolute(t.decoder)&&(t.decoder=f.normalize(f.join(e.cwd,t.decoder))),t)))),e.chainedConfigurations&&e.chainedConfigurations.enabled&&e.chainedConfigurations.launches)for(const t of e.chainedConfigurations.launches){let s=t.folder||e.cwd||process.cwd();for(f.isAbsolute(s)||(s=f.join(e.cwd||process.cwd(),s)),s=f.normalize(s).replace("\\","/");s.length>1&&s.endsWith("/")&&!s.endsWith(":/");)s=s.substring(0,s.length-1);t.folder=s}return e}getTCPPorts(e){return new Promise(((t,s)=>{if(e)return this.ports=this.args.pvtPorts=this.args.pvtParent.pvtPorts,this.serverController.setPorts(this.ports),this.args.showDevDebugOutput&&this.handleMsg("log",JSON.stringify({configFromParent:this.args.pvtMyConfigFromParent},void 0,4)+"\n"),t();const r={min:5e4,max:52e3,retrieve:this.calculatePortsNeeded(),consecutive:!0};M.TcpPortScanner.findFreePorts(r,h.GDBServer.LOCALHOST).then((e=>{this.createPortsMap(e),this.serverController.setPorts(this.ports),t()}),(e=>{s(e)}))}))}processLaunchAttachRequest(e,t){return new Promise((s=>{const i=()=>{s&&(s(),s=null)};if(!m.existsSync(this.args.executable))return this.sendErrorResponse(e,103,`Unable to find executable file at ${this.args.executable}.`),i();const o=I[this.args.servertype];if(this.serverController=new o,this.serverController.setArguments(this.args),this.serverController.on("event",this.serverControllerEvent.bind(this)),this.quit=!1,this.attached=!1,this.started=!1,this.debugReady=!1,this.stopped=!1,this.continuing=!1,this.activeThreadIds.clear(),this.disassember=new d.GdbDisassembler(this,this.args),this.serverConsoleLog(`******* Starting new session request type="${this.args.request}"`),!this.getGdbPath(e))return i();const a=this.loadSymbols(),u=this.startGdb(e);this.usingParentServer=this.args.pvtMyConfigFromParent&&!this.args.pvtMyConfigFromParent.detached,this.getTCPPorts(this.usingParentServer).then((()=>r(this,void 0,void 0,(function*(){yield this.serverController.allocateRTTPorts();const s=this.usingParentServer?null:this.serverController.serverExecutable(),o=this.usingParentServer?[]:this.serverController.serverArguments();this.sendEvent(new c.GenericCustomEvent("ports-done",void 0));const l=this.getServerCwd(s);s&&(this.handleMsg("log","Launching gdb-server: "+c.quoteShellCmdLine([s,...o])+"\n"),this.handleMsg("stdout",`    Please check TERMINAL tab (gdb-server) for output from ${s}\n`));const d=this.args.gdbServerConsolePort,p=this.ports[c.createPortName(this.args.targetProcessor)];let f=null;if(!this.usingParentServer&&(f=this.serverController.initMatch(),this.args.overrideGDBServerStartedRegex&&(f=new RegExp(this.args.overrideGDBServerStartedRegex,"i")),void 0===d))return this.launchErrorResponse(e,107,"GDB Server Console tcp port is undefined."),i();this.server=new h.GDBServer(l,s,o,f,p,d),this.server.on("exit",(()=>{this.started?this.serverQuitEvent():(this.launchErrorResponse(e,103,`${this.serverController.name}: GDB Server Quit Unexpectedly. See gdb-server output for more details.`),i())})),this.server.on("launcherror",(t=>{this.launchErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: ${t}`),i()}));let m=v.setTimeout((()=>{this.server.exit(),this.sendEvent(new c.TelemetryEvent("Error","Launching Server",`Failed to launch ${this.serverController.name} GDB Server: Timeout.`)),this.launchErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: Timeout.`),i()}),h.GDBServer.SERVER_TIMEOUT);this.serverController.serverLaunchStarted(),this.server.init().then((s=>r(this,void 0,void 0,(function*(){m&&(clearTimeout(m),m=null);const s=[`interpreter-exec console "source ${this.args.extensionPath}/support/gdbsupport.init"`,`interpreter-exec console "source ${this.args.extensionPath}/support/gdb-swo.init"`];try{const e=this.args.showDevDebugOutput&&this.args.showDevDebugTimestamps;if(yield u,e&&this.handleMsg("log","Debug Time: GDB Ready...\n"),yield this.serverController.serverLaunchCompleted(),e&&this.handleMsg("log","Debug Time: GDB Server post start events done...\n"),yield a,e&&this.handleMsg("log","Debug Time: objdump and nm done...\n"),e&&this.handleMsg("log","Debug Time: All pending items done, proceed to gdb connect...\n"),this.sendEvent(new c.GenericCustomEvent("post-start-server",this.args)),this.args.variableUseNaturalFormat||s.push(...this.formatRadixGdbCommand()),s.push(...this.serverController.initCommands()),t){s.push(...this.args.preAttachCommands.map(q));const e=null!=this.args.overrideAttachCommands?this.args.overrideAttachCommands.map(q):this.serverController.attachCommands();s.push(...e),s.push(...this.args.postAttachCommands.map(q))}else{s.push(...this.args.preLaunchCommands.map(q));const e=null!=this.args.overrideLaunchCommands?this.args.overrideLaunchCommands.map(q):this.serverController.launchCommands();s.push(...e),s.push(...this.args.postLaunchCommands.map(q))}}catch(t){const s=t.toString()+"\n"+t.stack.toString();return this.sendEvent(new c.TelemetryEvent("Error","Launching GDB",`Failed to generate gdb commands: ${s}`)),this.launchErrorResponse(e,104,`Failed to generate gdb commands: ${s}`),i()}this.serverController.debuggerLaunchStarted(),this.miDebugger.once("debug-ready",(()=>{this.debugReady=!0,this.attached=t})),this.disableSendStoppedEvents=!0,this.sendDummyStackTrace=!(t||!this.args.runToEntryPoint&&this.args.breakAfterReset),this.miDebugger.connect(s).then((()=>r(this,void 0,void 0,(function*(){const s=t?D.ATTACH:D.LAUNCH;this.started=!0,this.serverController.debuggerLaunchCompleted(),this.sendEvent(new n.InitializedEvent),this.sendEvent(new c.GenericCustomEvent("post-start-gdb",this.args)),this.onInternalEvents.once("config-done",(()=>r(this,void 0,void 0,(function*(){yield new Promise((e=>v.setTimeout((()=>{this.startComplete(s),e()}),100))),this.sendDummyStackTrace?this.onInternalEvents.once("stack-trace-request",(()=>{this.sendDummyStackTrace=!1,this.finishStartSequence(s)})):v.setTimeout((()=>this.finishStartSequence(s)),100)})))),this.sendResponse(e),i()}))),(t=>{this.launchErrorResponse(e,103,`Failed to launch GDB: ${t.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Launching GDB",t.toString()));try{this.miDebugger.stop(),this.server.exit()}finally{i()}}))}))),(t=>{m&&(clearTimeout(m),m=null),this.sendEvent(new c.TelemetryEvent("Error","Launching Server",`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`)),this.launchErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`),i(),this.server.exit()}))}))),(t=>{this.sendEvent(new c.TelemetryEvent("Error","Launching Server",`Failed to find open ports: ${t.toString()}`)),this.launchErrorResponse(e,103,`Failed to find open ports: ${t.toString()}`),i()}))}))}launchErrorResponse(e,t,s){this.handleMsg("stderr",`Error ${t}: `+s.endsWith("\n")?s:s+"\n"),this.errResponseSent||(this.errResponseSent=!0,this.sendErrorResponse(e,t,s))}getServerCwd(e){let t=this.args.cwd||process.cwd();return this.args.serverCwd?t=this.args.serverCwd:"stlink"===this.args.servertype&&(t=f.dirname(e)||".","."!==t&&this.handleMsg("log",`Setting GDB-SErver CWD: ${t}\n`)),t}notifyStopped(e=!0){this.sendEvent(new c.StoppedEvent(this.stoppedReason,this.currentThreadId,!0)),e&&this.sendEvent(new G(this.stoppedReason,this.currentThreadId))}startCompleteForReset(e,t=!0){e!==D.ATTACH&&e!==D.LAUNCH&&this.startComplete(e,t)}startComplete(e,t=!0){this.disableSendStoppedEvents=!1,this.pendingBkptResponse=!1,this.continuing=!1,this.stopped="running"!==this.miDebugger.status,t&&!this.args.noDebug&&this.stopped&&(this.stoppedReason=e,this.stoppedThreadId=this.currentThreadId,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.notifyStopped())}finishStartSequence(e){return new Promise((t=>r(this,void 0,void 0,(function*(){try{if(e===D.ATTACH||e===D.LAUNCH){const e=this.serverController.swoAndRTTCommands();for(const t of e)yield this.miDebugger.sendCommand(t)}}catch(e){const t=`SWO/RTT Initialization failed: ${e}`;this.handleMsg("stderr",t),this.sendEvent(new c.GenericCustomEvent("popup",{type:"error",message:t}))}!this.args.noDebug&&e!==D.ATTACH&&this.args.runToEntryPoint?this.miDebugger.sendCommand(`break-insert -t --function ${this.args.runToEntryPoint}`).then((()=>{this.miDebugger.once("generic-stopped",(()=>{t()})),this.startCompleteForReset(e,!1),this.sendContinue()}),(s=>{this.handleMsg("log",`launch.json: Unable to set temporary breakpoint "runToEntryPoint":"${this.args.runToEntryPoint}".Function may not exist or out of breakpoints? `+s.toString()+"\n"),e===D.LAUNCH&&(this.args.runToEntryPoint=""),this.startComplete(e),t()})):this.runPostStartSessionCommands(e).then((s=>{s||this.startCompleteForReset(e,!0),t()}),(e=>{console.log(e),t()}))}))))}getGdbPath(e){let t="win32"!==p.platform()?`${this.args.toolchainPrefix}-gdb`:`${this.args.toolchainPrefix}-gdb.exe`;this.args.toolchainPath&&(t=f.normalize(f.join(this.args.toolchainPath,t)));const s=`GDB executable "${t}" was not found.\nPlease configure "cortex-debug.armToolchainPath" or "cortex-debug.gdbPath" correctly.`;if(this.args.gdbPath)t=this.args.gdbPath;else if(f.isAbsolute(t)){if(!1===m.existsSync(t))return this.launchErrorResponse(e,103,s),null}else if(!g.sync(t.replace(".exe","")))return this.launchErrorResponse(e,103,s),null;return this.args.gdbPath=t,t}startGdb(e){const t=this.args.gdbPath,s=["-q","--interpreter=mi2"].concat(this.args.debuggerArgs||[]);this.args.symbolFiles||(f.isAbsolute(this.args.executable)||(this.args.executable=f.join(this.args.cwd,this.args.executable)),s.push(this.args.executable));const r="Launching GDB: "+c.quoteShellCmdLine([t,...s])+"\n";if(this.handleMsg("log",r),this.args.showDevDebugOutput||this.handleMsg("stdout",'    IMPORTANT: Set "showDevDebugOutput": "raw" in "launch.json" to see verbose GDB transactions here. Very helpful to debug issues or report problems\n'),this.args.showDevDebugOutput&&this.args.chainedConfigurations&&this.args.chainedConfigurations.enabled){const e=JSON.stringify({chainedConfigurations:this.args.chainedConfigurations},null,4);this.handleMsg("log",e+"\n")}this.miDebugger=new i.MI2(t,s),this.miDebugger.debugOutput=this.args.showDevDebugOutput,this.miDebugger.on("launcherror",(t=>{const s="Could not start GDB process, does the program exist in filesystem?\n"+t.toString()+"\n";this.launchErrorResponse(e,103,s),this.quitEvent()})),this.initDebugger();const n=['interpreter-exec console "set print demangle on"','interpreter-exec console "set print asm-demangle on"'];if(this.args.symbolFiles){for(const e of this.args.symbolFiles){let t=`interpreter-exec console "add-symbol-file \\"${e.file}\\""`;t+=e.offset?` -o ${o.hexFormat(e.offset)}"`:"",t+="number"==typeof e.textaddress?` ${o.hexFormat(e.textaddress)}"`:"";for(const s of e.sections)t+=` -s ${s.name} ${s.address}`;n.push(t)}0===n.length&&this.handleMsg("log",'Info: GDB may not start since there were no files with symbols in "symbolFiles?\n')}return this.miDebugger.start(this.args.cwd,n)}sendContinue(){return new Promise((e=>{this.continuing=!0,this.miDebugger.sendCommand("exec-continue --all").then((t=>{e()}),(t=>{console.error("Not expecting continue to fail. "+t),this.continuing=!1,e()}))}))}calculatePortsNeeded(){const e=this.serverController.portsNeeded.length,t=Math.max(this.args.numberOfProcessors||1,1);let s=this.args.targetProcessor||0;(s<0||s>=t)&&(s=s<0?0:t-1,this.handleMsg("log",`launch.json: 'targetProcessor' must be >= 0 && < 'numberOfProcessors'. Setting it to ${s}\n`),s=t-1);const r=e*t;return this.args.numberOfProcessors=t,this.args.targetProcessor=s,r}createPortsMap(e){const t=this.args.numberOfProcessors;this.ports={};let s=0;for(const r of this.serverController.portsNeeded)for(let n=0;n<t;n++){const t=c.createPortName(n,r);this.ports[t]=e[s++]}this.args.pvtPorts=this.ports}isMIStatusStopped(){return"running"!==this.miDebugger.status}runPostStartSessionCommands(e,t=100){let s=[],n=!1;switch(e){case D.RESTART:case D.RESET:s=this.args.postRestartSessionCommands||[];break;default:s=this.args.postStartSessionCommands||[]}return e!==D.ATTACH&&this.args.noDebug?n=!0:this.args.breakAfterReset||e===D.ATTACH||0!==s.length||(n=!0),new Promise(((t,i)=>{const o=()=>r(this,void 0,void 0,(function*(){this.args.noDebug||n&&this.isMIStatusStopped()?(e===D.RESET||e===D.RESTART?(this.sendDummyStackTrace=!0,this.onInternalEvents.once("stack-trace-request",(()=>{this.sendDummyStackTrace=!1,this.sendContinue()})),this.startComplete(e)):this.sendContinue(),t(!0)):t(!this.isMIStatusStopped())}));s.length>0||n?(s=s.map(q),this.miDebugger.postStart(s).then((()=>{o()}),(e=>{const t=`Error running post start/restart/reset commands ${e}`;this.sendEvent(new c.GenericCustomEvent("popup",{type:"error",message:t})),o()}))):t(!1)}))}serverConsoleLog(e){const t=this.miDebugger&&this.miDebugger.pid>0?this.miDebugger.pid:process.pid;h.ServerConsoleLog(`${this.args.name}: `+e,t)}customRequest(e,t,s){return r(this,void 0,void 0,(function*(){const r=()=>{this.sendErrorResponse(t,110,`Custom request ${e} cannot be run now, because debugger is busy}`,void 0,n.ErrorDestination.Telemetry)};if(this.serverController.customRequest(e,t,s))return r();const i=!this.stopped||this.continuing||!this.isMIStatusStopped();switch(e){case"set-force-disassembly":t.body={success:!0},this.forceDisassembly=s.force,this.stopped&&(this.activeEditorPath=null,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new c.StoppedEvent(this.stoppedReason,this.currentThreadId,!0))),this.sendResponse(t);break;case"load-function-symbols":t.body={functionSymbols:this.symbolTable.getFunctionSymbols()},this.sendResponse(t);break;case"set-active-editor":s.path!==this.activeEditorPath&&(this.activeEditorPath=s.path),t.body={},this.sendResponse(t);break;case"get-arguments":t.body=this.args,this.sendResponse(t);break;case"read-memory":if(i)return r();this.readMemoryRequestCustom(t,s.address,s.length);break;case"write-memory":if(i)return r();this.writeMemoryRequestCustom(t,s.address,s.data);break;case"set-var-format":this.args.variableUseNaturalFormat=!s||!s.hex,this.setGdbOutputRadix();break;case"read-registers":if(i||this.sendDummyStackTrace)return r();this.args.registerUseNaturalFormat=!s||!s.hex,this.readRegistersRequest(t);break;case"read-register-list":this.readRegisterListRequest(t);break;case"disassemble":this.disassember.customDisassembleRequest(t,s);break;case"execute-command":let o=s.command;o=o.startsWith("-")?o.substring(1):`interpreter-exec console "${o}"`,this.miDebugger.sendCommand(o).then((e=>{t.body=e.resultRecords,this.sendResponse(t)}),(e=>{t.body=e,this.sendErrorResponse(t,110,"Unable to execute command")}));break;case"reset-device":this.resetDevice(t,s);break;case"custom-stop-debugging":this.serverConsoleLog(`Got request ${e}`),yield this.disconnectRequest2(t,s);break;case"notified-children-to-terminate":this.serverConsoleLog(`Got request ${e}`),this.emit("children-terminating"),this.sendResponse(t);break;default:t.body={error:"Invalid command."},this.sendResponse(t)}}))}setGdbOutputRadix(){return r(this,void 0,void 0,(function*(){for(const e of this.formatRadixGdbCommand())try{yield this.miDebugger.sendCommand(e)}catch(e){}this.stopped&&this.sendEvent(new c.StoppedEvent(this.stoppedReason,this.currentThreadId,!0))}))}formatRadixGdbCommand(e=null){return[`interpreter-exec console "set output-radix ${e||(this.args.variableUseNaturalFormat?"0xa":"0x10")}"`,'interpreter-exec console "set input-radix 0xa"']}disassembleRequest(e,t,s){this.disassember.disassembleProtocolRequest(e,t,s)}readMemoryRequest(e,t,s){const r=parseInt(t.memoryReference),n=t.count,a=o.hexFormat(r+(t.offset||0));if(e.body={address:a,data:""},0===n)return void this.sendResponse(e);const h=`data-read-memory-bytes "${a}" ${n}`;this.miDebugger.sendCommand(h).then((t=>{const s=i.parseReadMemResults(t),r=s.data.length/2,n=new Uint8Array(r),o=s.data;for(let e=0,t=0;e<r;e++,t+=2){const s=o[t]+o[t+1];n[e]=K[s]}const a=Buffer.from(n).toString("base64");e.body.data=a,this.sendResponse(e)}),(t=>{this.sendErrorResponse(e,114,`Read memory error: ${t.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Reading Memory",h))}))}readMemoryRequestCustom(e,t,s){this.miDebugger.sendCommand(`data-read-memory-bytes "${t}" ${s}`).then((t=>{const s=i.parseReadMemResults(t),r=[],n=s.data.length/2,o=s.data;for(let e=0,t=0;e<n;e++,t+=2){const e=o[t]+o[t+1];r.push(K[e])}e.body={startAddress:s.startAddress,endAddress:s.endAddress,bytes:r},this.sendResponse(e)}),(r=>{e.body={error:r},this.sendErrorResponse(e,114,`Read memory error: ${r.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Reading Memory",`${t}-${s.toString(16)}`))}))}writeMemoryRequestCustom(e,t,s){const r=o.hexFormat(t,8);this.miDebugger.sendCommand(`data-write-memory-bytes ${r} ${s}`).then((t=>{this.sendResponse(e)}),(r=>{e.body={error:r},this.sendErrorResponse(e,114,`Write memory error: ${r.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Writing Memory",`${t.toString(16)}-${s.length.toString(16)}`))}))}readRegistersRequest(e){try{if(!this.args.variableUseNaturalFormat){this.suppressRadixMsgs=!0;for(const e of this.formatRadixGdbCommand("0xa"))this.miDebugger.sendCommand(e)}const t=this.args.registerUseNaturalFormat?"N":"x";if(this.miDebugger.sendCommand(`data-list-register-values ${t}`).then((t=>{if("done"===t.resultRecords.resultClass){const s=t.resultRecords.results[0][1];e.body=s.map((e=>{const t={};return e.forEach((e=>{t[e[0]]=e[1]})),t}))}else e.body={error:"Unable to parse response"};this.sendResponse(e)}),(t=>{e.body={error:t},this.sendErrorResponse(e,115,`Unable to read registers: ${t.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Reading Registers",""))})),!this.args.variableUseNaturalFormat){const e=this.formatRadixGdbCommand();for(let t=0;t<e.length;t++)this.miDebugger.sendCommand(e[t]).then((s=>{t===e.length-1&&(this.suppressRadixMsgs=!1)}),(s=>{t===e.length-1&&(this.suppressRadixMsgs=!1)}))}}catch(e){this.suppressRadixMsgs=!1}}readRegisterListRequest(e){this.miDebugger.sendCommand("data-list-register-names").then((t=>{if("done"===t.resultRecords.resultClass){let s;t.resultRecords.results.forEach((e=>{"register-names"===e[0]&&(s=e[1])})),e.body=s}else e.body={error:t.resultRecords.results};this.sendResponse(e)}),(t=>{e.body={error:t},this.sendErrorResponse(e,116,`Unable to read register list: ${t.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Reading Register List",""))}))}waitForServerExitAndRespond(e){if(this.server.isExternal())this.miDebugger.once("quit",(()=>{this.serverConsoleLog("disconnectRequest sendResponse 1"),this.sendResponse(e)}));else{let t=60,s=setInterval((()=>{0===t||this.quit?(clearInterval(s),s=null,this.server.exit(),this.serverConsoleLog("disconnectRequest sendResponse 3"),this.sendResponse(e)):t--}),10);this.server.once("exit",(()=>{s&&(clearInterval(s),s=null,this.serverConsoleLog("disconnectRequest sendResponse 2"),this.sendResponse(e))}))}}disconnectRequest(e,t){var s;return r(this,void 0,void 0,(function*(){return this.disconnectingPromise?(this.serverConsoleLog("Got disconnect request while we are already disconnecting"),yield this.disconnectingPromise,this.sendResponse(e),Promise.resolve()):((null===(s=this.args.chainedConfigurations)||void 0===s?void 0:s.enabled)&&(this.serverConsoleLog("Begin disconnectRequest children"),this.sendEvent(new c.GenericCustomEvent("session-terminating",t))),this.disconnectRequest2(e,t))}))}tryDeleteBreakpoints(){return r(this,void 0,void 0,(function*(){try{return yield this.miDebugger.sendCommand("break-delete"),!0}catch(e){return this.handleMsg("log",`Could not delete all breakpoints. ${e}\n`),!1}}))}disconnectRequest2(e,t){return this.disconnectingPromise=new Promise((s=>r(this,void 0,void 0,(function*(){this.serverConsoleLog("Begin disconnectRequest");const n=()=>r(this,void 0,void 0,(function*(){yield this.tryDeleteBreakpoints(),this.disableSendStoppedEvents=!1,this.attached=!1,this.waitForServerExitAndRespond(e),t.terminateDebuggee||t.suspendDebuggee?this.miDebugger.stop():this.miDebugger.detach(),s()}));if(this.miDebugger)if(this.disableSendStoppedEvents=!0,this.stopped)n();else{let e=v.setTimeout((()=>{e&&(e=null,this.handleMsg("log","GDB never responded to an interrupt request. Trying to end session anyways\n"),n())}),2e3);this.miDebugger.once("generic-stopped",(()=>{e&&(clearTimeout(e),e=null,n())}));try{yield this.miDebugger.sendCommand("exec-interrupt")}catch(e){this.handleMsg("log",`Could not interrupt program. Trying to end session anyways ${e}\n`)}}else s()})))),this.disconnectingPromise}restartRequest(e,t){return new Promise((s=>{const n="reset"===t?D.RESET:D.RESTART,i=()=>{const i=[];this.args.pvtRestartOrReset=!0,this.disableSendStoppedEvents=!1,this.continuing=!1,i.push(...this.args.preRestartCommands.map(q));const o=null!=this.args.overrideRestartCommands?this.args.overrideRestartCommands.map(q):this.serverController.restartCommands();i.push(...o),i.push(...this.args.postRestartCommands.map(q));let a=!1;const h=()=>{a||(a=!0,this.sendDummyStackTrace=!1,this.finishStartSequence(n))};this.sendDummyStackTrace=!0,this.onInternalEvents.once("stack-trace-request",(()=>{h()})),this.miDebugger.restart(i).then((e=>r(this,void 0,void 0,(function*(){this.args.chainedConfigurations&&this.args.chainedConfigurations.enabled&&v.setTimeout((()=>{this.serverConsoleLog(`Begin ${n} children`),this.sendEvent(new c.GenericCustomEvent(`session-${n}`,t))}),250),a||(yield new Promise((e=>v.setTimeout(e,100))),h()),s()}))),(t=>{this.sendErrorResponse(e,6,`Could not restart/reset: ${t}`),s()}))};this.disableSendStoppedEvents=!0,this.stopped?i():(this.miDebugger.once("generic-stopped",i),this.miDebugger.sendCommand("exec-interrupt"))}))}getResetCommands(){return null!=this.args.overrideRestartCommands?this.args.overrideRestartCommands.map(q):this.serverController.restartCommands()}resetDevice(e,t){return r(this,void 0,void 0,(function*(){try{yield this.restartRequest(e,t)}catch(e){}}))}wrapTimeStamp(e){return this.args.showDevDebugOutput&&this.args.showDevDebugTimestamps?(Date.now()-this.timeStart).toString().padStart(10,"0")+": "+e:e}serverControllerEvent(e){this.sendEvent(e)}handleMsg(e,t){this.suppressRadixMsgs&&"console"===e&&/radix/.test(t)||("target"===e&&(e="stdout"),"log"===e&&(e="stderr"),t=this.wrapTimeStamp(t),this.origShowDevDebugOutput===c.ADAPTER_DEBUG_MODE.VSCODE?(this.setupLogger(!1,this.args),this.sendEvent(new n.OutputEvent(t,e)),this.setupLogger(!0,this.args)):this.sendEvent(new n.OutputEvent(t,e)))}handleRunning(e){this.stopped=!1,this.continuing=!1,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new W(this.currentThreadId,!0))}handleContinueFailed(e){const t="Error: A serious error occurred with gdb, unable to continue or interrupt We may not be able to recover from this point. You can try continuing or ending session. Must address root cause though";this.sendEvent(new c.GenericCustomEvent("popup",{type:"error",message:t})),this.handleMsg("stderr",t+"\n"),this.continuing=!1,this.stopped=!0,this.stoppedReason="continue failed",this.notifyStoppedConditional()}findPausedThread(e){if(e.outOfBandRecord&&e.outOfBandRecord[0]&&e.outOfBandRecord[0].output)for(const t of e.outOfBandRecord[0].output)if("thread-id"===t[0])return this.currentThreadId=parseInt(t[1]),void(this.stoppedThreadId=this.currentThreadId)}handleBreakpoint(e){this.continuing=!1,this.stopped=!0,this.stoppedReason="breakpoint",this.findPausedThread(e),this.notifyStoppedConditional()}notifyStoppedConditional(){this.disableSendStoppedEvents||this.notifyStopped()}handleWatchpoint(e,t){if(this.continuing=!1,this.stopped=!0,this.stoppedReason="hit"===e?"data breakpoint":"watchpoint-scope-end",this.findPausedThread(t),this.notifyStoppedConditional(),"hit"!==e&&t.outOfBandRecord&&t.outOfBandRecord[0]&&t.outOfBandRecord[0].output)for(const e of t.outOfBandRecord[0].output)if(e[0].endsWith("wpnum")){const t=parseInt(e[1]);if(!this.dataBreakpointMap.get(t))break;const s={body:{reason:"removed",breakpoint:{id:t,verified:!1}},type:"event",event:"breakpoint",seq:0};this.dataBreakpointMap.delete(t),this.sendEvent(s);break}}handleBreak(e){this.continuing=!1,this.stopped=!0,this.stoppedReason="step",this.findPausedThread(e),this.notifyStoppedConditional()}sendEvent(e){super.sendEvent(e)}handlePause(e){this.continuing=!1,this.stopped=!0,this.stoppedReason="user request",this.findPausedThread(e),this.notifyStoppedConditional()}handleThreadCreated(e){this.activeThreadIds.has(e.threadId)?this.handleMsg("log",`Thread Error: GDB trying to create thread '${e.threadId}' that already exists`):(this.activeThreadIds.add(e.threadId),this.sendEvent(new n.ThreadEvent("started",e.threadId)))}handleThreadExited(e){this.activeThreadIds.has(e.threadId)?this.activeThreadIds.delete(e.threadId):this.handleMsg("log",`Thread Error: GDB trying to delete thread '${e.threadId}' that does not exist.\n`),this.currentThreadId===e.threadId&&(this.currentThreadId=0),this.stoppedThreadId===e.threadId&&(this.stoppedThreadId=0),this.sendEvent(new n.ThreadEvent("exited",e.threadId))}handleThreadSelected(e){this.activeThreadIds.has(e.threadId)?this.currentThreadId=e.threadId:this.handleMsg("log",`Thread Error: GDB trying to select thread '${e.threadId}' that does not exist. No harm done\n`)}handleThreadGroupExited(e){this.clearAllThreads()}clearAllThreads(){this.currentThreadId=0;for(const e of this.activeThreadIds.values())this.sendEvent(new n.ThreadEvent("exited",e));this.activeThreadIds.clear()}stopEvent(e,t="exception"){this.quit||(this.continuing=!1,this.stopped=!0,this.stoppedReason=t,this.findPausedThread(e),"entry"===t&&this.args.noDebug||this.notifyStoppedConditional())}quitEvent(){this.quit=!0,this.server&&this.server.isProcessRunning()&&(this.serverConsoleLog("quitEvent: Killing server"),this.server.exit()),v.setTimeout((()=>{try{this.sendEvent(new n.TerminatedEvent),this.serverConsoleLog("quitEvent: sending VSCode TerminatedEvent")}catch(e){}}),10)}serverQuitEvent(){this.miDebugger.isRunning()&&!this.quit&&this.miDebugger.stop()}static decodeReference(e){return[(65280&e)>>>8,255&e]}static encodeReference(e,t){return 65535&(e<<8|255&t)}setVariableRequest(e,t){return r(this,void 0,void 0,(function*(){try{let s=t.name,r=-1,n=-1;const i=t.variablesReference,o=i>=L&&i<F,a=!o&&this.getFloatingVariable(i,s);if(o)s=(yield this.miDebugger.varCreate(i,"$"+s,"-","*")).name,[r,n]=z.decodeReference(i);else if(a)s=a.name;else if(i>=j){const e=this.variableHandles.get(t.variablesReference);s=e.children[s]||`${e.name}.${s}`}else if(i>=256&&i<N){const e=this.createStackVarName(s,i);this.variableHandlesReverse.hasOwnProperty(e)&&(s=e),[r,n]=z.decodeReference(i)}const c=yield this.miDebugger.varAssign(s,t.value,r,n);e.body={value:c.result("value")},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,11,`Could not set variable: ${t}`)}}))}setFunctionBreakPointsRequest(e,t){return this.functionBreakPointsQ.add(((e,t,s)=>new Promise((n=>r(this,void 0,void 0,(function*(){if(0===t.breakpoints.length&&0===this.functionBreakpoints.length)return this.sendResponse(e),void n();const i=()=>r(this,void 0,void 0,(function*(){try{yield this.miDebugger.removeBreakpoints(this.functionBreakpoints),this.functionBreakpoints=[];const s=new Array;t.breakpoints.forEach((e=>{const t=Object.assign(Object.assign({},e),{raw:e.name,file:void 0,line:void 0});s.push(this.miDebugger.addBreakPoint(t).catch((e=>e)))}));const r=(yield Promise.all(s)).map((e=>e instanceof a.MIError?{verified:!1,message:e.message}:(this.functionBreakpoints.push(e.number),{source:{path:e.file,name:e.raw},line:e.line,instructionReference:e.address,id:e.number,verified:!0})));e.body={breakpoints:r},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,10,t.toString())}s.haveMore()?console.log("Yup got another request while we are processing one. VSCode issue\n"):s.shouldContinue&&(this.disableSendStoppedEvents=!1,s.shouldContinue=!1,this.sendContinue()),n()}));"running"!==this.miDebugger.status?yield i():(this.disableSendStoppedEvents=!0,s.shouldContinue=!0,this.miDebugger.once("generic-stopped",(()=>{i()})),this.miDebugger.sendCommand("exec-interrupt"))}))))),e,t)}setBreakPointsRequest(e,t){return new Promise((s=>r(this,void 0,void 0,(function*(){if(0===t.breakpoints.length&&0===this.breakpointMap.size)return this.sendResponse(e),void s();const n=this.disableSendStoppedEvents,i=i=>r(this,void 0,void 0,(function*(){const r=(this.breakpointMap.get(t.source.path)||[]).map((e=>e.number));try{this.disableSendStoppedEvents=n,yield this.miDebugger.removeBreakpoints(r);for(const e of r)this.breakpointById.delete(e);this.breakpointMap.set(t.source.path,[]);const s=[],i=decodeURIComponent(t.source.path);if(i.startsWith("disassembly:/")){let e=13;i.startsWith("disassembly:///")&&(e=15);const r=i.substring(e,i.length-6).split(":::");let n,o;2===r.length?(n=r[1],o=r[0]):n=r[0];const c=yield this.disassember.getDisassemblyForFunction(n,o);c&&t.breakpoints.forEach((e=>{if(e.line<=c.instructions.length){const r=c.instructions[e.line-1],n=Object.assign(Object.assign({},e),{file:t.source.path,raw:r.address});s.push(this.miDebugger.addBreakPoint(n).catch((e=>e)))}else s.push(Promise.resolve(new a.MIError(`${n} only contains ${c.instructions.length} instructions`,"Set breakpoint")))}))}else t.breakpoints.forEach((e=>{const r=Object.assign(Object.assign({},e),{file:t.source.path});s.push(this.miDebugger.addBreakPoint(r).catch((e=>e)))}));const o=yield Promise.all(s);e.body={breakpoints:o.map((e=>e instanceof a.MIError?{verified:!1,message:e.message}:{line:e.line,id:e.number,instructionReference:e.address,verified:!0}))};const c=o.filter((e=>!(e instanceof a.MIError)));for(const e of c)this.breakpointById.set(e.number,e);this.breakpointMap.set(t.source.path,c),this.sendResponse(e),this.pendingBkptResponse=!1}catch(t){this.sendErrorResponse(e,9,t.toString()),this.pendingBkptResponse=!1}s(),i&&this.sendContinue()})),o=()=>r(this,void 0,void 0,(function*(){"running"!==this.miDebugger.status?i(!1):(this.disableSendStoppedEvents=!0,this.miDebugger.once("generic-stopped",(()=>{i(!0)})),this.miDebugger.sendCommand("exec-interrupt"))})),c=setInterval((()=>{this.pendingBkptResponse||(clearInterval(c),this.pendingBkptResponse=!0,o())}),1)}))))}setInstructionBreakpointsRequest(e,t,s){return new Promise((s=>r(this,void 0,void 0,(function*(){if(0===t.breakpoints.length&&0===this.instrBreakpointMap.size)return this.sendResponse(e),void s();const n=this.disableSendStoppedEvents,i=i=>r(this,void 0,void 0,(function*(){try{const s=Array.from(this.instrBreakpointMap.keys());this.instrBreakpointMap.clear(),this.disableSendStoppedEvents=n,yield this.miDebugger.removeBreakpoints(s);const r=[];t.breakpoints.forEach((e=>{const t=parseInt(e.instructionReference)+e.offset||0,s=Object.assign(Object.assign({},e),{number:-1,address:t});r.push(this.miDebugger.addInstrBreakPoint(s).catch((e=>e)))}));const i=yield Promise.all(r);e.body={breakpoints:i.map((e=>e instanceof a.MIError?{verified:!1,message:e.message}:(this.instrBreakpointMap.set(e.number,e),{id:e.number,verified:!0})))},this.sendResponse(e),this.pendingBkptResponse=!1}catch(t){this.sendErrorResponse(e,9,t.toString()),this.pendingBkptResponse=!1}s(),i&&this.sendContinue()}));"running"!==this.miDebugger.status?i(!1):(this.disableSendStoppedEvents=!0,this.miDebugger.once("generic-stopped",(()=>{i(!0)})),this.miDebugger.sendCommand("exec-interrupt"))}))))}isVarRefGlobalOrStatic(e,t){if(254===e)return!0;if(e>=$&&e<=N)return!0;if(t instanceof a.VariableObject){const e=t.parent,s=this.variableHandles.get(e);return this.isVarRefGlobalOrStatic(e,s)}return t instanceof A||console.log(`isVarRefGlobalOrStatic: What is this? varRef = ${e}`,t),!1}dataBreakpointInfoRequest(e,t){e.body={dataId:null,description:"cannot break on data access",accessTypes:void 0,canPersist:!1};const s=t.variablesReference;if(void 0!==s&&t.name&&!(s>=L&&s<=F)){const s=this.variableHandles.get(t.variablesReference);e.body.canPersist=this.isVarRefGlobalOrStatic(t.variablesReference,s);const r=s,n=(r?(r.fullExp||r.exp)+".":"")+t.name;e.body.dataId=n,e.body.description=n,e.body.accessTypes=["read","write","readWrite"]}this.sendResponse(e)}setDataBreakpointsRequest(e,t){return new Promise((s=>{if(0===t.breakpoints.length&&0===this.dataBreakpointMap.size)return this.sendResponse(e),void s();const n=this.disableSendStoppedEvents,i=i=>r(this,void 0,void 0,(function*(){try{const s=Array.from(this.dataBreakpointMap.keys());this.dataBreakpointMap.clear(),this.disableSendStoppedEvents=n,yield this.miDebugger.removeBreakpoints(s);const r=[];t.breakpoints.forEach((e=>{const t=Object.assign({},e);r.push(this.miDebugger.addDataBreakPoint(t).catch((e=>e)))}));const i=yield Promise.all(r);e.body={breakpoints:i.map((e=>e instanceof a.MIError?{verified:!1,message:e.message}:(this.dataBreakpointMap.set(e.number,e),{id:e.number,verified:!0})))},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,9,t.toString())}s(),i&&this.sendContinue()}));"running"!==this.miDebugger.status?i(!1):(this.disableSendStoppedEvents=!0,this.miDebugger.once("generic-stopped",(()=>{i(!0)})),this.miDebugger.sendCommand("exec-interrupt"))}))}threadsRequest(e){if(e.body={threads:[]},!this.isMIStatusStopped()||!this.stopped||this.disableSendStoppedEvents||this.continuing)return this.sendResponse(e),Promise.resolve();if(this.sendDummyStackTrace){this.args.showDevDebugOutput&&this.handleMsg("log","Returning dummy thread-id to workaround VSCode issue with pause button not working\n");const t=this.currentThreadId||(this.activeThreadIds.size?this.activeThreadIds.values[0]:1);return e.body.threads=[new n.Thread(t,"cortex-debug-dummy-thread")],this.sendResponse(e),Promise.resolve()}return new Promise((t=>r(this,void 0,void 0,(function*(){try{const s=yield this.miDebugger.sendCommand("thread-list-ids"),r=s.result("thread-ids").map((e=>parseInt(e[1]))),i=s.result("current-thread-id");if(!r||0===r.length)return this.sendResponse(e),void t();for(const e of r)this.activeThreadIds.has(e)||this.handleThreadCreated({threadId:e,threadGroupId:"i1"});i?this.currentThreadId=parseInt(i):(this.currentThreadId=r.findIndex((e=>e===this.stoppedThreadId))>=0?this.stoppedThreadId:r[0],r.length>1&&(yield this.miDebugger.sendCommand(`thread-select ${this.currentThreadId}`))),this.currentThreadId!==this.stoppedThreadId&&(this.stoppedThreadId=this.currentThreadId,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.notifyStopped());const o=(yield Promise.all(r.map((e=>this.miDebugger.sendCommand(`thread-info ${e}`))))).map((e=>{let t=e.result("threads");if(1===t.length){t=t[0];const e=parseInt(u.MINode.valueOf(t,"id")),s=u.MINode.valueOf(t,"target-id"),r=u.MINode.valueOf(t,"details");let i=u.MINode.valueOf(t,"name");return i&&r&&i!==r?i+=` (${r})`:i=i||r||s,new n.Thread(e,i)}return null})).filter((e=>null!==e));e.body={threads:o},this.sendResponse(e),t()}catch(s){this.isMIStatusStopped()?this.sendErrorResponse(e,1,`Unable to get thread information: ${s}`):this.sendResponse(e),t()}}))))}stackTraceRequest(e,t){return e.body={stackFrames:[],totalFrames:0},!this.isMIStatusStopped()||!this.stopped||this.disableSendStoppedEvents||this.continuing?(this.sendResponse(e),Promise.resolve()):this.sendDummyStackTrace?(this.args.showDevDebugOutput&&this.handleMsg("log",`Returning dummy stack frame to workaround VSCode issue with pause button not working: ${JSON.stringify(t)}\n`),e.body.stackFrames=[new n.StackFrame(z.encodeReference(t.threadId,0),"cortex-debug-dummy",null,0,0)],e.body.totalFrames=1,this.onInternalEvents.emit("stack-trace-request"),this.sendResponse(e),Promise.resolve()):new Promise((s=>r(this,void 0,void 0,(function*(){try{const r=yield this.miDebugger.getStackDepth(t.threadId),i=Math.min(r,t.startFrame+t.levels)-1,o=yield this.miDebugger.getStack(t.threadId,t.startFrame,i),a=[];for(const e of o){const s=z.encodeReference(t.threadId,e.level),r=e.file;let i=!0,o=this.forceDisassembly||!r;if(o||(o=!this.checkFileExists(r)),!o&&this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);let s;t&&(s=t.file&&t.scope!==T.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`,s===this.activeEditorPath&&(i=!1,o=!0))}try{if(o)if(i){const t=`${e.function}@${e.address}`,r=new n.StackFrame(s,t);r.instructionPointerReference=e.address,a.push(r)}else{const t=yield this.disassember.getDisassemblyForFunction(e.function,e.fileName);let r=-1;if(t.instructions.forEach(((t,s)=>{t.address===e.address&&(r=s+1)})),-1!==r){let i;i=t.file&&t.scope!==T.SymbolScope.Global?`${t.file}:::${t.name}.cdasm`:`${t.name}.cdasm`;const o="disassembly:///"+i,c=new n.StackFrame(s,`${e.function}@${e.address}`,new n.Source(i,o),r,0);c.instructionPointerReference=e.address,a.push(c)}else{const t=new n.StackFrame(s,e.function+"@"+e.address,null,e.line,0);t.instructionPointerReference=e.address,a.push(t)}}else{const t=r?new n.Source(e.fileName,r):void 0,i=new n.StackFrame(s,e.function+"@"+e.address,t,e.line,0);i.instructionPointerReference=e.address,a.push(i)}}catch(t){const r=new n.StackFrame(s,e.function+"@"+e.address,null,e.line,0);r.instructionPointerReference=e.address,a.push(r)}}a.length>0&&a[0].source,e.body={stackFrames:a,totalFrames:r},this.sendResponse(e),s()}catch(t){this.isMIStatusStopped()?this.sendErrorResponse(e,12,`Failed to get Stack Trace: ${t.toString()}`):this.sendResponse(e),s()}}))))}configurationDoneRequest(e,t){this.sendResponse(e),this.configDone=!0,this.onInternalEvents.emit("config-done")}scopesRequest(e,t){const s=new Array;s.push(new n.Scope("Local",parseInt(t.frameId),!1)),s.push(new n.Scope("Global",254,!1));const r=$+parseInt(t.frameId);s.push(new n.Scope("Static",r,!1)),this.floatingVariableMap[r]={},s.push(new n.Scope("Registers",L+parseInt(t.frameId))),e.body={scopes:s},this.sendResponse(e)}registersRequest(e,t){return r(this,void 0,void 0,(function*(){const s=[];try{if(0===this.registerMap.size){const e=yield this.miDebugger.sendCommand("data-list-register-names");"done"===e.resultRecords.resultClass&&e.resultRecords.results.forEach((e=>{if("register-names"===e[0]){const t=e[1];let s=0;for(const e of t)""!==e&&(this.registerMap.set(e,s),this.registerMapReverse.set(s,e)),s++}}))}}catch(t){return this.sendErrorResponse(e,116,`Unable to read register list: ${t.toString()}`),void this.sendEvent(new c.TelemetryEvent("Error","Reading Register List",""))}try{const[e,r]=z.decodeReference(t.variablesReference),n=this.args.variableUseNaturalFormat?"N":"x";yield this.miDebugger.sendCommand(`stack-select-frame --thread ${e} ${r}`);const i=yield this.miDebugger.sendCommand(`data-list-register-values ${n}`);if("done"!==i.resultRecords.resultClass)throw new Error("Unable to parse response for reg. values");{const t=i.resultRecords.results[0][1];for(const n of t){const t=parseInt(n[0][1]),i=this.registerMapReverse.get(t);if(i){const t=n[1][1],a={name:i,evaluateName:"$"+i,value:t,variablesReference:0};if(!/^[sd][0-9]/i.test(i)&&(/^0x[0-9a-f]+/i.test(t)||/^[-]?[0-9]+/.test(t))){const s=parseInt(t.toLowerCase());a.type=`Register: $${i} Thread#${e}, Frame#${r}\n`+c.toStringDecHexOctBin(s);const n=(e,t,r)=>`\n    ${e}: ${o.extractBits(s,t,r).toString()}`;"xpsr"===i.toLowerCase()?(a.type+=n("Negative Flag (N)",31,1),a.type+=n("Zero Flag (Z)",30,1),a.type+=n("Carry or borrow flag (C)",29,1),a.type+=n("Overflow Flag (V)",28,1),a.type+=n("Saturation Flag (Q)",27,1),a.type+=n("GE",16,4),a.type+=n("Interrupt Number",0,8),a.type+=n("ICI/IT",25,2),a.type+=n("ICI/IT",10,6),a.type+=n("Thumb State (T)",24,1)):"control"===i.toLowerCase()&&(a.type+=n("FPCA",2,1),a.type+=n("SPSEL",1,1),a.type+=n("nPRIV",0,1))}s.push(a)}}}}catch(t){return this.sendErrorResponse(e,115,`Unable to read registers: ${t.toString()}`),void this.sendEvent(new c.TelemetryEvent("Error","Reading Registers",""))}e.body={variables:s},this.sendResponse(e)}))}globalVariablesRequest(e,t){return r(this,void 0,void 0,(function*(){const s=this.symbolTable.getGlobalVariables(),r=[];try{for(const e of s){const s=`global_var_${e.name}`;let n;try{(yield this.miDebugger.varUpdate(s,-1,-1)).result("changelist").forEach((e=>{const t=u.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)}));const e=this.variableHandlesReverse[s];n=this.variableHandles.get(e)}catch(r){try{if(!(r instanceof a.MIError&&"Variable object not found"===r.message))throw r;{n=yield this.miDebugger.varCreate(t.variablesReference,e.name,s);const r=this.findOrCreateVariable(n);n.exp=e.name,n.id=r}}catch(t){this.args.showDevDebugOutput&&(this.handleMsg("stderr",`Could not create global variable ${e.name}\n`),this.handleMsg("stderr",`Error: ${t}\n`)),n=null}}n&&(this.putFloatingVariable(t.variablesReference,e.name,n),r.push(n.toProtocolVariable()))}e.body={variables:r},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not get global variable information: ${t}`)}}))}createStaticVarName(e,t){return`static_var_${t}_${e}`}putFloatingVariable(e,t,s){const r=this.floatingVariableMap[e]||{};r[t]=s,this.floatingVariableMap[e]=r}getFloatingVariable(e,t){const s=this.floatingVariableMap[e];return s?s[t]:null}staticVariablesRequest(e,t,s,n){return r(this,void 0,void 0,(function*(){const r=[];try{const i=yield this.miDebugger.getFrame(e,t);let o=i.file,c=o?yield this.symbolTable.getStaticVariableNames(o):null;c||(o=i.fileName,c=o?yield this.symbolTable.getStaticVariableNames(o):[]);const h=b.createHash("sha256");h.update(o||"");const l=h.digest("hex");for(const e of c){const t=this.createStaticVarName(l,e);let s;try{(yield this.miDebugger.varUpdate(t,-1,-1)).result("changelist").forEach((e=>{const t=u.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)}));const e=this.variableHandlesReverse[t];s=this.variableHandles.get(e)}catch(r){try{if(!(r instanceof a.MIError&&"Variable object not found"===r.message))throw r;{s=yield this.miDebugger.varCreate(n.variablesReference,e,t);const r=this.findOrCreateVariable(s);s.exp=e,s.id=r}}catch(t){this.args.showDevDebugOutput&&(this.handleMsg("stderr",`Could not create static variable ${o}:${e}\n`),this.handleMsg("stderr",`Error: ${t}\n`)),s=null}}s&&(this.putFloatingVariable(n.variablesReference,e,s),r.push(s.toProtocolVariable()))}s.body={variables:r},this.sendResponse(s)}catch(e){this.sendErrorResponse(s,1,`Could not get static variable information: ${e}`)}}))}createVariable(e,t){return t?this.variableHandles.create(new A(e,t)):this.variableHandles.create(e)}findOrCreateVariable(e){let t;return this.variableHandlesReverse.hasOwnProperty(e.name)?t=this.variableHandlesReverse[e.name]:(t=this.createVariable(e),this.variableHandlesReverse[e.name]=t),e.isCompound()?t:0}createStackVarName(e,t){return`var_${e}_${t}`}stackVariablesRequest(e,t){return r(this,void 0,void 0,(function*(){if(e.body={variables:[]},!this.isMIStatusStopped()||!this.stopped||this.disableSendStoppedEvents||this.continuing)return void this.sendResponse(e);const[s,r]=z.decodeReference(t.variablesReference),n=[];let i;try{this.miDebugger.sendCommand(`stack-select-frame --thread ${s} ${r}`),i=yield this.miDebugger.getStackVariables(s,r);for(const e of i)try{const i=this.createStackVarName(e.name,t.variablesReference);let o;try{(yield this.miDebugger.varUpdate(i,s,r)).result("changelist").forEach((e=>{const t=u.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)}));const e=this.variableHandlesReverse[i];o=this.variableHandles.get(e)}catch(n){if(!(n instanceof a.MIError&&"Variable object not found"===n.message))throw n;{o=yield this.miDebugger.varCreate(t.variablesReference,e.name,i,"*",s,r);const n=this.findOrCreateVariable(o);o.exp=e.name,o.id=n}}n.push(o.toProtocolVariable())}catch(t){n.push({name:e.name,value:`<${t}>`,variablesReference:0})}e.body={variables:n},this.sendResponse(e)}catch(t){this.isMIStatusStopped()?this.sendErrorResponse(e,1,`Could not get stack variables: ${t}`):this.sendResponse(e)}}))}variableMembersRequest(e,t,s){return r(this,void 0,void 0,(function*(){let s;try{s=yield this.miDebugger.evalExpression(JSON.stringify(e),-1,-1);try{let n=l.expandValue(this.createVariable.bind(this),s.result("value"),e,s);n?("string"==typeof n[0]&&(n=[{name:"<value>",value:(r=n,"object"==typeof r?void 0!==r.length?r.join(", "):JSON.stringify(r):r),variablesReference:0}]),t.body={variables:n},this.sendResponse(t)):this.sendErrorResponse(t,2,"Could not expand variable")}catch(e){this.sendErrorResponse(t,2,`Could not expand variable: ${e}`)}}catch(e){this.sendErrorResponse(t,1,`Could not expand variable: ${e}`)}var r}))}variablesRequest(e,t){return r(this,void 0,void 0,(function*(){if(e.body={variables:[]},!this.isMIStatusStopped()||!this.stopped||this.disableSendStoppedEvents||this.continuing)return void this.sendResponse(e);let s;if(254===t.variablesReference)return this.globalVariablesRequest(e,t);if(t.variablesReference>=$&&t.variablesReference<=131071){const[s,r]=z.decodeReference(t.variablesReference);return this.staticVariablesRequest(s,r,e,t)}if(t.variablesReference>=256&&t.variablesReference<N)return this.stackVariablesRequest(e,t);if(t.variablesReference>=L&&t.variablesReference<F)return this.registersRequest(e,t);if(s=this.variableHandles.get(t.variablesReference),"string"==typeof s)return this.variableMembersRequest(s,e,t);if("object"==typeof s)if(s instanceof a.VariableObject){const r=s;let n;const i={};try{n=yield this.miDebugger.varListChildren(t.variablesReference,s.name);const o=n.map((e=>{const t=this.findOrCreateVariable(e);if(e.id=t,/^\d+$/.test(e.exp))e.fullExp=`${r.fullExp||r.exp}[${e.exp}]`;else{let t="."+e.exp;if(e.exp.startsWith("<anonymous")){const s=i[e.exp];s&&(i[e.exp]=s+1,e.exp+="#"+s.toString(10)),i[e.exp]=1,t=""}else r.children[e.exp]=e.name;e.fullExp=`${r.fullExp||r.exp}${t}`}return e.toProtocolVariable()}));e.body={variables:o},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not expand variable: ${t}`)}}else if(s instanceof A){const t=s;if(t.options.arg){const s=[];let n=!0,i=0;const o=()=>{e.body={variables:s},this.sendResponse(e)},a=()=>r(this,void 0,void 0,(function*(){const r=yield this.miDebugger.evalExpression(JSON.stringify(`${t.name}+${i})`),-1,-1);try{const c=l.expandValue(this.createVariable.bind(this),r.result("value"),t.name,r);if(c)if("string"==typeof c){if("<nullptr>"===c){if(!n)return o();n=!1}else if('"'!==c[0])return s.push({name:"[err]",value:c,variablesReference:0}),o();s.push({name:`[${i++}]`,value:c,variablesReference:0}),a()}else s.push({name:"[err]",value:c,variablesReference:0}),o();else this.sendErrorResponse(e,15,"Could not expand variable")}catch(t){this.sendErrorResponse(e,14,`Could not expand variable: ${t}`)}}));a()}else this.sendErrorResponse(e,13,`Unimplemented variable request options: ${JSON.stringify(t.options)}`)}else e.body={variables:s},this.sendResponse(e);else e.body={variables:[]},this.sendResponse(e)}))}pauseRequest(e,t){return r(this,void 0,void 0,(function*(){try{yield this.miDebugger.interrupt(),this.sendResponse(e)}catch(t){this.sendErrorResponse(e,3,`Could not pause: ${t}`)}}))}continueRequest(e,t){return r(this,void 0,void 0,(function*(){try{yield this.miDebugger.continue(t.threadId),e.body={allThreadsContinued:!0},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,2,`Could not continue: ${t}`)}}))}stepInRequest(e,t){return r(this,void 0,void 0,(function*(){try{let s="instruction"===t.granularity;if(!s&&(s=this.forceDisassembly,!s)){const e=yield this.miDebugger.getFrame(t.threadId,0);if(s=!this.checkFileExists(e.file),this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);if(t){let e;e=t.file&&t.scope!==T.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`,e===this.activeEditorPath&&(s=!0)}}}yield this.miDebugger.step(t.threadId,s),this.sendResponse(e)}catch(t){this.sendErrorResponse(e,6,`Could not step over: ${t}`)}}))}stepOutRequest(e,t){return r(this,void 0,void 0,(function*(){try{yield this.miDebugger.stepOut(t.threadId),this.sendResponse(e)}catch(t){this.sendErrorResponse(e,5,`Could not step out: ${t}`)}}))}nextRequest(e,t){return r(this,void 0,void 0,(function*(){try{let s="instruction"===t.granularity;if(!s&&(s=this.forceDisassembly,!s)){const e=yield this.miDebugger.getFrame(t.threadId,0);if(s=!this.checkFileExists(e.file),this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);if(t){let e;e=t.file&&t.scope!==T.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`,e===this.activeEditorPath&&(s=!0)}}}yield this.miDebugger.next(t.threadId,s),this.sendResponse(e)}catch(t){this.sendErrorResponse(e,6,`Could not step over: ${t}`)}}))}checkFileExists(e){if(!e)return!1;if(this.fileExistsCache.has(e))return this.fileExistsCache.get(e);const t=m.existsSync(e);return this.fileExistsCache.set(e,t),t}evaluateRequest(e,t){const s=()=>!this.stopped||this.continuing||"running"===this.miDebugger.status||this.sendDummyStackTrace;return"repl"!==t.context&&s()?(this.args.showDevDebugOutput&&this.handleMsg("log",`Info: Attempt to evalute expression while busy. ${JSON.stringify(t)}\n`),this.sendErrorResponse(e,8,"Busy",void 0,n.ErrorDestination.Telemetry),Promise.resolve()):this.evaluateQ.add(((e,t)=>new Promise((n=>r(this,void 0,void 0,(function*(){const r=(e,t)=>t?this.variableHandles.create(new A(e,t)):this.variableHandles.create(e),i=e=>{let t;return this.variableHandlesReverse.hasOwnProperty(e.name)?t=this.variableHandlesReverse[e.name]:(t=r(e),this.variableHandlesReverse[e.name]=t),e.isCompound()?t:0};let o=this.currentThreadId,c=0;if(t.frameId?[o,c]=z.decodeReference(t.frameId):s()||this.handleMsg("log",`Thread Warning: ${t.context}: eval. expression '${t.expression}' with no thread context. Using default\n`),"repl"!==t.context)try{const s=t.expression,r=b.createHash("sha256");r.update(s);const h=r.digest("hex"),l=`${t.context}_${h}`;let d;try{(yield this.miDebugger.varUpdate(l,o,c)).result("changelist").forEach((e=>{const t=u.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)}));const e=this.variableHandlesReverse[l];d=this.variableHandles.get(e)}catch(e){if(!(e instanceof a.MIError&&"Variable object not found"===e.message))throw e;{d=yield this.miDebugger.varCreate(0,s,l,"@");const e=i(d);d.exp=s,d.id=e}}e.body={result:d.value,type:d.type,presentationHint:{kind:d.displayhint},variablesReference:d.id},this.sendResponse(e)}catch(s){e.body={result:"hover"===t.context?null:`<${s.toString()}>`,variablesReference:0},this.sendResponse(e),this.args.showDevDebugOutput&&this.handleMsg("stderr",t.context+" "+s.toString())}finally{n()}else try{!s()&&t.frameId&&(yield this.miDebugger.sendCommand(`stack-select-frame --thread ${o} ${c}`)),this.miDebugger.sendUserInput(t.expression).then((t=>{e.body=void 0===t?{result:"",variablesReference:0}:{result:JSON.stringify(t),variablesReference:0},this.sendResponse(e),n()}),(t=>{this.sendErrorResponse(e,8,t.toString()),n()}))}catch(t){this.sendErrorResponse(e,8,t.toString()),n()}}))))),e,t)}gotoTargetsRequest(e,t){return r(this,void 0,void 0,(function*(){try{(yield this.miDebugger.goto(t.source.path,t.line))?(e.body={targets:[{id:1,label:t.source.name,column:t.column,line:t.line}]},this.sendResponse(e)):this.sendErrorResponse(e,16,`Could not jump to: ${t.source.path}:${t.line}`)}catch(s){this.sendErrorResponse(e,16,`Could not jump to: ${s||""} ${t.source.path}:${t.line}`)}}))}}t.GDBDebugSession=z;const K=function(){const e={};for(let t=0;t<256;t++)e[t.toString(16).padStart(2,"0")]=t;return e}();n.LoggingDebugSession.run(z)},7391:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JLinkServerController=void 0;const r=s(3200),n=s(2037),i=s(2361),o=s(5497).sync,a=["JLinkGDBServerCLExe","JLinkGDBServerCL","JLinkGDBServer"];class c extends i.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort","swoPort","consolePort"],this.rttHelper=new r.RTTServerHelper,this.defaultRttPort=19021}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return['interpreter-exec console "monitor halt"',...r.genDownloadCommands(this.args,['interpreter-exec console "monitor reset"']),'interpreter-exec console "monitor reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"']}rttCommands(){const e=[];if(this.args.rttConfig.enabled&&!this.args.pvtRestartOrReset){const t=this.args.rttConfig;if("launch"===this.args.request&&t.clearSearch){let s=r.parseHexOrDecInt(t.address);for(let r=0;r<t.searchId.length;r+=4)e.push(`interpreter-exec console "monitor exec memU32 0x${s.toString(16)} = 0"`),s+=4}e.push(`interpreter-exec console "monitor exec SetRTTAddr ${t.address}"`)}return e}swoAndRTTCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e.concat(this.rttCommands())}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=0|this.args.swoConfig.swoFrequency,s=[`monitor SWO EnableTarget ${0|this.args.swoConfig.cpuFrequency} ${t} ${e} 0`,"DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable"];return s.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),s.map((e=>`interpreter-exec console "${e}"`))}serverExecutable(){if(this.args.serverpath)return this.args.serverpath;if("win32"===n.platform())return"JLinkGDBServerCL.exe";for(const e in a)if(o(e))return e;return"JLinkGDBServer"}allocateRTTPorts(){return!this.args.rttConfig||!this.args.rttConfig.enabled||this.args.rttConfig.decoders&&0!==this.args.rttConfig.decoders.length?this.rttHelper.allocateRTTPorts(this.args.rttConfig,this.defaultRttPort):Promise.resolve()}serverArguments(){const e=this.ports.gdbPort,t=this.ports.swoPort,s=this.ports.consolePort;let r=["-singlerun","-nogui","-if",this.args.interface,"-port",e.toString(),"-swoport",t.toString(),"-telnetport",s.toString(),"-device",this.args.device];if(this.args.rttConfig.enabled){const e=Object.keys(this.rttHelper.rttLocalPortMap);let t=this.defaultRttPort.toString();e&&e.length>0&&(t=this.rttHelper.rttLocalPortMap[e[0]]),r.push("-rtttelnetport",t)}return this.args.serialNumber?r.push("-select",`usb=${this.args.serialNumber}`):this.args.ipAddress&&r.push("-select",`ip=${this.args.ipAddress}`),this.args.rtos&&r.push("-rtos",this.args.rtos),this.args.jlinkscript&&r.push("-jlinkscriptfile",this.args.jlinkscript),this.args.serverArgs&&(r=r.concat(this.args.serverArgs)),r}initMatch(){return/Waiting for GDB connection/g}serverLaunchStarted(){}serverLaunchCompleted(){if(this.args.swoConfig.enabled)if("probe"===this.args.swoConfig.source||"socket"===this.args.swoConfig.source){const e=r.createPortName(this.args.targetProcessor,"swoPort");this.emit("event",new r.SWOConfigureEvent({type:"socket",args:this.args,port:this.ports[e].toString(10)}))}else this.emit("event",new r.SWOConfigureEvent({type:"serial",args:this.args,device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}));return new Promise((e=>setTimeout(e,500)))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){this.rttHelper.emitConfigures(this.args.rttConfig,this)}}t.JLinkServerController=c},2073:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenOCDServerController=void 0;const r=s(3200),n=s(2037),i=s(2361);class o extends i.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort","tclPort","telnetPort","swoPort"],this.name="OpenOCD",this.rttHelper=new r.RTTServerHelper}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return[...r.genDownloadCommands(this.args,['interpreter-exec console "monitor reset halt"']),'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){const e=['interpreter-exec console "monitor reset halt"'];return!this.args.runToEntryPoint&&this.args.breakAfterReset&&e.push('interpreter-exec console "monitor gdb_sync"','interpreter-exec console "stepi"'),e}rttCommands(){const e=[];if(this.args.rttConfig.enabled&&!this.args.pvtRestartOrReset){const t=this.args.rttConfig;"launch"===this.args.request&&t.clearSearch&&e.push(`interpreter-exec console "monitor mwb ${t.address} 0 ${t.searchId.length}"`),e.push(`interpreter-exec console "monitor rtt setup ${t.address} ${t.searchSize} {${t.searchId}}"`),t.polling_interval>0&&e.push(`interpreter-exec console "monitor rtt polling_interval ${t.polling_interval}"`);for(const t in this.rttHelper.rttLocalPortMap){const s=this.rttHelper.rttLocalPortMap[t];e.push(`interpreter-exec console "monitor rtt server start ${s} ${t}"`)}e.push('interpreter-exec console "monitor rtt start"')}return e}swoAndRTTCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e.concat(this.rttCommands())}SWOConfigurationCommands(){const e=[];if(!this.args.pvtRestartOrReset){const t="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),s=this.args.swoConfig.swoFrequency,n=this.args.swoConfig.cpuFrequency,i="serial"===this.args.swoConfig.source?"external":":"+this.ports[r.createPortName(this.args.targetProcessor,"swoPort")];e.push(`monitor CDSWOConfigure ${n} ${s} ${i}`,`set $cpuFreq = ${n}`,`set $swoFreq = ${s}`,`set $swoPortMask = ${t}`)}return e.push("monitor gdb_sync","stepi","SWO_Init"),e.map((e=>`interpreter-exec console "${e}"`))}serverExecutable(){return this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"openocd.exe":"openocd"}allocateRTTPorts(){return this.rttHelper.allocateRTTPorts(this.args.rttConfig)}serverArguments(){let e=[];e.push("-c",`gdb_port ${this.ports.gdbPort}`),e.push("-c",`tcl_port ${this.ports.tclPort}`),e.push("-c",`telnet_port ${this.ports.telnetPort}`),this.args.searchDir.forEach(((t,s)=>{e.push("-s",t)})),0===this.args.searchDir.length&&e.push("-s",this.args.cwd);for(const t of this.args.openOCDPreConfigLaunchCommands||[])e.push("-c",t);e.push("-f",`${this.args.extensionPath}/support/openocd-helpers.tcl`),this.args.configFiles.forEach(((t,s)=>{e.push("-f",t)})),this.args.rtos&&e.push("-c",`CDRTOSConfigure ${this.args.rtos}`),this.args.serverArgs&&(e=e.concat(this.args.serverArgs));const t=[];this.args.swoConfig.enabled&&(["probe","socket","file","serial"].find((e=>e===this.args.swoConfig.source))||(this.args.swoConfig.enabled=!1)),t.length>0&&e.push("-c",t.join("; "));for(const t of this.args.openOCDLaunchCommands||[])e.push("-c",t);return e}initMatch(){return/Info\s:[^\n]*Listening on port \d+ for gdb connection/i}serverLaunchStarted(){}serverLaunchCompleted(){if(this.args.swoConfig.enabled){const e=this.args.swoConfig.source;if("probe"===e||"socket"===e||"file"===e){const e=r.createPortName(this.args.targetProcessor,"swoPort");this.emit("event",new r.SWOConfigureEvent({type:"socket",args:this.args,port:this.ports[e].toString(10)}))}else"serial"===e&&this.emit("event",new r.SWOConfigureEvent({type:"serial",args:this.args,device:this.args.swoConfig.swoPath,baudRate:this.args.swoConfig.swoFrequency}))}}debuggerLaunchStarted(){}debuggerLaunchCompleted(){this.rttHelper.emitConfigures(this.args.rttConfig,this)}}t.OpenOCDServerController=o},7880:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PEServerController=void 0;const r=s(3200),n=s(2037),i=s(2361);s(5497).sync;class o extends i.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort","swoPort","consolePort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return[...r.genDownloadCommands(this.args,['interpreter-exec console "monitor _reset"']),'interpreter-exec console "monitor _reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor _reset"']}swoAndRTTCommands(){return[]}serverExecutable(){return console.log("Getting Exec"),this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"pegdbserver_console.exe":"pegdbserver_console"}allocateRTTPorts(){return Promise.resolve()}serverArguments(){const e=this.ports.gdbPort;let t=[];return t.push("-startserver"),t.push("-singlesession"),t.push(`-device=${this.args.device}`),t.push(`-serverport=${e}`),this.args.ipAddress&&t.push(`-serverip=${this.args.ipAddress}`),this.args.rtos&&t.push(`-kernal=${this.args.rtos}`),"jtag"===this.args.interface&&t.push("-usejtag"),this.args.configFiles&&t.push(`-configfile=${this.args.configFiles[0]}`),this.args.serverArgs&&(t=t.concat(this.args.serverArgs)),t}initMatch(){return/All Servers Running/g}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.PEServerController=o},7266:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PyOCDServerController=void 0;const r=s(3200),n=s(2361);class i extends n.EventEmitter{constructor(){super(),this.name="PyOCD",this.portsNeeded=["gdbPort","consolePort","swoPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`,'interpreter-exec console "set mem inaccessible-by-default off"']}launchCommands(){return[...r.genDownloadCommands(this.args,['interpreter-exec console "monitor reset halt"']),'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor reset"']}swoAndRTTCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,s=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess","BaseSWOSetup "+(Math.floor(s/t)-1),"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map((e=>`interpreter-exec console "${e}"`))}serverExecutable(){return this.args.serverpath?this.args.serverpath:"pyocd"}allocateRTTPorts(){return Promise.resolve()}serverArguments(){const e=this.ports.gdbPort,t=this.ports.consolePort;let s=["gdbserver","--port",e.toString(),"--telnet-port",t.toString()];if(this.args.boardId&&(s.push("--board"),s.push(this.args.boardId)),this.args.targetId&&(s.push("--target"),s.push(this.args.targetId.toString())),this.args.cmsisPack&&(s.push("--pack"),s.push(this.args.cmsisPack.toString())),this.args.swoConfig.enabled){const e=this.args.swoConfig.source;if("probe"===e||"socket"===e||"file"===e){const e=["-O","enable_swv=1","-O","swv_raw_enable=true","-O",`swv_raw_port=${this.ports[r.createPortName(this.args.targetProcessor,"swoPort")]}`,"-O",`swv_system_clock=${this.args.swoConfig.cpuFrequency}`,"-O",`swv_clock=${this.args.swoConfig.swoFrequency||"1"}`];s.push(...e)}}return this.args.serverArgs&&(s=s.concat(this.args.serverArgs)),s}initMatch(){return/GDB server started (at|on) port/}serverLaunchStarted(){}serverLaunchCompleted(){if(this.args.swoConfig.enabled){const e=this.args.swoConfig.source;if("probe"===e||"socket"===e||"file"===e){const e=r.createPortName(this.args.targetProcessor,"swoPort");this.emit("event",new r.SWOConfigureEvent({type:"socket",args:this.args,port:this.ports[e].toString(10)}))}else"serial"===e&&this.emit("event",new r.SWOConfigureEvent({type:"serial",args:this.args,device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.PyOCDServerController=i},1317:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QEMUServerController=void 0;const r=s(3200),n=s(2361),i=s(5497).sync,o=["qemu-system-arm"];class a extends n.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return["enable-pretty-printing"]}attachCommands(){return["enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor stop"','interpreter-exec console "monitor system_reset"']}swoAndRTTCommands(){return[]}serverExecutable(){if(this.args.serverpath)return this.args.serverpath;for(const e in o)if(i(e))return e;return"qemu-system-arm"}allocateRTTPorts(){return Promise.resolve()}serverArguments(){const e=this.ports.gdbPort;let t=["-cpu",this.args.cpu,"-machine",this.args.machine,"-nographic","-semihosting-config","enable=on,target=native","-gdb","tcp::"+e.toString(),"-S","-kernel",this.args.executable];return this.args.serverArgs&&(t=t.concat(this.args.serverArgs)),t}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.QEMUServerController=a},2057:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STLinkServerController=void 0;const r=s(3200),n=s(2037),i=s(1017),o=s(358),a=s(2361),c=function(){switch(n.platform()){case"win32":return"C:\\ST";case"darwin":return"/Applications/STM32CubeIDE.app/Contents/Eclipse";default:const e=(process.env.HOME||n.homedir())+"/st";return o.existsSync(e)?e:"/opt/st"}}(),h="win32"===n.platform()?"ST-LINK_gdbserver.exe":"ST-LINK_gdbserver",u=/^STM32CubeIDE_(.+)$/i,l=/com\.st\.stm32cube\.ide\.mcu\.externaltools\.stlink-gdb-server\.(.+)/,d=/com\.st\.stm32cube\.ide\.mcu\.externaltools\.cubeprogrammer\.(.+)/,p=/com\.st\.stm32cube\.ide\.mcu\.externaltools\.gnu-tools-for-stm32\.(.+)/;function f(e,t,s,r=""){const n=i.join(...e);let a;try{for(const e of o.readdirSync(n).sort()){const c=i.join(n,e);if(!o.statSync(c).isDirectory())continue;const h=e.match(t);if(h){const e=i.join(n,h[0],s,r);o.existsSync(e)&&(!a||a.localeCompare(e,void 0,{sensitivity:"base",numeric:!0})<0)&&(a=e)}}}catch(e){}return a||r}class m extends a.EventEmitter{constructor(){super(),this.name="ST-LINK",this.portsNeeded=["gdbPort"]}static getSTMCubeIdeDir(){switch(n.platform()){case"darwin":return c;case"linux":return f([c],u,"");default:return f([c],u,"STM32CubeIDE")}}static getArmToolchainPath(){return f([this.getSTMCubeIdeDir(),"plugins"],p,"tools/bin")}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return[...r.genDownloadCommands(this.args,['interpreter-exec console "monitor reset"']),'interpreter-exec console "monitor reset"','interpreter-exec console "monitor halt"',"enable-pretty-printing"]}attachCommands(){return["enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor reset"']}swoAndRTTCommands(){return[]}serverExecutable(){return this.args.serverpath?this.args.serverpath:f([m.getSTMCubeIdeDir(),"plugins"],l,"tools/bin",h)}allocateRTTPorts(){return Promise.resolve()}serverArguments(){let e=["-p",this.ports.gdbPort.toString()],t=this.args.stm32cubeprogrammer;return t||(t=f([m.getSTMCubeIdeDir(),"plugins"],d,"tools/bin"),t||(t="win32"===n.platform()?process.env.ProgramFiles+"\\STMicroelectronics\\STM32Cube\\STM32CubeProgrammer\\bin":"darwin"===n.platform()?"/Applications/STMicroelectronics/STM32Cube/STM32CubeProgrammer/STM32CubeProgrammer.app/Contents/MacOs/bin":"/usr/local/STMicroelectronics/STM32Cube/STM32CubeProgrammer/bin")),e.push("-cp",t),"jtag"!==this.args.interface&&"cjtag"!==this.args.interface&&e.push("--swd"),this.args.serialNumber&&e.push("--serial-number",this.args.serialNumber),"attach"===this.args.request&&e.push("--attach"),e.push("--halt"),this.args.serverArgs&&(e=e.concat(this.args.serverArgs)),e}initMatch(){return/(Waiting for debugger connection|Listening at).*/gi}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.STLinkServerController=m},6856:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STUtilServerController=void 0;const r=s(3200),n=s(2037),i=s(2361);class o extends i.EventEmitter{constructor(){super(),this.name="ST-Util",this.portsNeeded=["gdbPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return['interpreter-exec console "monitor halt"',...r.genDownloadCommands(this.args,['interpreter-exec console "monitor reset"']),'interpreter-exec console "monitor reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"']}swoAndRTTCommands(){const e=[];if(this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,s=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess","BaseSWOSetup "+(Math.floor(s/t)-1),"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map((e=>`interpreter-exec console "${e}"`))}serverExecutable(){return this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"st-util.exe":"st-util"}allocateRTTPorts(){return Promise.resolve()}serverArguments(){let e=["-p",this.ports.gdbPort.toString(),"--no-reset"];return this.args.v1&&e.push("--stlinkv1"),this.args.serialNumber&&e.push("--serial",this.args.serialNumber),this.args.serverArgs&&(e=e.concat(this.args.serverArgs)),e}initMatch(){return/Listening at \*/g}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new r.SWOConfigureEvent({type:"serial",args:this.args,device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.STUtilServerController=o},565:(e,t)=>{"use strict";var s,r;Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolScope=t.SymbolType=void 0,(r=t.SymbolType||(t.SymbolType={}))[r.Function=0]="Function",r[r.File=1]="File",r[r.Object=2]="Object",r[r.Normal=3]="Normal",(s=t.SymbolScope||(t.SymbolScope={}))[s.Local=0]="Local",s[s.Global=1]="Global",s[s.Neither=2]="Neither",s[s.Both=3]="Both"},3725:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PortStatusArgs=t.TcpPortScanner=void 0;const n=s(2037),i=s(1808),o=s(2081),a=s(5497),c=s(2361);let h=!1;function u(...e){h&&console.log(...e)}class l{static EmitAllocated(e){if(e&&e.length){for(const t of e)l.AvoidPorts.add(t);l.PortAllocated.emit("allocated",e)}}static isPortInUse(e,t,s=9999){return u(`isPortInUse: testing port ${t}:${e}`),new Promise(((r,n)=>{const o=i.createServer((e=>{}));o.once("error",(i=>{const a=i.code;a&&"EADDRINUSE"===a||"EACCES"===a?("EACCES"===a&&u(`isPortInUse: port ${t}:${e} returned code EACCES?, ${s}`),u(`isPortInUse: port ${t}:${e} is busy, ${s}`),r(!0)):(u(`isPortInUse: port ${t}:${e} unexpected error , ${s}`,i),n(i)),o.close()})),o.once("close",(()=>{u(`isPortInUse: port ${t}:${e} is free, ${s}`),r(!1)})),o.listen(e,t,(()=>{o.close()}))}))}static isPortInUseEx(e,t,s){const n=l.SeqNumber++,i=l.getLocalHostAliases();return new Promise((t=>r(this,void 0,void 0,(function*(){if(s&&s.has(e))t(!0);else{for(const s of i)try{if(yield l.isPortInUse(e,s,n))return void t(!0)}catch(e){return void t(!0)}t(!1)}}))))}static findFreePorts({min:e,max:t,retrieve:s=1,consecutive:r=!1,doLog:n=!1},i=l.DefaultHost){h=h||n;let o=[];const a=[],c=s;return new Promise(((s,n)=>{const d=e=>{l.EmitAllocated(e),s(e)};c<=0?d(o):function e(s,i){u(`findFreePorts: ******** Next ${s}`);const p=process.hrtime();l.isPortInUseEx(s,i,l.AvoidPorts).then((l=>{const f=process.hrtime(p);if(l?(a.push(s),u(`Busy ports = ${a}`)):(r&&o.length>0&&s!==1+o[o.length-1]&&(u("TcpPortHelper.findFreePorts: Oops, reset for consecutive ports requirement"),o=[]),o.push(s),u(`Free ports = ${o}`)),h){const e=(f[1]/1e6).toFixed(2),t=`${f[0]}s ${e}ms`;u(`TcpPortHelper.findFreePorts Port ${i}:${s} `+(l?"busy":"free")+`, Found: ${o.length} of ${c} needed ${t}`)}o.length===c?d(o):s<t?e(s+1,i):n(new Error(`Only found ${o.length} of ${c} ports`))})).catch((e=>{n(e)}))}(e,i)}))}static getOsNetProbeCmd(){if(""===l.OSNetProbeCmd){const e=a.sync,t=n.platform(),s="win32"===t,r="darwin"===t;s||r||!e("ss")?e("netstat")?(l.OSNetProbeCmd=s?"netstat -nap tcp":"netstat -nap tcp -f inet",l.OSNetProbeCmdRegexpStr="[tT][cC][pP][^\\n]*[:\\.]XYZZY\\s+[^\\s]+\\s+LISTEN[^\\n]*\\n"):r&&e("lsof")?(l.OSNetProbeCmd="lsof -n -iTCP:XYZZY -sTCP:LISTEN",l.OSNetProbeCmdRegexpStr="IPv4[^\\n]+:XYZZY\\s[^\\n]*\\(LISTEN\\)[^\\n]*\\n"):l.OSNetProbeCmd="?":(l.OSNetProbeCmd="ss -nlt",l.OSNetProbeCmdRegexpStr="LISTEN\\s+[^\\n]*:XYZZY\\s+[^\\s]+[^\\n]*\\n")}return l.OSNetProbeCmd}static waitForPortOpenOSUtl(e,t=100,s=5e3,r=!0,n=!0){const i=l.getOsNetProbeCmd().replace("XYZZY",e.toString());if(h=h||n,u(i),r&&"?"===i)return l.waitForPortOpen(e,l.DefaultHost,!0,t,s);const a=l.OSNetProbeCmdRegexpStr.replace("XYZZY",e.toString());u(a);const c=new RegExp(a),d=Date.now();let p=!0;return t=Math.max(t,1),new Promise((function e(r,n){if("?"===i)return n(new Error("failed"));o.exec(i,((o,a)=>{if(o&&!i.startsWith("lsof"))return n(o);if(c.test(a))return u(a.match(c).join("\n")),r();{p&&(p=!1);const i=Date.now()-d;if(!(i<s))return n(new Error("timeout"));u(`waitForPortOpenOSUtl: Setting timeout for ${t}ms, curTime = ${i}ms`),setTimeout((()=>{e(r,n)}),t)}}))}))}static waitForPortStatusEx(e){e.startTimeMs=Date.now();const t=e.checkLocalHostAliases?l.isPortInUseEx:l.isPortInUse;return new Promise((function s(r,n){t(e.port,e.host,null).then((t=>{if(t===e.desiredStatus)return r();throw new Error("tryagain")})).catch((t=>"tryagain"!==t.message?n(t):Date.now()-e.startTimeMs<e.timeOutMs?void setTimeout((()=>{s(r,n)}),e.retryTimeMs):n(new Error("timeout"))))}))}static waitForPortStatus(e,t=l.DefaultHost,s=!0,r=!0,n=100,i=5e3){n=Math.max(n,1);const o=new d(s,e,t,r,n,i);return l.waitForPortStatusEx(o)}static waitForPortOpen(e,t=l.DefaultHost,s=!0,r=100,n=5e3){r=Math.max(r,1);const i=new d(!0,e,t,s,r,n);return l.waitForPortStatusEx(i)}static waitForPortClosed(e,t=l.DefaultHost,s=!0,r=100,n=5e3){r=Math.max(r,1);const i=new d(!1,e,t,s,r,n);return l.waitForPortStatusEx(i)}static getLocalHostAliases(){if(0===l.localHostAliases.length){l.localHostAliases=["127.0.0.1","0.0.0.0"];const e=n.networkInterfaces();Object.keys(e).forEach((t=>{e[t].forEach((e=>{e.internal&&"ipv4"===e.family.toLowerCase()&&-1===l.localHostAliases.indexOf(e.address)&&l.localHostAliases.push(e.address)}))}))}return l.localHostAliases}static shouldUseServerMethod(e){return!l.ForceClientMethod&&(!e||"localhost"===e.toLowerCase()||l.getLocalHostAliases().indexOf(e)>=0)}}t.TcpPortScanner=l,l.ForceClientMethod=!1,l.DefaultHost="0.0.0.0",l.PortAllocated=new c.EventEmitter,l.AvoidPorts=new Set,l.SeqNumber=0,l.OSNetProbeCmd="",l.OSNetProbeCmdRegexpStr="",l.localHostAliases=[];class d{constructor(e,t,s=l.DefaultHost,r=!0,n=100,i=5e3){this.desiredStatus=e,this.port=t,this.host=s,this.checkLocalHostAliases=r,this.retryTimeMs=n,this.timeOutMs=i,this.startTimeMs=0,this.retryTimeMs=Math.max(this.retryTimeMs,1)}}t.PortStatusArgs=d},2479:e=>{e.exports=function e(t,s){if(t&&s)return e(t)(s);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){r[e]=t[e]})),r;function r(){for(var e=new Array(arguments.length),s=0;s<e.length;s++)e[s]=arguments[s];var r=t.apply(this,e),n=e[e.length-1];return"function"==typeof r&&r!==n&&Object.keys(n).forEach((function(e){r[e]=n[e]})),r}}},9491:e=>{"use strict";e.exports=require("assert")},2081:e=>{"use strict";e.exports=require("child_process")},6206:e=>{"use strict";e.exports=require("console")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},358:e=>{"use strict";e.exports=require("fs")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},4521:e=>{"use strict";e.exports=require("readline")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},9512:e=>{"use strict";e.exports=require("timers")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,s),i.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r=s(121);module.exports=r})();
//# sourceMappingURL=debugadapter.js.map